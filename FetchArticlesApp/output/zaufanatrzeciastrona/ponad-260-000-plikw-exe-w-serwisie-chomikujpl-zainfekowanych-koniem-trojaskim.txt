W sieci pojawił się opis ciekawego konia trojańskiego napisanego w Pythonie prawdopodobnie przez Polaka. Na podstawie dostępnych wskazówek zidentyfikowaliśmy już ponad 100 tysięcy zainfekowanych nim plików EXE. Firma Palo Alto Networks opisała dzisiaj interesujący przypadek złośliwego oprogramowania, na które od pewnego czasu natrafiała w sieciach polskich firm i instytucji. Pliki były rozprowadzane między innymi w serwisie Chomikuj.pl. Zidentyfikowaliśmy konta odpowiedzialne za udostępnianie zainfekowanych plików i skala zjawiska zrobiła na nas duże wrażenie. PWOBot, bo tak nazwali go odkrywcy, napisany jest w całości w Pythonie a następnie skompilowany do pliku EXE. Najstarsze ślady jego wczesnych wersji sięgają zdaniem badaczy do końca roku 2013. Odnaleziono ślady istnienia 12 różnych wersji a kulminacja ataków przypadała na drugą połowę roku 2015. Poszczególne wersje różnią się w niewielkim stopniu, wprowadzają jedynie drobne optymalizacje. Złośliwy program zaczyna od poszukiwań swojej wcześniejszej wersji i jeśli taką znajdzie to ją usuwa. Następnie tworzy na dysku swoją kopię pod nazwą pwo[numer wersji] i dopisuje jej uruchomienie do odpowiedniego klucza w rejestrze. Na ślady wpisów w rejestrach odpowiadających tej definicji natrafiliśmy np. na forum Elektrody w czerwcu 2014, serwisie wklej.org w lutym 2014 czy na forum FixitPC w styczniu 2014. Sam program posiada budowę modułową i dysponuje następującymi możliwościami: Program posiada także dwa pliki konfiguracyjne. Jeden z nich wskazuje podstawowe parametry działania takie jak np. nazwy plików EXE pod którymi uruchomione są poszczególne moduły, a drugi informacje o serwerach C&C. Serwery C&C znajdują się w sieci Tor – złośliwy kod zawiera także odpowiednie pliki obsługujące te połączenia. Próbki z ostatniej kampanii z sierpnia 2015 łączą się także z domenami Zaczynając naszą analizę od kilku nazw plików zawierających złośliwy kod szybko zlokalizowaliśmy konta w serwisie Chomikuj.pl, które zawierały próbki konia trojańskiego dołączone do przeróżnych programów użytkowych. Zauważyliśmy także pewne cechy wspólne tych kont, które pozwoliły na zlokalizowanie ich większej liczby. Jak do tej pory namierzyliśmy 7 kont które zawierają praktycznie wyłącznie pliki EXE zainfekowane opisywanym koniem trojańskim. Te konta to Kimaoson, KuroMan29, KarolKrol, OranzowyBol, be36ber, soneaakarin oraz Paolapopo. W sumie te 7 kont zawiera 262 314 plików o łącznej objętości dokładnie 99,99 GB. Przypadek czy precyzyjnie zaplanowany projekt? Co łączy te Chomiki? Doświadczeni analitycy z laboratorium z3s, którzy na polskim złośliwym oprogramowaniu zęby zjedli, zgodnym chórem podejrzewają o współudział osobę stojącą za innowacyjnym koniem trojańskim Banatrix (oraz jego późniejszymi odmianami) lub kogoś, kto wzoruje się na jego metodach działania. Opinia ta wynika przede wszystkim z wyboru metody dystrybucji konia trojańskiego. Źródło Banatrixa długo umykało badaczom – w końcu okazało się, że jednym z kanałów dystrybucji były zainfekowane pliki w serwisach torrentowych. Autor kampanii pobierał popularne pirackie oprogramowanie (np. Photoshop, Tibia czy Nero), do każdego pliku EXE doklejał swój kawałek kodu i – prawdopodobnie cudzymi rękoma – propagował w sieci na popularnych serwisach torrentowych. Tu mamy do czynienia z podobną akcją, choć na dużo większą skalę. Wybór takiej metody dystrybucji bardzo utrudnia zadanie badaczom – bez aktywnego rozsyłania konia trojańskiego trudniej ustalić metodę infekcji, a same ofiary dużo mniej chętnie przyznają się do instalowania pirackiego oprogramowania. O efektywności tej metody niech świadczy fakt, że dopiero po ponad 2 latach pojawił się w sieci pierwszy opis PWOBota. Drugim istotnym podobieństwem jest stworzenie własnego złośliwego kodu, rzadko spotykane na naszym rynku, gdzie dominują gotowe konie trojańskie z HackForums.net. Nie znamy wielu przypadków autorskiego konia trojańskiego w naszym kraju – ten zdecydowanie wybija się ponad codzienność. Autora tradycyjnie zapraszamy do kontaktu – bez wątpienia może opowiedzieć wiele ciekawych historii.,Adam