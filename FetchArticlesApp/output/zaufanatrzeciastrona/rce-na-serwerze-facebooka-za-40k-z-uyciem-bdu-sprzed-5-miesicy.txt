Jeśli sądzicie, że łowcy nagród za błędy na platformach firm takich jak Facebook czy Google muszą wynajdywać same 0daye to poniższy przykład pokaże Wam, że wcale tak być nie musi. Stare błędy też mogą okazać się całkiem przydatne. Rosyjski łowca błędów Andriej Leonow opisał na swoim blogu ciekawy przypadek udanego ataku na serwer Facebooka. Udało mu się odnaleźć błąd, dzięki któremu mógł wykonywać dowolny kod na serwerze FB z uprawnieniami serwera WWW. Nagroda w programie bug bounty była spora, a historia zasługuje na jej opisanie. W październiku 2016 uwagę Andrieja zwrócił link prowadzący do serwerów Facebooka, umożliwiający podzielenie się jakimś URL (opcja „udostępnij”). Link wyglądał następująco: Jego wyświetlenie powodowało załadowanie m. in. miniaturki obrazka z udostępnianego linka. Miniaturka ta była jednak serwowana już z serwera Facebooka i miała inny rozmiar niż oryginalny obraz. Andriej przedstawił to na zrzucie ekranu:  Badacz zauważył też w kolejnych testach, że po obrazek do miniaturki zgłasza się serwer Facebooka (z polem UserAgent facebookexternalhit/1.1). Próbował zatem podstawiać różne pliki SVG wykorzystujące potencjalne błędy typu SSRF czy XXE, lecz bez rezultatu. Wtedy przyszła mu do głowy szalona myśl – a gdyby tak przetestować podatność na błąd ImageTragick z maja 2016? Jest to dość prosty w wykorzystaniu błąd popularnej biblioteki ImageMagick. Aby go wywołać trzeba osadzić w pliku PNG np. taki zestaw danych: co powinno spowodować wywołanie żądania do serwera kontrolowanego przez atakującego. Spreparował zatem odpowiedni plik, Facebook go pobrał lecz badacz nie zauważył efektów. Pomyślał zatem, że być może polityka bezpieczeństwa serwera ogranicza możliwość pobierania zewnętrznych plików poleceniem curl i kolejny zestaw poleceń był już sprytniejszy: W tym ataku Andriej sprawdził, czy skoro nie może zmusić serwera do wykonania połączenia do swojej maszyny w ramach protokołu HTTP, to może uda się wywołać połączenie DNS. Ku swojemu zaskoczeniu zobaczył żądanie do serwera DNS pochodzące od serwera Facebooka. Pozostało już tylko zebrać dowody na istnienie podatności. Przez DNS można przecież przesłać sporo danych. Na przykład takie zapytanie: Może dać taką odpowiedź: Przesłanie zapytania o id daje Jak zatem widać Andriej zdobył jeden z wymarzonych celów łowców błędów – wykonanie kodu na serwerze Facebooka. Błąd został oczywiście zgłoszony i załatany w ciągu doby od przesłania wszystkich szczegółów, a po kilku dniach Facebook przyznał badaczowi w pełni zasłużoną nagrodę w wysokości 40 tysięcy dolarów. Jak zatem widać nawet w bardzo popularnej funkcji można znaleźć błąd sprzed kilku miesięcy i nieźle na tym zarobić – wystarczy trochę szczęścia, uporu i intuicji. A o tym, jak być takim Andriejem lub jak się przed takim Andriejem chronić dowiecie się na naszym szkoleniu z bezpieczeństwa aplikacji WWW.,Adam