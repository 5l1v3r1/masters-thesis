Z protokołu UPnP, umożliwiającego bezpośrednią komunikację między komputerami i urządzeniami sieciowymi, korzystają dziesiątki milionów urządzeń domowych. Spora ich część jest podatna na krytyczne błędy, umożliwiające przejęcie nad nimi kontroli. Protokół Universal Plug and Play (podłącz i działaj) to rozwiązanie, umożliwiające urządzeniom takim jak komputery, domowe rutery WiFi, drukarki, kamery, telewizory czy serwery multimedialne wzajemne wykrywanie swojej obecności i nawiązywanie łączności w celu wymiany informacji (np. klient BitTorrenta automatycznie otworzy odpowiednie porty na ruterze dla ruchu przychodzącego a Windows automatycznie wykryje drukarki i skanery w sieci lokalnej). Zaletą tego rozwiązania jest brak konieczności ingerencji użytkownika – komunikacja i konfiguracja urządzeń odbywa się automatycznie. Wśród wad można wymienić co najmniej jedną – dziesiątki milionów urządzeń na całym świecie domyślnie obsługuje ten protokół, sprawiając, że jakikolwiek poważny błąd automatycznie dotyczy milionów użytkowników. Tak jest też i w tym przypadku. HD Moore, szef firmy Rapid7, opublikował właśnie raport o odkrytych niedawno podatnościach UPnP. Po przeskanowaniu całej przestrzeni adresowej IPv4 odkrył on 81 milionów urządzeń (ponad 2% całości) reagujących na podstawowy pakiet UPnP. 20% z nich udostępnia także interfejs SOAP, umożliwiający atakowanie systemów ukrytych za firewallem. Spośród 81 milionów urządzeń obsługujących UPnP przynajmniej 23 miliony podatne są na błąd zdalnego wykonania kodu, do wywołania którego wystarczy jeden pakiet UDP (potencjalnie ze sfałszowanym adresem nadawcy…). 1500 różnych producentów i 6900 ich produktów okazało się podatnych na przynajmniej jeden z odkrytych błędów. Łatanie wszystkich urządzeń może zająć całe wieki. Z badania autorów raportu wynika, że 73% wszystkich dostępnych urządzeń UPnP posługuje się oprogramowaniem przygotowanym w oparciu o jeden z 4 zestawów funkcji: Portable SDK for UPnP Devices, MiniUPnP, zestawu komercyjnego autorstwa Broadcomu oraz czwartego, którego autorstwa nie udało się ustalić. W pakiecie Portable SDK for UPnP Devices badacze znaleźli 8 różnych zdalnie wykorzystywalnych błędów. W większości przypadków urządzenia korzystają ze starych wersji bibliotek, ale nawet w wersji najnowszej ciągle obecne są dwa błędy przepełnienia bufora. Dzięki krytycznemu umiejscowieniu podatnego kodu, do wykorzystania błędów wystarczy pojedynczy pakiet UDP. Z uwagi na wymagania co do zawartości pakietu, zdalne wykonanie kodu nie jest trywialne, jednak jest możliwe. W pakiecie MiniUPnP odkryto błąd przepełnienia bufora, który, choć naprawiony w najnowszej wersji, jest obecny w wersjach starszych, z których korzysta 69% urządzeń wykorzystujących te biblioteki. Udział poszczególnych dostawców oprogramowania (źródło: Rapid7) Listy podatnych urządzeń ze względu na ich długość nie zostały zamieszczone w raporcie – można się z nimi zapoznać pod tymi linkami. Rozwiązania są dwa. Tam, gdzie to możliwe, wyłączyć w opcjach używanie protokołu UPnP. Powinno być to możliwe w większości ruterów, kamer czy drukarek. Tam, gdzie jest to niemożliwe, wyłączyć urządzenie – lub odciąć je od sieci publicznej. I nie włączać do czasu zainstalowania aktualizacji oprogramowania, usuwającej błędy. A w wykryciu urządzeń UPnP w sieci domowej na pewno pomoże oprogramowanie ScanNowUPnP, przygotowane przez autorów raportu. Wyniki skanowania sieci domowej,Adam