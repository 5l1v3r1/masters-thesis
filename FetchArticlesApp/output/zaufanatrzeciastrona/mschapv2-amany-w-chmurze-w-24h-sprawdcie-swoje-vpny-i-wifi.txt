Niektóre protokoły nie urodziły się pod szczęśliwą gwiazdą. Wraz ze wzrostem dostępnej mocy obliczeniowej błędy projektowe popełnione przez ich twórców stają się coraz powazniejsze. Taki los spotkał też MS-CHAPv2, który można dzisiaj złamac w 24h. Wprowadzony w Windows NT4.0 i od 1996 roku nieustannie promowany przez Microsoft MS-CHAPv2 był wielokrotnie już określany przez badaczy jako daleki od doskonałości. Jeśli Bruce Schneier już w 1999 roku opisuje algorytm jako nie zapewniający bezpieczeństwa, można się tylko dziwić, że Microsoft (oraz użytkownicy jego systemów) w roku 2012 dalej wykorzystuą go do uwierzytelnienia i generowania kluczy w sieciach VPN i WiFi. Być może zmieni się to jednak po prezentacji na tegorocznej konferencji Defcon. Przyczynić się do tego może Moxie Marlinspike, legendarny autor narzędzia sslstrip (atak MITM na SSL) i odkrywca wielu błędów w protokołach kryptograficznych. W tym roku na konferencji Defcon Moxie przedstawił swój najnowszy projekt – CloudCracker.com. Serwis sam z siebie nie jest niczym nowym – po prostu kolejna platforma wyspecjalizowana w łamaniu hashy w chmurze. Ciekawa jest jednak jedna z jej usług, czyli łamanie MS-CHAPv2 handshake ze 100% skutecznością w czasie 24h.   Moxie Marlinspike (źródło: Wired)   Wcześniejsze ataki na MS-CHAPv2 opierały się na podstawowym błędzie protokołu, czyli oparciu uwierzytelnienia o hasło stworzone przez człowieka. Ze względu na potencjalną słabość hasła możliwe było złamanie zabezpieczeń poprzez atak słownikowy lub atak typu brute-force, jednak ten drugi nie gwarantował 100% skuteczności ze względu na złożoność obliczeniową. Moxie odkrył jednak sposób sprowadzenia ataku na MS-CHAPv2 do ataku na jeden klucz DES, czyli „jedyne” 72,057,594,037,927,936 możliwości. W oparciu o klaster FPGA firmy Pico Moxie zbudował platformę, która gwarantuje złamanie klucza DES w ciągu doby – za jedyne 200 dolarów (15% zniżki przy płatności w BTC).   Panel CloudCrackera   Aby skorzystać z jego usługi, wystarczy użyć oprogramowania ChapCrack, które przechwyci odpowiednie dane i zapisze je w postaci tokenu, który trzeba następnie przekazać serwisowi CloudCracker. CloudCracker odpowie kolejnym tokenem, który przekazay do ChapCracka pozwoli od tego momentu podsłuchiwać cały ruch w szyfrowanej sieci. Jeśli zatem korzystacie w swojej sieci WiFi z WPA2-Enterprise PEAP-MSCHAPv2 lub VPN z PPTP MS-CHAPv2, nadszedł czas na zmiany – zanim ktoś po wysłuchaniu wykładu Moxiego przeprowadzi Wam niezamówione testy penetracyjne.,Adam