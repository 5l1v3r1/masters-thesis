Kiedy ktoś zhakuje Twoją lodówkę, w najgorszym razie rozmrozi Ci pizzę. Co jednak kiedy włamywacz uzyska kontrolę nad urządzeniem, które dawkuje Twoje lekarstwa? Lub nad wszystkimi takimi urządzeniami w całym szpitalu? Producenci urządzeń medycznych doganiają trendy obowiązujące od dłuższego czasu na rynku i do swoich produktów wprowadzają funkcję podłączenia do sieci. Niestety nie doganiają związanych z tym standardów bezpieczeństwa i sprzedają urządzenia, które stanowią bezpośrednie zagrożenie życia pacjentów. Pewien badacz postanowił przyjrzeć się bezpieczeństwu pompy infuzyjnej, a konkretnie modelu Hospira PCA3. Jest to urządzenie, które służy do automatycznego dawkowania leków w określonych dawkach i przedziałach czasu. Wygląda tak: Pompa infuzyjna Hospira Wyniki przeprowadzonej przez niego analizy jeżą włosy na głowie. Trudno sobie wyobrazić, jak można było taki bubel wypuścić na rynek. Znalezionych błędów nie brakuje, lecz od czegoś trzeba zacząć. Użytkownik, który podłączy się do urządzenia korzystając z portu Ethernet, może bez problemu pobrać pliki w których zapisano konfigurację sieci WiFi. Tak, pompa podłączana jest do szpitalnej sieci WiFi. Sieć ta określana jest jako Life Critical Network, czyli sieć urządzeń podtrzymujących funkcje życiowe. Nie wiemy jak Wy, ale my słysząc „Life Critical Network” oraz „WiFi” w tym samym zdaniu zaczynamy panikować. Tak więc każdy pacjent w szpitalu, w którym używany jest ten model pompy, może korzystając z laptopa odczytać hasła do sieci WiFi, do której podłączone są inne pompy oraz pozostałe urządzenia podtrzymujące życie pacjentów. Jak można odczytać te hasła? Otóż mamy tu prawdziwą perełkę. Na porcie 23 czeka usługa telnet. Na niej BusyBox. Bez uwierzytelnienia. Z uprawnieniami roota. Po takiej informacji rekomendujemy zrobić chwilę przerwy, wziąć głęboki oddech i powoli wrócić do czytania (lub połączyć się na port 23 urządzenia i zwiększyć dawkę używanego leku na uspokojenie). Załóżmy na chwilę, że producent nie popełnił tego błędu i telnet jest wyłączony. Z pomocą przychodzą wtedy innej interfejsy – WWW lub FTP. Konta do nich zapisane są na stałe w konfiguracji urządzenia. Co prawda hasła przechowywane są w postaci haszy, ale ich złamanie zajęło badaczowi kilka minut. Te konta to Admin:admin oraz Hospira:4552401. Mało? To może zechcecie skorzystać z interfejsu WWW, gdzie odpowiednie skrypty w katalogu cgi-bin umożliwiające aktualizację oprogramowania oraz zmianę dawkowania leków są dostępne bez potrzeby podawania hasła? Po lekturze powyższych akapitów pozostaje mieć tylko nadzieję, że nie była to analiza post-mortem. Na szczęście nie znaleźliśmy w sieci śladów obecności tych właśnie urządzeń na polskim rynku, ale jeśli traficie kiedyś do amerykańskiego szpitala, to upewnijcie się, że producent zdążył już zaktualizować oprogramowanie. Poza tym hasło do sieci WiFi może się przydać do czytania z3s. Jeśli zaś macie pecha czytać ten artykuł w szpitalu, rozejrzyjcie się, czy z tyłu stojących obok Was urządzeń nie widać portów ethernetowych i starajcie się trzymać od takich sprzętów z daleka. Dużo zdrowia! Aktualizacja 2015-05-06 21:00 Jeden z naszych Czytelników podesłał informację o sytuacji w polskich szpitalach (dziękujemy!)  Infuserv i pompy (B.Brauna) są w sieci odseparowanej od reszty bałaganu. Cała infrastruktura ma wdrożone 802.1x – jak radiusowi coś nie przypasi to delikwent i tak wylatuje całkowicie (port zmienia state na disabled). Pompy faktycznie wystawiają nadmiar serwisów (w tym ftp) ale na szczęście żaden serwis nie wpuszcza bez logowania. Każda pompa wystawia też swój webinterfejs po httpsie, ale to już nie mi oceniać na ile jest on bezpiecznie napisany. Ogólnie chyba większym security fuckupem byłby w tym wypadku udany vlan hopping niż ubicie samej pompy (do tego momentu intruz nie powinien w ogóle dojść). Pompa wygląda z sieci tak: 21/tcp open ftp ProFTPD (requires SSL) 22/tcp open ssh OpenSSH 5.5 (protocol 2.0) 80/tcp open http lighttpd 1.4.28 443/tcp open ssl/http lighttpd 1.4.28 1500/tcp open vlsi-lm? 4002/tcp open mlchat-proxy? Prawda taka, że my nie możemy sobie wbić na pompę i zrobić jej apt-get update/upgrade czy zamknąć jej przeterminowanego serwisu ftpa. O takie rzeczy musi już zadbać producent. My możemy tylko starać się trzymać zainteresowanych z dala od tego segmentu sieci… Piszę to głównie po to, żeby nieco uspokoić, że w polskich szpitalach dostęp do infu pomp nie lata po wifi (a przynajmniej się nie spotkałem) a ich łączność ethernetową traktujemy bardzo poważnie.,Adam