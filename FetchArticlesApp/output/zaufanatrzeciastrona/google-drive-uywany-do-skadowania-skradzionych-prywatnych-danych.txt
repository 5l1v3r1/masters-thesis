Botnety wykradają terabajty danych, analizują je, wykorzystują i przechowują. Problemem jest składowanie danych przed ich analizą. Jeśli więc bronicie się przed kontem na Facebooku, GMailu czy Dropboksie, wasze dane i tak mogą już tam być. Przestrzeń kosztuje – wie o tym każdy kto kupował mieszkanie, wie o tym każdy kto posiada dysk SSD, wiedzą o tym również twórcy botnetów. Dlaczego więc nie wykorzystać darmowych zasobów w chmurze do niecnych celów? Pisaliśmy już o botnetach wykorzystujących choćby darmową moc obliczeniową chmury, wiemy o botnecie który wykorzystywał pliki zlokalizowane w Dropboksie czy Evernote jako źródła instrukcji dla C&C. Również Sendspace w lutym 2014 był używany do przechowywania wykradzionych danych. Teraz przyszła pora na Google Drive. Badacze z TrendMicro odkryli malware TSPY_DRIGO.A który do przechowywania odnalezionych na komputerach ofiar danych używa publicznie dostępnych dysków Google. Malware o którym mowa analizuje profil użytkownika oraz zawartość jego kosza pod kątem obecności plików o rozszerzeniach: Pliki te są bezpośrednio przesyłane na odpowiednio skonfigurowane wcześniej konta na dyskach Google przy wykorzystaniu OAuth 2.0 i Google API. Schemat aktualizacji tokenu w OAuth 2 Aby połączyć się z Google Drive przy użyciu API, niezbędny jest client_id oraz client_secret. Dane te zostały zaszyte w malware, podobnie jak i refresh token, który to niezbędny jest, aby zapobiec wygaśnięciu poprzednich dwóch. Wykorzystywany jest głównie przez aplikacje którym pozwolimy na korzystanie z naszego konta czy to w Google, Twiterze czy Facebooku (Facebook w tym przypadku używał wcześniej w API metody offline_access, z czego ze względów bezpieczeństwa jednak zrezygnował). Powyższe informacje udało się TrendMicro uzyskać po rozszyfrowaniu komunikacji pomiędzy malware a serwerami Google. Poszczególne zapytania wyglądały następująco: Zapytanie o nowy token: Odpowiedź z tokenem:  Zapytanie o token: Wyświetlenie plików: I fragment odpowiedzi:  Błędem twórców może być wielokrotne użycie tych samych kont Google do współdzielenia plików. Część plików w dalszym ciągu jest osiągalna z poziomu tokenów używanych przez malware. Co gorsze, część nazw plików składowanych na kontach Google Drive używanych przez zarządzających botnetem zdradza do kogo one należą – w większości są to agencje rządowe. Wykorzystanie Google Drive to nie jedyny związek złośliwego oprogramowania z tą firmą. Malware został napisany w języku programowania Go, który to został opracowany przez pracowników Google. Jego główną zaletą jest łatwość pisania aplikacji ( podobnie jak np. Python jest językiem dynamicznym dziękujemy czytelnikowi za zwrócenie uwagi, golang umożliwia jedynie dynamiczną zmianę typu interfejsów, co nie czyni go językiem dynamicznym), przy wydajności zbliżonej do języków kompilowanych takich jak C/C++. Powyższe cechy są bardzo pożądane przy tworzeniu malware, a sam pomysł wykorzystania golang w ich produkcji nie jest niczym nowym – pierwsze wzmianki na ten temat pojawiały się już w 2012 roku. „Maskotka” golang Badacze uważają, że głównym zadaniem malware jest sprawdzenie z czego i dlaczego korzystają zainfekowani użytkownicy. Ma to ułatwić zebranie dalszych informacji niezbędnych do przeprowadzenia ataku wycelowanego w konkretną infrastrukturę lub agencję, może osobę. Im więcej plików uda im się pozyskać (warto podkreślić, że tylko pliki tekstowe są wysyłane do usług chmurowych) i przeanalizować, tym precyzyjniejszy atak uda się im przeprowadzić, a tym samym rozszerzyć zakres działania botnetu i być może dotrzeć do upragnionego przez twórców celu. TrendMicro poinformowało już Google o odkryciu, co może pokrzyżować model biznesowy botnetu, choć nie uważamy, by było znaczącą przeszkodą. Być może Google po analizie źródłowych IP przesyłanych na obsługiwane przez siebie usługi plików wyciągnie kolejne wnioski i przybliży nas do rozwiązania zagadki.,Marcin Rybak