Pamiętacie zapewne wielki atak hakerski na systemy PLL LOT, który zablokował na kilka godzin możliwość startu samolotów z Okęcia. Tak naprawdę to systemy LOT nie były celem ataku, a jednym z jego źródeł. Jak do tego doszło? 21 czerwca tego roku na Okęciu przez 4 godziny niedostępny był system odpowiadający za wydawanie planu lotów. LOT najpierw mówił o intruzie w sieci wewnętrznej, potem o ataku z zewnątrz, aż w końcu przyjął stanowisko, że był to atak DDoS. I mówił prawdę – lecz zapomniał poinformować, że był jego współsprawcą. Niektóre fakty ujawnia dzisiejsza Rzeczpospolita, a my znamy techniczną część tej historii. Krótko po awarii rzecznik PLL LOT informował w mediach, że firma była celem ataku DDoS:  Dodawał także niepokojące pozostałe linie lotnicze stwierdzenie:  Chcemy uspokoić linie lotnicze całego świata – jeśli nie popsujecie konfiguracji swojego firewalla, to ten rodzaj ataku wam nie grozi. Przyczyną niedostępności kluczowych systemów było faktycznie wysycenie łącza internetowego firmy. Nie był to jednak ruch przychodzący – pakiety z sieci LOT wychodziły na zewnątrz w ilościach uniemożliwiających nawiązanie innej komunikacji. Powodowało to istotne problemy z ustaleniem przyczyn problemu i prawdopodobnie pierwsze komunikaty o intruzie w sieci wewnętrznej. Prawda jest jednak dużo bardziej prozaiczna. Komunikat PLL LOT Za całość ruchu wychodzącego odpowiadał firmowy serwer DNS. Jak już pewnie część z Was się domyśla, został on użyty do ataku typu DNS-reflection, gdzie atakujący wysyła do serwera małe pakiety ze sfałszowanym adresem nadawcy, a serwer odpowiada – na cudzy adres – pakietami wielokrotnie większymi. Jakim cudem serwer DNS LOTu został wykorzystany przez atakujących? Odpowiedź tkwi w przeprowadzonej krótko przed atakiem modernizacji sieci polegającej między innymi na wymianie firewalli. Przy wymianie firewalli warto usunąć stare, nieużywane reguły i połączyć reguły istniejące w bardziej wydajne zapisy konfiguracji. Niestety, firma, która zajmowała się taką migracją, popełniła przykre w skutkach błędy. Według nowych reguł firewalla wewnętrzny serwer DNS nagle stał się serwerem dostępnym publicznie. Jako że nigdy wcześniej nie był wystawiony do świata, to i jego konfiguracja nie została tak zmodyfikowana, by zapobiegać atakom z jego użyciem. Ktoś przeskanował internet, znalazł podatny serwer i wykorzystał do ataku na zupełnie niezwiązaną z firmą infrastrukturę. Prawdopodobnie atakujący mógł nawet nie wiedzieć, jakie przy okazji spowodował szkody. Kiedy LOT zorientował się, że trwający atak może mieć związek z niedawnymi zmianami w sieci, przywrócił poprzednią konfigurację i odzyskał łączność ze światem. Potem pozostało już tylko opowiedzieć wszystkim o ataku DDoS…,Adam