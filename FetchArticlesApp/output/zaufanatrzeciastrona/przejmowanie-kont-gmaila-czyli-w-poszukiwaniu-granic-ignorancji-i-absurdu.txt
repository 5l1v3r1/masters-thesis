Kilka dni temu trafiliśmy na wiadomość o ciekawej podatności w usłudze Gmail, która miała rzekomo umożliwiać przejęcie kontroli nad dowolnym kontem w Gmailu. Im bliżej jednak się jej przyglądaliśmy, tym większe robiły się nasze oczy… Stopień złożoności kodu i jego ciągła ewolucja powodują, że czasem nawet w poważnych, dużych serwisach znaleźć można błędy fatalne w skutkach. Gdy zatem zobaczyliśmy informacje o możliwości przejęcia dowolnego konta Gmaila nie byliśmy specjalnie zaskoczeni. Co prawda lekkie zdziwienie budziło odkrycie błędu przez nieznanego wcześniej pakistańskiego studenta, lecz historia zna podobne przypadki. Dopiero analiza owego odkrycia i sposobu, w jaki opisały je media, sprawiła, że poczuliśmy potrzebę poruszenia tego tematu. Nagłówki niektórych mediów nie pozostawiały wątpliwości – mamy do czynienia z bardzo poważnym błędem: Sam autor odkrycia, Ahmed Mehtab, przedstawiający się w mediach jako prezes firmy Security Fuse, opisał swoje znalezisko pod nagłówkiem Gmail Account Hijacking Vulnerability. Możecie zacząć lekturę od jego wpisu, ale możemy też oszczędzić Wam jednego kliknięcia. Ahmed opisał proces „przejmowania konta” w miarę dokładnie, lecz musieliśmy przeczytać jego wpis 3 razy zanim zrozumieliśmy, co miał na myśli. Ahmed przejmuje konto Google W punktach poniżej spróbujemy oddać przebieg wydarzeń, poniżej znajdziecie także film Ahmeda pokazujący jego exploit w akcji.  To już niestety – lub na szczęście – w zasadzie koniec tej historii. Ahmed „security researcher” Mehtab poznał własnie możliwość fałszowania adresu pocztowego nadawcy wiadomości. Niestety najwyraźniej nie przyszło mu do głowy by sprawdzić, jak zachowa się filtr antyspamowy Google (lub sprawdził, lecz jego email nie dotarł do odbiorcy i wstyd było pokazać) – na filmie demonstruje jedynie możliwość wybrania nieistniejącej skrzynki jako nadawcy, nie pokazuje już momentu wysłania ani doręczenia wiadomości. Na deser jeszcze można dodać, że Ahmed liczył na bug bounty w wysokości 20 tysięcy dolarów (authentication bypass!), lecz Google, choć błąd logiki poprawiło, odmówiło wypłaty i jedynie zamieściło jego dane na liście Hall of Fame. Na otarcie łez zostają mu artykuły w mediach. A jeśli chcecie nauczyć się wykrywać prawdziwe błędy w webaplikacjach, to zapraszamy na nasze szkolenie z atakowania i obrony już 28go listopada w Warszawie – zostały jeszcze ostatnie miejsca. Z kodem HallOfFame 10% zniżki ;),Adam