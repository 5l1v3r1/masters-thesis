Juniper właśnie ogłosił, że w wielu z produktów z serii Netscreen znajduje się tylna furtka, która umożliwia nieautoryzowany dostęp do treści połączeń VPN oraz zdalne przejmowanie pełnej kontroli nad urządzeniami. Furtka mogła być obecna w kodzie od lat! Ogłoszenie Junipera jest chyba jedną z najbardziej spektakularnych wpadek w historii bezpieczeństwa informacji. Warto także zauważyć, że dokumenty NSA wykradzione przez Snowdena i opublikowane 2 lata temu pokazywały, że NSA posiada możliwości podsłuchiwania dokładnie tej samej kategorii urządzeń tego producenta. Wczoraj wieczorem Juniper wydał poprawkę bezpieczeństwa dla systemu operacyjnego ScreenOS, używanego przez firewalle NetScreen®. Z opisu zidentyfikowanych problemów można wyczytać, że usuwa ona dwie krytycznie niebezpieczne funkcje. Pierwsza to nieautoryzowany zdalny dostęp do urządzeń przez protokoły telnet oraz SSH (wskazywane jest konto system). Już sam ten problem jest tragedią – nieautoryzowany dostęp do firewalla na poziomie administratora umożliwia nie tylko dowolne kontrolowanie jego zachowania, ale także ukrycie faktu dostępu. To jednak nie wszystko – drugi problem okazuje się być równie, jeśli nie bardziej poważny. Juniper pisze wprost, że atakujący mógł uzyskać możliwość odszyfrowania treści przechwyconych połączeń VPN zestawianych przez te urządzenia. Oznacza to, że służby specjalne takie jak NSA czy GCHQ, o których wiemy, że podsłuchują hurtowo ruch internetowy, mogły nagrywać treść połączeń VPN i ją odszyfrowywać bez żadnego problemu. Oba problemy są tym gorsze, że nie istnieje żaden sposób by dowiedzieć się, czy dane urządzenie lub połączenie było celem ataku. Należy zatem założyć, że wszystkie informacje przesyłane przez firewalle Netscreen przez ostatnie 3 lata mogą być w rękach obcych służb. Juniper wskazuje, że nieutoryzowany kod znaleziono w wersjach ScreenOS od 6.2.0r15 do 6.2.0r18 oraz od 6.3.0r12 do 6.3.0r20. Rzut oka na daty wydania poszczególnych wersji wskazuje, że tylna furtka była obecna w kodzie od jesieni 2012 do wczoraj. Nie wiemy jeszcze, jak bardzo wyrafinowany był kod zawierający ukryte funkcje, ale konieczność analizy kodu systemu operacyjnego nie powinna była być dla Junipera zaskoczeniem po tym, jak w internecie opublikowano karty z katalogu produktów NSA jasno wskazujące na poważny problem w urządzeniach Netscreen. Karta z katalogu NSA Czy faktycznie trzeba było tylu lat, by wykryć zmodyfikowany kod? W jaki sposób wprowadzono zmiany? Dlaczego nie zostały wykryte? Ile jeszcze takich kwiatków czeka w kodzie źródłowym oprogramowania urządzeń sieciowych? Niestety na odpowiedzi na te pytania musimy jeszcze poczekać.,Adam