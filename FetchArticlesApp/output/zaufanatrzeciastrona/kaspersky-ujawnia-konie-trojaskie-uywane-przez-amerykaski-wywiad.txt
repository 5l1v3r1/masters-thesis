W trakcie trwającej własnie corocznej konferencji Kaspersky’ego w Cancun firma ujawniła grupę włamywaczy działających od kilkunastu lat i wykazujących bardzo wysoki poziom zaawansowania technicznego, wskazujący na NSA. Analiza ujawnionych informacji pozwala na dość precyzyjne dopasowanie poszczególnych elementów oprogramowania zidentyfikowanego przez Kaspersky’ego do programów NSA opisanych w dokumentach wykradzionych przez Snowdena. W jednym z przypadków nazwa kodowa projektu NSA GROK znalazła się również w kodzie programu odpowiadającego jej opisowi. Nazwana przez Kaspersky’ego Equation Group działała praktycznie niezauważona od co najmniej 2001 roku i ma również wyraźne powiązania ze Stuxnetem i Flame. Kilkadziesiąt minut temu Kaspersky ujawnił jedną z najciekawszych informacji ostatnich tygodni, czyli opis działania włamywaczy nazwanych Equation Group. Wiele elementów tej historii jest dość wyjątkowych. Zacznijmy od czasu działania: najstarszy egzemplarz oprogramowania przypisywanego grupie powstał w roku 2001. Z kolei jeden z serwerów C&C używanych przez grupę używa domeny zarejestrowanej w roku 1996. Do tej pory nie mieliśmy do czynienia z grupami o tak długiej historii działania. Na trop grupy analitycy Kaspersky’ego trafili badając oprogramowanie Regin, użyte w ataku na firmę Belgacom. Powszechnie uznaje się, że Regin to narzędzie GCHQ – potwierdzają to dokumenty wyniesione przez Snowdena. Szukając „kuzynów” Reginu Kaspersky natrafił na całą grupę wyrafinowanego oprogramowania, którego poziom zaawansowania technicznego przekraczał wszystko, co analitycy widzieli do tej pory. Na przykład platforma nazwana GreyFish przechowuje swoje pliki w formie zaszyfrowanych kluczy w rejestrze Windows, dzięki czemu nie jest identyfikowana przez oprogramowanie antywirusowe. GreyFish odszyfrowuje swój kod jedynie na konkretnym, predefiniowanym komputerze – unikalny identyfikator jest kluczem odszyfrowującym pierwszy etap infekcji. GreyFish posiada także moduł umożliwiający modyfikowanie oprogramowania wbudowanych sterowników dysków twardych 12 różnych producentów, dzięki czemu potrafi przetrwać formatowanie dysku. Do modyfikowania firmware używa nieudokumentowanych funkcji producenta sprzętu. Producenci dysków, które potrafi infekować Equation Group (źródło: Kaspersky) Inne ciekawe przykłady zaawansowania technicznego to moduł Fanny, znaleziony w Pakistanie, który używał dwóch exploitów typu 0day zanim zostały one umieszczone w Stuxnecie. Inny zidentyfikowany błąd typu 0day używany przez Equation Group był wcześniej użyty w ataku typu 0day na Google (Operacja Aurora). Istnieje podejrzenie, że błąd ten został „poddany recyklingowi” i po przechwyceniu chińskiego ataku na Google użyty w amerykańskim ataku na Afganistan. Złośliwe oprogramowanie korzysta także z wirtualnych systemów plików, prawdopodobnie skutecznie infekuje platformy iOS i OS X i potrafi w oryginalny sposób omijać konieczność podpisywania kodu w ostatnich wersjach systemu Windows. Produkcje Equation Group (źródło: Kaspersky) W innym przypadku kod PHP autorstwa Equation Group sprawdza skróty MD5 nazwy użytkownika forum, zanim przeprowadzi proces infekcji. Pełen kod tego skryptu udało nam się znaleźć w sieci, zapewne wrzucony przez któregoś z pracowników Kaspersky’ego. Kaspersky przytacza także przykład anonimowego naukowca, któremu nadaje personalia Grzegorza Brzęczyszczykiewicza. Naukowiec ten w roku 2009 był na ważnej konferencji branżowej w Houston. Krótko po powrocie z imprezy otrzymał płytę z nagranymi zdjęciami z konferencji. Oprócz zdjęć płyta zawierała 3 exploity, z czego dwa typu 0day, które pomogły w zainstalowaniu oprogramowania Equation Group na jego komputerze. Inny podobny przypadek dotyczył płyty służącej do instalacji oprogramowania Oracle, które również zostało „wzbogacone” przez Equation Group. Ofiary Equation Group, zidentyfikowane dzięki szerokiej sieci instalacji oprogramowania Kaspersky’ego, zlokalizowane są głównie w Rosji, Afganistanie, Pakistanie, Belgii, Niemczech, Sudanie, Libanie oraz Palestynie. W przypadkach gdy oprogramowanie było znalezione na komputerach w USA lub Wielkiej Brytanii, za każdym razem ofiarą był działacz muzułmański. Ofiary Equation Group (źródło: Kaspersky) Jak wszyscy ludzie również najlepsi włamywacze popełniają błędy. Kaspersky zidentyfikował około 20 domen spośród 300, używanych jako C&C, które nie zostały na czas wykupione na kolejny rok przez swoich właścicieli. Firma je zarejestrowała i dzięki przechwyceniu ich ruchu poznała kolejne ofiary infekcji. Wśród nich znalazła się także domena z roku 2003, dzięki której udało się zidentyfikować kilkanaście ofiar, ciągle zarażonych po 12 latach od pierwszej infekcji. Inne ciekawe wpadki to zachowana w jednym pliku ścieżka do katalogu z nazwą użytkownika czy też nazwy zmiennych i plików, pokrywające się z katalogiem narzędzi NSA. Źródła: Wired, Ars Technica, Kaspersky ,Adam