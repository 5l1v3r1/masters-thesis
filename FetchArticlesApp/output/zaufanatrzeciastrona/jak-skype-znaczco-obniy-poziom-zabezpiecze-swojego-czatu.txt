Komunikacja za pomocą Skype’a jeszcze kilka lat temu była uważana za całkiem bezpieczną. Potem firma zmieniła właściciela, a przy okazji także podejście do prywatności użytkowników. Oto przykład, jaki poziom zabezpieczeń stosuje obecnie. Skype od początku swojego istnienia stawiał na poufność komunikacji. Służby całego świata narzekały, że nie da się podsłuchać rozmów prowadzonych za jego pomocą. A potem kupił go Microsoft i od tego dnia nic już nie było takie samo. W roku 2008 redakcja serwisu cnet zadała kilku producentom internetowych komunikatorów proste pytania dotyczące możliwości podsłuchania rozmów ich użytkowników. Na pytanie „Czy kiedykolwiek otrzymaliście nakaz podsłuchania komunikacji swoich użytkowników” Skype odpowiedział  Odpowiedź Skype’a w roku 2008 była prawdziwa. Komunikacja odbywała się bezpośrednio pomiędzy użytkownikami, omijając serwery firmy, a do tego była szyfrowana algorytmem AES z kluczem o długości 256 bitów. Co prawda nie wiemy, co drzemie w serwerowni NSA, ale powszechnie uznaje się ten rodzaj szyfrowania za bezpieczny. Nadszedł rok 2011, kiedy to Microsoft kupił Skype’a. Krótko potem użytkownicy zaczęli zauważać, że pakiety, które z reguły podróżowały między dwoma stronami rozmowy, zaczynają przechodzić przez serwery Microsoftu. Krok po kroku infrastruktura p2p została przerobiona na tradycyjną, oparta o scentralizowane serwery. W lipcu 2012 Washington Post poinformował, że Skype udostępnił organom ścigania możliwość czytania czatów użytkowników, jednak nie przedstawił na to żadnych dowodów – dopiero w lipcu potwierdziły to dokumenty Snowdena. Tymczasem w maju 2013 odkryto, ze linki, przesyłane w prywatnych wiadomościach Skype, są odwiedzane przez roboty Microsoftu. Oznaczało to wprost, że gigant z Redmond ma możliwość czytania treści rozmów. Faktycznie, na oficjalnej stronie programu znajduje się odpowiedź na pytanie, czy Skype korzysta z szyfrowania:  Krótko mówiąc „Drogi kliencie, kiedyś szyfrowaliśmy tak, że nikt tego nie mógł odszyfrować oprócz Ciebie, a teraz dla Twojej wygody zmieniamy szyfrowanie na takie, w którym możemy czytać Twoje wiadomości”. Co ciekawe, jeszcze w wersji strony z października zeszłego roku nie ma mowy o szyfrowaniu TLS, za to jeszcze w roku 2010 strona informowała, że czaty szyfrowane są za pomocą algorytmu AES. Jak jednak wygląda praktyczna możliwość odczytania cudzej konwersacji? Kilka dni temu jeden z pracowników firmy Blue Coat, wdrażającej platformy umożliwiające inspekcję ruchu internetowego, został zapytany, czy oferowany przez niego produkt potrafi zrekonstruować konwersację tekstową prowadzoną za pomocą Skype’a. Był zaskoczony tym pytaniem, ponieważ trwał w przekonaniu, że to niemożliwe, podczas kiedy osoba go pytająca twierdziła, że da się to zrobić. Przyjrzał się zatem ruchowi Skype’a i potwierdził, że faktycznie jest to wykonalne. Krótki eksperyment pozwolił ustalić, ze faktycznie w najnowszym kliencie Skype informacje przesyłane za pomocą czatu są jedynie szyfrowane z użyciem protokołu TLS – nie ma już mowy o szyfrowaniu całej komunikacji za pomocą algorytmu AES. Przeprowadzając atak typu MiTM na sesję TLS, badacz mógł zobaczyć treść odszyfrowanej komunikacji pomiędzy dwoma testowymi klientami Skype’a. Fragment rozmowy i zawartość pakietu (źródło: Blue Coat) Oczywiście wiadomości przesyłane są do serwerów Microsoft, gdzie mogą zostać w każdym przypadku przechwycone i zarejestrowane. Przy okazji badacz odkrył coś jeszcze. Okazuje się, że do przeprowadzenia ataku MiTM nie potrzeba wcale być posiadaczem certyfikatu SSL Microsoftu. Wystarczy do tego celu dowolny certyfikat, któremu zaufa podsłuchiwany komputer – niestety klient Skype’a nie posiada ograniczenia listy zaufanych certyfikatów. Oznacza to, że atak, umożliwiający podsłuchanie rozmowy nawet bez udziału Microsoftu może przeprowadzić każdy atakujący, który może wystawić zaufany certyfikat SSL dla odpowiedniej domeny. Nie jest to dobra wiadomość. Zapewne jeszcze rok temu uważalibyśmy tego rodzaju atak za mało prawdopodobny, jednak po ostatnich rewelacjach Snowdena trudno zachować podobny optymizm. Jeśli temat interesuje Was od strony technicznej, na stronie Blue Coat znajdziecie zrzuty pakietów oraz dużo więcej obserwacji na temat protokołu Skype’a, w tym również rozmów głosowych (na razie nie udało się ich odszyfrować, choć dostępne są pewne metadane). Przypominamy także, że ciągle działa opisywana przez nas sztuczka pozwalająca każdemu na ustalenie adresu IP dowolnego użytkownika Skype’a, jeśli tylko użytkownik ten logował się przez ostatnie 48 godzin. Jeśli ktoś lubi kombinować i jest wielkim miłośnikiem Skype’a to polecamy zapoznanie się z polskim programem SkypeHide, który umożliwia wykorzystanie Skype’a do steganografii. Jeśli ktoś jednak szuka prostszego rozwiązania, to może przydać się lektura skompilowanej przez nas listy potencjalnie bezpieczniejszych rozwiązań. ,Adam