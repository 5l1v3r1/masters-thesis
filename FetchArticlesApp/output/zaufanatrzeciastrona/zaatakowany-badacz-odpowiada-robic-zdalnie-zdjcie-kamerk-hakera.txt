Bardzo często opisujemy kolejne włamania, których ofiarami podają zwykli użytkownicy. Czasem jednak role się odwracają i to włamywacze stają się celami ataków. Taki los spotkał także początkującego chyba hakera, któremu badacz zrobił zdjęcie. Włamywacz, próbujący rozesłać klienta swojego botnetu, miał pecha, ponieważ jedna z jego wiadomości trafiła na konto Raashida Bhata, badacza złośliwego oprogramowania. Raashid postanowił odpłacić hakerowi pięknym za nadobne, przejął kontrolę nad jego komputerem, zrobił mu zdjęcie wbudowaną kamerą i je opublikował. Całą historię opisał na swoim blogu. Zaczęło się od wiadomości poczty elektronicznej z informacją o rzekomym znalezieniu niedaleko biura odbiorcy ciała jego współpracownika. Do wiadomości oczywiście załączone było „zdjęcie” ciała i prośba o jego rozpoznanie. „Zdjęcie” było plikiem image.scr z ikoną MS Painta. Raashid postanowił przyjrzeć się bliżej przesłanemu plikowi. Pierwszy rzut oka w IDA wskazał na użycie VBpackera. Po wypakowaniu oryginalnego pliku szybko można było stwierdzić, ze jest to klasyczny klient botnetu Zeus. Plik wykonywalny był tak zmodyfikowany, by nie uruchamiać się w formie rozpakowanej (sztuczka mająca być może zachęcić botmasterów do zakupu usługi szyfrowania i pakowania plików). Dla Raashida nie było to jednak dużą przeszkodą – na blogu opisuje krok po kroku sposób działania zabezpieczenia opartego na prostym szyfrowaniu i jak je ominął. Kiedy już posiadał działający plik binarny Zeusa postanowił sprawdzić, czy przez przypadek serwer C&C botnetu nie jest podatny na zdalne wykonanie kodu. Jest to podatność odkryta i opisana w roku 2010 a polega na dość banalnym ominięciu filtrów w procesie przesyłania na serwer danych od klienta botnetu. Zamiast spisu haseł użytkownika można przesłać plik PHP np. dodając do jego nazwy na końcu pojedynczą kropkę, a plik zostanie wykonany na serwerze. Aby przeprowadzić proces ataku trzeba znać klucz RC4, szyfrujący komunikację oraz adres podatnego serwera C&C. Obie dane można otrzymać po rozkodowaniu pliku konfiguracyjnego klienta botnetu. Dalszy ciąg ataku ułatwia fakt, że inny badacz, Xylitol, zbudował odpowiednie narzędzie automatyzujące uzyskanie zdalnego dostępu do powłoki na atakowanym serwerze. Po przejęciu kontroli nad serwerem wystarczy już tylko podłożyć odpowiedni moduł Metasploitu w panelu logowania (zapewne wykorzystujący błędy w przeglądarce ofiary) i poczekać na wizytę botmastera. Raashid uzyskał dostęp do komputera ofiary i dzięki Meterpreterowi wykonał zdjęcie hakera, który próbował zainfekować jego komputer. Zdjęcie botmastera Zdjęcie może nie jest najwyższej jakości (pewnie ze względu na duży kontrast…) ale stanowi bez wątpienia ładny element kolekcji trofeów badacza złośliwego oprogramowania. Co ciekawe podobny atak niecałe dwa lata temu udało się przeprowadzić gruzińskim badaczom, którzy sfotografowali atakującego ich rosyjskiego hakera. Za link dziękujemy Adamowi ,Adam