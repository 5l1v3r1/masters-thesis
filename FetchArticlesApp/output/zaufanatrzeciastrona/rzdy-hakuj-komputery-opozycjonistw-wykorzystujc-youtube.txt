Rządy wielu krajów wykorzystują zaawansowane rozwiązania techniczne i włamują się do komputerów i telefonów opozycjonistów. Wyciekła dokumentacja wskazująca, że jedną ze stron, do których wstrzykiwane są złośliwe fragmenty kodu, jest Youtube. Dwie komercyjne firmy, z usług których korzystają rządy co najmniej kilkunastu (jeśli nie kilkudziesięciu) krajów, od wielu lat reklamują swoje usługi umożliwiające zdalne włamywanie się do komputerów i urządzeń mobilnych na masową skalę. Są to Gamma International (niedawno zhakowana) oraz Hacking Team. Oprócz wspierania ataków typu spear phishing i dostarczania oprogramowania „monitorującego”, obie firmy oferują również modyfikację w locie ruchu użytkownika, umożliwiającą zainfekowanie jego komputera lub telefonu. Organizacja The Citizen Lab, opisująca działanie obu dostawców, otrzymała dostęp do dokumentacji ich najbardziej technicznie zaawansowanych platform sprzętowych przeprowadzających automatyczne ataki MiTM. Większość użytkowników sieci jest przekonana, że jeżeli będzie unikać klikania w podejrzane linki, otwierania nieznanych załączników i wchodzenia na mniej popularne witryny, uniknie również infekcji złośliwym oprogramowaniem. Niestety jeśli ich przeciwnikiem jest rząd korzystający z usług operatora sieci oraz firm Gamma International lub Hacking Team, mogą zostać zainfekowani chociażby odwiedzając serwis Youtube lub panel logowania do usług Microsoftu. Urządzenia to umożliwiające kosztują ok. miliona dolarów. Metoda infekcji, polegająca na modyfikacji ruchu użytkownika, nie jest niczym nowym i była już wielokrotnie opisywana. Szczegóły techniczne ataku znajdziecie w ostatnim paragrafie tekstu. Nowością jest potwierdzenie faktu istnienia i sposobu działania urządzeń, które umożliwiają przeprowadzanie takich ataków na masową skalę bez specjalistycznej wiedzy. „Pudełko wstrzykujące pakiety sieciowe” (network injection appliance) firmy Hacking Team wymaga wcześniejszego zainstalowania w sieci operatora internetu i zdefiniowania „celów” ataku. Celem jest identyfikator użytkownika – adres IP lub login usługi dostępu do sieci. Złośliwe urządzenie analizuje ruch użytkownika i w momencie, gdy zauważy wizytę w jednym z obsługiwanych serwisów, modyfikuje odpowiedź serwera, dołączając do niej złośliwy kod, którego zadaniem jest przejęcie kontroli nad komputerem ofiary. Jest to technika bardzo podobna do tej, z której korzysta NSA pod kryptonimem QUANTUMINSERT. Do przeprowadzenia tego rodzaju ataku wykorzystywany jest fakt, że jeszcze do niedawna zarówno Youtube jak i pierwsza strona panelu logowania do usług Microsoftu nie korzystały z protokołu HTTPS. Powodowało to, że zawartość pakietów danych była nie tylko widoczna dla atakującego, ale także podatna na manipulację. Gdy Google i Microsoft dowiedziały się o praktyce Hacking Teamu, zintensyfikowały prace nad przeniesieniem swoich usług w całości na HTTPS. Na szczęście dla Czytelników w dotychczas ujawnionych przypadkach opisywane powyżej rozwiązania stosowane były jedynie w krajach o niższych standardach demokracji takich jak Oman, Turkmenistan, Bahrajn, ZEA, Maroko i Etiopia (choć serwery pośredniczące w odbieraniu ruchu z monitorowanych komputerów swojego czasu zlokalizowano również w Polsce). Nigdy jednak nie wiemy, kiedy służby krajów europejskich sięgną po podobny arsenał środków. Pamiętajmy, że w projekcie zmiany ustawy o Policji z 2009 roku znalazł się fragment o treści:  z uzasadnieniem nie pozostawiającym wątpliwości, o co może chodzić:  Na szczęście projektowane zapisy nie zostały uchwalone. Jeszcze. Jedną z opcji urządzenia FinFly ISP , przeznaczonego do instalowania w sieciach operatorskich, jest możliwość infekowania w locie plików binarnych. Pliki PE są identyfikowane w trakcie próby ich pobrania z sieci. Dodawany jest do nich odpowiedni moduł ładujący oraz właściwy złośliwy program, z zachowaniem zarówno ikony jak i treści oryginalnie pobieranego pliku. Tak zmodyfikowany plik po jego uruchomieniu instaluje złośliwe oprogramowanie po czym automatycznie usuwa swoje ślady z „nosiciela”, dzięki czemu późniejsza analiza nie wskaże na jakiekolwiek anomalie. Znacząco utrudnia to zlokalizowanie źródła infekcji. Sam plik źródłowym wykonywany jest dopiero po tym, jak złośliwe oprogramowanie usunie swoje ślady, dzięki czemu instalatory sprawdzające swoją własną sumę kontrolną nie zgłoszą żadnego problemu. Inną opcją jest wymuszenie fałszywej aktualizacji. Odpowiedni moduł nasłuchuje zapytań o nowe wersje popularnych programów typu iTunes czy Winamp (no dobrze, kiedyś popularnych). Jeśli trafi na takie zapytanie, fałszuje odpowiedź serwera wymuszając aktualizację z podstawionego pliku. Oczywiście mechanizm ten działa jedynie w przypadku, gdy aktualizacje pobierane są przez HTTP. Architektura wdrożenia FinFly ISP Sam proces wyboru celu i jego infekcji przebiega następująco: Serwer infekujący odpowiada za przeliczenie sum kontrolnych w ramach infekowanego protokołu, by ruch mógł zostać prawidłowo wstrzyknięty ponownie do sieci. Bardziej zaawansowane opcje oferuje usługa FinFly Web oraz FinFly Exploit Portal. FinFly Web pozwala na wstrzyknięcie odpowiedniego fragmentu kodu do każdej odwiedzanej strony WWW. Przykład takiego ataku został uchwycony w Bahrajnie. Przykład ataku FinFly Web Jest to połączenie ataku technicznego z socjotechnicznym, którego celem jest nakłonienie ofiary do zainstalowania „aktualizacji Flash Playera”. Z kolei „najwyższy” poziom ataku oferuje opcja Exploit Portal, gdzie dostawca zapewnia możliwość przeprowadzenia ataku typu 0day na przeglądarkę lub jej wtyczki. Co ciekawe, w dokumentacji znajduje się informacja, że dostawcą exploitów jest firma VUPEN. Z kolei VUPEN zarzeka się, że exploity sprzedaje jedynie rządom, a nie prywatnym firmom. Gamma International w ramach swojej oferty gwarantuje, że w użyciu zawsze będą co najmniej cztery exploity 0day a na każdy z nich daje 30 dni gwarancji skuteczności. Z kolei „Network Injector” oferowany przez Hacking Team jest wyspecjalizowany w „obsłudze” Youtube, choć zna także inne sztuczki. Oferuje następujące możliwości: Narzędzia Hacking Team Poinformowany przez The Citizen Lab Microsoft wymusił HTTPS na wszystkich komponentach panelu logowania do swoich usług. Z kolei Google umożliwia korzystanie z HTTPS w Youtube użytkownikom wtyczki HTTPS Everywhere i bardzo intensywnie pracuje nad przeniesieniem wszystkich funkcji serwisu na HTTPS. Wygląda na to, ze wkrótce najwięksi dostawcy usług nie będą mieli innego wyboru, jak szyfrować całość swojego ruchu, by chronić swoich użytkowników przed rządowymi zakusami. Polecamy lekturę całego raportu Morgana Marquis-Boire’a. ,Adam