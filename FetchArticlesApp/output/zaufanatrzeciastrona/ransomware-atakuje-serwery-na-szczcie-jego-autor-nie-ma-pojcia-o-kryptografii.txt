Na rynku programów szyfrujących cudze pliki pojawił się nowy gracz, atakujący linuksowe serwery WWW. Na szczęście dla poszkodowanych autor kodu miał mgliste pojęcie o zasadach generowania liczb pseudolosowych i dane można odzyskać. Do ransomware atakującego stacje robocze działające pod kontrolą systemu Windows zdążyliśmy się już w ostatnich latach przyzwyczaić. Ciekawostką jest pojawienie się kilka dni temu programu którego zadaniem jest szyfrowanie plików serwerów linuksowych. Są także polskie ofiary. Rosyjska firma antywirusowa Dr. Web opisała 5 dni temu ciekawy przypadek złośliwego oprogramowania. Pod nazwą Linux.Encoder.1 przedstawiła pierwszy znany egzemplarz oprogramowania szyfrującego pliki na serwerach WWW. Program wyszukuje serwery z podatnymi skryptem Magento (wykorzystuje błąd znany od kwietnia tego roku). Uruchomiony z odpowiednimi uprawnieniami szyfruje pliki w folderach Następnie przechodzi do folderów zaczynających się od i szyfruje wszystkie pliki o rozszerzeniach Opuszcza jedynie foldery Pliki szyfrowane są za pomocą klucza symetrycznego i trybu AES-CBC-128 a w każdym zaatakowanym folderze umieszczany jest plik README_FOR_DECRYPT.txt. Klucze symetryczne użyte do szyfrowania są zabezpieczane kluczem asymetrycznym RSA. Na całe szczęście proces szyfrowania, a konkretnie generowania kluczy AES, został fatalnie popsuty przez autora, dzięki czemu możliwe jest odzyskanie oryginalnych plików. Badacze z firmy Bitdefender przeanalizowali kod złośliwego oprogramowania i z zaskoczeniem odkryli, że z powodu banalnego, krytycznego błędu popełnionego przez jego autora w procesie generowania kluczy AES, są one możliwe do odzyskania bez potrzeby łamania szyfrowania RSA. Okazało się, że klucze szyfrujące i wektory inicjujące tworzone są w sposób całkowicie nielosowy poprzez wywołanie funkcji libc rand() z wartością wejściową w postaci znacznika czasu, zgodnego ze znacznikiem momentu tworzenia zaszyfrowanego pliku. Pozwoliło to Bitdefenderowi na opracowanie i udostępnienie skryptu automatycznie odszyfrowującego utracone pliki. Zaatakowanych serwerów niestety nie brakuje – są wśród nich także polskie adresy. Polskie ofiary ataku Według F-Secure szantażyści mogli już zarobić ok. 12 tysięcy dolarów. Koszt odszyfrowania jednego serwera to 1 BTC. Mamy nadzieję, że po ujawnieniu błędów ransomware wpływy przestępców spadną do zera.,Adam