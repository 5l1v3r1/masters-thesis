Ataki na hashe haseł użytkowników Windowsa, choć kiedyś bardzo łatwe, w ostatnich latach przestały być trywialne. Z pomocą pentesterom wychodzi jednak Microsoft, wprowadzając w Windows 8 nową funkcjonalność, znacznie ułatwiającą zadanie. Badanie mechanizmów bezpieczeństwa rozwiązań nie ujawniających kodu źródłowego musi być ciekawą przygodą. Bez wątpienia takiej przygody doświadczyli specjaliści firmy Passcape Software, którzy odkryli interesujące mechanizmy bezpieczeństwa w nowym systemie operacyjnym Microsoftu. Windows 8 wprowadził dwie nowe metody uwierzytelnienia użytkownika. Pierwsza to znany z telefonów komórkowych kod PIN (jak reklamuje Microsoft, nie wymaga klikania „Zaloguj” ani naciskania klawisza „Enter”, ponieważ wystarczy podać 4 cyfry i system automatycznie rozpoczyna proces logowania), druga metoda to „hasło zdjęciowe„, polegające na narysowaniu odpowiedniego, zdefiniowanego wcześniej wzorku na wybranym zdjęciu z naszej kolekcji. Ta metoda wg Microsoft ułatwia zapamiętanie wzoru, ponieważ rysujemy go na tle, z którym się identyfikujemy lub czujemy powiązani emocjonalnie.  Hasło zdjęciowe (źródło: Microsoft)  Pomijając już komentarze dotyczące tych obu nowych metod logowania, spójrzmy, co dzieje się za kurtyną. Otóż by umożliwić użytkownikowi korzystanie z PIN-u lub „hasła zdjęciowego”, Windows zapisuje sobie jego oryginalne hasło. Widzicie już problem? Pracownicy Passcape odkryli, że oryginalne hasło użytkownika (które musi podać, by skonfigurować alternatywna metodę logowania), jest zapisywane w bezpiecznym folderze (Vault) w lokalizacji Folder niestety tylko z nazwy jest bezpieczny. Umieszczane są w nim hasła (wraz z SIDami) wszystkich użytkowników, którzy zdecydowali się skorzystać z PIN-u lub „hasła zdjęciowego”. Dane te są zaszyfrowane algorytmem AES, jednak pliki nie są chronione przed odczytem przez użytkownika z uprawnieniami administratora (lub np. przysłowiowego chińskiego hakera, który nie musi już łamać hashy Windowsa). Co istotne, przechowywane hasła nie są w żaden sposób powiązane z kodem PIN lub wzorem „hasła zdjęciowego”, umożliwiając ich odczytanie innemu użytkownikowi. Co prawda klucz AES zabezpieczony jest mechanizmem DPAPI, którego pokonanie nie jest trywialne, jednak istnieją narzędzia, które czynią to możliwym. Jak pewnie możecie się domyśleć, firma Passcape również nie mogła oprzeć się pokusie i funkcjonalność odczytywania hasła użytkownika dodała do swojego pakietu Windows Password Recovery. Passcode opisał także w szczegółach, jak działa odczytywanie zawartości „bezpiecznego folderu”. Niedawno opisywaliśmy podobny problem odkryty w czytnikach linii papilarnych firmy UPEK. Tam również autorzy oprogramowania nie odnaleźli bezpiecznej metody przechowywania haseł użytkowników, które miały zastąpić ich odciski palców. Użytkownikom, którzy muszą szczególnie dbać o bezpieczeństwo swoich danych, polecamy zatem unikanie uproszczonych metod uwierzytelnienia (a rekomendujemy skorzystanie z uwierzytelnienia dwuskładnikowego).,Adam