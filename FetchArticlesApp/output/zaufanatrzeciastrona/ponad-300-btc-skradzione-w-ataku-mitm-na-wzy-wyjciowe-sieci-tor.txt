(źródło: btckeychain) W ciągu ostatnich kilku dni tajemniczy złodziej przywłaszczył sobie ponad 320 bitcoinów należących do użytkowników portfela Blockchain.info. Wszystkie ofiary łączy jedno – ze swoim portfelem online łączyły się przez sieć Tor. To był zły pomysł. Jedną z największych, a zarazem stosunkowo mało znanych wad sieci Tor jest narażenie jej użytkowników na ataki typu Man in The Middle prowadzone przez złośliwych operatorów węzłów wyjściowych. Taki węzeł może na przykład doklejać konie trojańskie do pobieranych plików wykonywalnych, ale może także przechwytywać hasła do portfeli BTC prowadzonych w sieci. Pierwsze zgłoszenie poszkodowanej osoby, które znaleźliśmy, pochodzi sprzed 2 dni. Na Reddicie użytkownik Blockchain.info poskarżył się, że z jego konta zniknęło nieco ponad 1 BTC. Podał także adres portfela, na które powędrowały jego bitcoiny. Dzisiaj z kolei odezwał się inny poszkodowany, który z kolei stracił 2,5 BTC a twierdził, że dba o bezpieczeństwo, jego hasło ma ponad 80 znaków a korzysta z platformy linuksowej. Analiza użytkowników Reddita pozwoliła na ustalenie przyczyny kradzieży – obie ofiary korzystały z sieci Tor i portfela Blockchain.info. Jak najprawdopodobniej doszło do ataku? Ofiary złodziei łączyły się za pośrednictwem sieci Tor ze stroną WWW. Miały pecha, ponieważ ich połączenie wychodziło do internetu przez węzeł sieci, którego operatorem był złodziej. Złodziej, aby podsłuchać ich loginy i hasła, musiał najpierw poradzić sobie z protokołem HTTPS. Podrobienie certyfikatu strony jest praktycznie niemożliwe, lecz atak nie był trudnym zadaniem – są gotowe narzędzia, które widząc żądanie HTTPS automatycznie zamieniają je na HTTP. Użytkownicy najwyraźniej nie zwrócili uwagi na to, że strona, którą otwierali, nie zapewniała już szyfrowania transmisji. Istnieją także narzędzia, które zamieniają ikonkę strony (favicon) na taką, która przypomina charakterystyczną kłódkę HTTPS, by optycznie oszukać użytkowników. Po przechwyceniu loginu i hasła atakujący mógł wypłacić środki, ponieważ poszkodowani nie korzystali z dwuskładnikowego uwierzytelnienia. Choć osoby, które opisały na Reddicie swoje przygody, straciły relatywnie niewielkie sumy, to analiza rachunku złodzieja pokazuje, że jego łączne przychody wyniosły 321 BTC a jedna z ofiar straciła aż 254 BTC. Obroty na rachunku pokazują także, że do kradzieży dochodziło od 21 listopada tego roku a ostatnia transakcja miała miejsce wczoraj. Co ciekawe, już 4 dni temu Blockchain.info wprowadził filtr blokujący połączenia z sieci Tor więc najwyraźniej jego administratorzy zdają już sobie sprawę z zagrożenia. Rachunek złodzieja Warto przy tej okazji po raz kolejny przypomnieć, że Tor nie jest uniwersalnym narzędziem, zapewniającym użytkownikom magiczną odporność na wszystkie ataki. Między innymi z tego powodu warto oprócz Tora korzystać z połączenia VPN lub bardzo pilnie weryfikować, czy strona, którą otwieramy, zawsze oferuje połączenie szyfrowane.,Adam