Nasz poprzedni artykuł o stacjach numerycznych zrobił w sieci furorę, zatem kontynuujemy temat. Czy wiecie, że polski kontrwywiad co najmniej od lat 60. podsłuchiwał stacje numeryczne i potrafił odszyfrowywać niektóre nadawane przez nie komunikaty? W trakcie poszukiwań materiałów do naszych artykułów natrafiliśmy w magazynie Cryptologia na niezwykle ciekawe opracowanie kilku niedawno odtajnionych materiałów polskiego kontrwywiadu z lat 70. i 80., dotyczących metod jednokierunkowej łączności szpiegowskiej stosowanej przez wywiady niemiecki oraz amerykański (Bury, Jan. „From the Archives: The US and West German Agent Radio Ciphers.” Cryptologia 31.4 (2007): 343-357). Poniżej znajdziecie najciekawsze fragmenty tych dokumentów. Istniejące dokumenty wskazują, że w latach 1960 – 1975 polski kontrwywiad przechwytywał i kontrolował komunikaty przesyłane przez niemieckie stacje numeryczne do 12 różnych agentów (4 amerykańskich i 8 niemieckich) zwerbowanych w Polsce i wyposażonych w odbiorniki radiowe. Według raportu nadajniki stacji numerycznych znajdowały się we Frankfurcie oraz w Monachium. Nadajnik frankfurcki rozpoczął swoją działalność w lutym 1959 roku i pokrywał zasięgiem całą Europę. Według polskiego kontrwywiadu obsługiwał on ok. 200 agentów. Z ośmiu agentów, odbierających rozkazy z tego nadajnika a namierzonych przez Polaków, jeden został aresztowany a pozostałych 7 było prowadzonych przez polski kontrwywiad w ramach gry operacyjnej. Z kolei nadajnik w Monachium miał dużo większy zasięg i jego sygnał mógł docierać w każdy zakątek świata. Z niego dla odmiany korzystali agenci prowadzeni przez wywiad amerykański, a w sumie obsługiwał podobno ok. 220 odbiorców. Dzięki grze operacyjnej polski kontrwywiad zdobył dostęp do zarówno algorytmów, jak i kluczy używanych do szyfrowania przesyłanych wiadomości. Poniżej znajdziecie przykłady poznanych przez Polaków algorytmów szyfrowania. Wywiady niemiecki oraz amerykański stosowały różne techniki szyfrowania dla różnych agentów, dostosowane zapewne do ich znajomości języków obcych, inteligencji i wagi przekazywanych informacji. Z reguły niemieccy agenci otrzymywali trzycyfrowy kod wywoławczy oraz byli wyposażani co najmniej w dobrej jakości odbiornik krótkofalowy (czasem używany był zwykły odbiornik z dodatkową przystawką z odpowiednim rezonatorem kwarcowym i zewnętrzną anteną), plan komunikacji wskazujący dni tygodnia, godziny transmisji oraz odpowiednie częstotliwości, klucze jednorazowe oraz klucz stały (najczęściej DEIN STAR dla agentów niemieckojęzycznych oraz ZA OWIES dla agentów, którzy nie znali tego języka). Klucz stały wyglądał następująco:  Klucz „ZA OWIES”  Osoby spostrzegawcze zauważą, że w kluczu niektóre litery są zdublowane, a innych brakuje – to prawdopodobnie błędy transkrypcji autora opracowania, z którego korzystaliśmy. Jak zatem wyglądało odszyfrowywanie wiadomości? Sprawdźmy na przykładzie. Agent posiadał wiele kluczy jednorazowych. Patrzymy teraz na tablicę powyżej i stosujemy następujące zasady: pary cyfr zaczynające się od 2, 3 i 4 wyszukujemy jako współrzędne na tablicy, cyfry 0, 5, 6, 7, 8, 9 odpowiadają literom znajdującym się w pierwszym wierszu a w tekście odkodowanym wartości pomiędzy literami „Y” to numery wywoławcze. Odkodujmy zatem tekst. Jest to zatem wiadomość o treści PRSZE (proszę) skierowana do agenta 111. Metoda szyfrowania sprawia, że bez znajomości odpowiedniej tablicy oraz klucza odszyfrowanie jest praktycznie niemożliwe. Każda tablica była wykorzystywana tylko jeden raz i po jej użyciu niszczona. Tablice kodów jednorazowych wyglądały na przykład tak:  Książka kodów jednorazowych (źródło: Crypto Museum)  Agenci amerykańskiego wywiadu nie otrzymywali stałych numerów wywoławczych. Dostawali za to dobrze zakamuflowane karty kodów jednorazowych – mógł to być na przykład katalog z jakiejś wystawy lub niemiecki leksykon zdrowia. Prześledźmy, w jaki sposób szyfrowane były komunikaty przeznaczone dla jednego z amerykańskich agentów, Jerzego Strawy, zatrzymanego w roku 1967 i skazanego na karę śmierci za szpiegostwo. Klucz służący do deszyfracji komunikatu wyglądał następująco: Klucz deszyfrujący Cyfry 1, 4, 8, 9, 3 oraz 0 pochodziły z daty urodzin żony agenta (14 sierpnia 1930). Jeśli w wiadomości pojawiła się którakolwiek z nich, to odpowiadała jej jedna litera słowa KARTEN. Jeśli z kolei z komunikacie pojawiały się cyfry 2, 5, 6 lub 7, to były one wraz z kolejnymi cyframi wykorzystywane jako współrzędne wskazujące na litery z czterech dolnych rzędów. Następnie trzeba sięgnąć do odpowiedniej strony w książce kodów jednorazowych. Stronę wybieramy dodając do dnia roku, w którym nastąpiła transmisja, liczbę 10 (np. dla 24 marca jest to 93). Następnie z tej strony przepisujemy co 10 literę i wpisujemy je pod zdekodowanym tekstem: Te dwa ciągi traktujemy jako koordynaty do zmodyfikowanej tablicy Vigenère’a:  Tablica ostatniego etapu deszyfracji  To już ostatni etap, na którym otrzymujemy właściwą wiadomość o treści SZESCXXWXPRZYSZLO. Jak więc widzicie, wiadomości nadawane przez stacje numeryczne mogą zostać w relatywnie prosty sposób odkodowane z użyciem kartki i ołówka – trzeba jednak dysponować odpowiednią wiedzą i kluczami jednorazowymi oraz stałymi. Według polskiego kontrwywiadu wywiad niemiecki od roku 1956 korzystał z jednokierunkowych transmisji radiowych do kontaktu ze swoimi agentami na terenach znajdujących się za żelazną kurtyną. W przypadku agentów w krajach trzeciego świata już w latach 50. funkcjonowała łączność dwukierunkowa – zapewne niemiecki wywiad nie obawiał się służb kontrwywiadowczych w krajach mniej rozwiniętych. Niemcy starali się jednak zapewnić swoim agentom możliwość przesyłania komunikatów do centrali drogą radiową w sposób, który będzie niemożliwy do namierzenia przez wrogie służby. Jak wiadomo, namierzanie sygnału radiowego wymaga czasu. Nawet najlepiej przygotowana operacja lokalizacji źródła sygnału nie zakończy się sukcesem, jeśli cała transmisja będzie trwać sekundę. Dlatego też począwszy od lat 60. agencji niemieckiego wywiadu otrzymywali nadajniki umożliwiające „kompresję” transmisji. Starsze egzemplarze korzystały z taśmy papierowej, wcześniej odpowiednio zakodowanej, która następnie była w dużym tempie odczytywana przez nadajnik, a nowsze modele opierały się już na specjalnych kasetach z taśmą magnetyczną. Przykładem takiego urządzenia może być chociażby model AN/GRA-71. Starsze egzemplarze transmitowały dane z prędkościami od 90 do 360 bodów, nowsze, wydawane od roku 1977, osiągały 600 bodów (nie znamy niestety stosowanej modulacji, ale prawdopodobnie mówimy tu o prędkościach od 600 do 1200 bitów na sekundę). Nadajniki te działały albo zasilane prądem z gniazdka, albo z baterii, dzięki czemu możliwe było nadawanie z dowolnej lokalizacji. W sieci możecie obejrzeć całą ich kolekcję.  Zestaw do BKN (źródło: Crypto Museum)  Polskie służby miały spory problem nie tylko z namierzaniem, ale nawet z wykrywaniem tych transmisji. O ile w roku 1973 zarejestrowały ich około setki, rok później 66, a już w roku 1977 udało im się uchwycić ich jedynie 5. Transmisje te zwane były w żargonie służb BKN, czyli Bardzo Krótkie Nadawanie. Przykładem problemów z namierzaniem źródła sygnału może być przypadek z 17 października 1966, kiedy to o godzinie 21:08 wykryto transmisję BKN z okolic Szczecina. Mimo, iż trwała ona aż 24 sekundy (a więc była nadzwyczaj długa jak na ten rodzaj komunikacji) a po kolejnych 4 minutach nastąpiła druga transmisja, która trwała 17 sekund i została przechwycona przez aż 5 stacji namierzających, to nie udało się jednoznacznie ustalić lokalizacji nadajnika. Wytypowano jedynie obszar znajdujący się na terenie Zalewu Szczecińskiego dochodząc do wniosku, że transmisja miała miejsce z jednostki pływającej. Podobną historię opisuje w swojej książce „Czwarty protokół” Frederick Forsyth (thx tolep):  Na koniec tej części cyklu mała ciekawostka – stacja numeryczna pojawiła się w polskim filmie „Hasło Korn”, opowiadającym o walce dzielnego polskiego kontrwywiadu z zagraniczną siatką szpiegowską. Podobno autorzy filmu poprosili znajomych z „branży” o dostarczenie nagrania, które zabrzmi wiarygodnie jako wroga transmisja i oto, co dostali: Nasz ulubiony fragment narracji to „aparatura elektroniczna rozszyfrowała kod, jakim nadawane są depesze”. Prawda jak już wiecie była trochę inna – to praca kontrwywiadu pozwoliła rozszyfrować depesze – aparatura elektroniczna nawet dzisiaj nie potrafi sobie poradzić z kluczami jednorazowymi. To nasz drugi, ale nie ostatni artykuł na temat stacji numerycznych. Na kolejny trzeba będzie poczekać kilka tygodni – wyciąganie materiałów z niektórych archiwów bywa czasochłonne…,Adam