Popularne “dongle” USB, służące do podpięcia komputera do mobilnego internetu są podatne na ataki i obniżają bezpieczeństwo komputerów, do których są podpinane. Rahul Sasi poddał analizie modemy sprzedawane przez kilku operatorów i we wszystkich znalazł poważne błędy. Jak działają modemy 3G na USB? Szacuje się, że na świecie w użyciu jest ponad 80 milionów modemów. Producentem większości z nich jest firma Huawei. Modemy umożliwiają podłączenie komputera do sieci GSM/CDMA. Domyślnie, producenci i sprzedawcy (czyli sieci GMS) wraz z modemami przekazują użytkownikom sterowniki z oprogramowaniem do obsługi modemu (tzw. dialery). Architektura komunikacji pomiędzy komputerem a modemem i siecią wygląda tak: Dialer umożliwia wydawanie modemowi komend AT, przy pomocy których modem “wdzwania się” do sieci GSM. Dzięki podpięciu do sieci GSM, modem może odbierać i wysyłać SMS-y. I tu zaczyna się zabawa… Fuzzowanie modemów 3G Rahul postanowił wysłać szereg niestandardowych wiadomości SMS, żeby zweryfikować, jak poradzi sobie z nimi parser SMS-ów wbudowany w oprogramowanie modemu. Każdy przychodzący SMS jest bowiem automatycznie odbierany, interpretowany i umieszczany zazwyczaj w bazie sqlite. Jedną z podatności, jaką udało mu się wywołać był crash modemu po odebraniu odpowiednio spreparowanej wiadomości SMS. Wstrzyknięcie shellcode’u przez SMS-a Chociaż przy pomocy odpowiednio zmodyfikowanych wiadomości SMS nie udało się wstrzyknąć meterpretera, to Rahul napisał skutecznego exploita (mieszczącego się w jednej wiadomości SMS), który zapisuje dane do pliku c://hack.txt. Oto jego demonstracja: Rahul zastrzega jednak, że nie udostępni jednak swojego exploita przez najbliższe 3 miesiące. Powodem jest brak funkcji automatycznej aktualizacji oprogramowania na modemach umożliwiającej załatanie modemów w krótkim czasie. Reakcja Huawei Ciekawa jest reakcja Huawei na zgłoszone przez Rahula błędy w modemach USB. Najpierw firma nie odpowiedziała, żeby po kilku dniach wysłać Rahulowi z automatu …życzenia świąteczne z okazji chińskiego Nowego Roku. Po kilku następnych dniach, dział bezpieczeństwa Huawei skontaktował się z Rahulem na jego inny adres e-mail, podpytując, czy prezentacja, którą będzie wygłaszał na nadchodzącej konferencji dotyczy może modemów Huawei… Koniec końców Huawei poprawił błędy, ale ponieważ modemy nie mają funkcji automatycznej aktualizacji firmware’u, ich użytkownicy muszą sami znaleźć, pobrać i zaaplikować łatkę. Warto tu wspomnieć, że większość operatorów GSM, którzy “brandują” modemy pod siebie, w ogóle nie informuje swoich klientów o jakichkolwiek poprawkach bezpieczeństwa — są więc spore szanse, że praktycznie nikt nie wgrał patchy na błędy znalezione przez Rahula… Rahul badał modemy dedykowane na rynek indyjski — wiele jednak wskazuje na to, że problemy z parsowaniem SMS-ów dotyczą także innych modelów… Warto przy tym zauważyć, że ponieważ kanał komunikacji to SMS (sieć GSM), systemowy firewall nie ochroni nas przed tym atakiem… Atakujący co prawda musi przewidzieć numer ofiary — albo pójść na łatwiznę i masowo rozesłać exploita na wszystkie numery danego operatora… PS. Rahul w swoich badaniach skorzystał ze sniffingu USB (na Mac OS X istnieje fajny sniffer; na Windows można skorzystać z SnoopyPro, a na Linuksie z Wiresharka). ,vi.curry