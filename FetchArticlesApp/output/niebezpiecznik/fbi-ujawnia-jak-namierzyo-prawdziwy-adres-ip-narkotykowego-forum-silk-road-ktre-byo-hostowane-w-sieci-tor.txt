FBI przedstawiło podczas rozprawy przeciw aresztowanemu administratorowi forum Silk Road ciekawe dokumenty. Można z nich dowiedzieć się jak służby miały namierzyć prawdziwy adres IP serwera, który był hostowany w zapewniającej (jak widać — nie zawsze) anonimowość sieci Tor. Co ciekawe, technika z której skorzystało FBI nie jest spektakularna, a do ustalenia prawdziwego adresu IP serwera przyczyniła się CAPTCHA. Ross Ulbricht broni się jak może i oskarża FBI O zamknięciu Silk Roadu w obszernym artykule informowaliśmy prawie rok temu. Wtedy jedną z najbardziej prawdopodobnych hipotez, która miała wyjaśniać zatrzymanie Rossa Ulbrichta (występującego pod pseudonimem Dread Pirate Roberts) było wsypanie go przez osobę, której zlecił morderstwo jednego z moderatorów Silk Roada — choć niektórzy podejrzewali też, że podobnie jak w przypadku namierzenia i zdjęcia Torowej hostingowni o nazwie Freedom Hosting, służby mogły zastosować nieznany dotąd exploit (tzw. 0day’a). Pełną rozpiskę wydarzeń związanych z bezpieczeństwem Silk Road, wraz z podanymi datami, znajdziecie na tej stronie. Obecnie rząd USA licytuje część przejętego majątku Rossa (30 000 bitcoinów o wartości 56 milionów złotych) a sam Ross, któremu postawiono 7 zarzutów, próbuje na wszelkie sposoby odwoływać się od decyzji sądu i unikać odpowiedzialności prawnymi sztuczkami. Niektóre z zarzutów chciał odeprzeć oskarżając FBI o nielegalne przeszukania naruszające tzw. 4 poprawkę do konstytucji USA oraz nielegalną współpracę z NSA. Obrona Rossa liczy na to, że jeśli sąd podtrzyma taki sprzeciw, to wszystkie dowody zebrane w sprawie z Silk Roadowego serwera, będą musiały zostać odrzucone. W odpowiedzi na powyższe oskarżenia, służby przedstawiły właśnie opis tego, jak namierzyły prawdziwy adres IP Torowego serwer Silk Roadu. Jak namierzono prawdziwy adres IP serwera Silk Roada? Z dokumentów dowiadujemy się, że do islandskiego data center FBI dotarło …bawiąc się stroną logowania do Silk Roadu. Co oznaczają te “zabawy”? Czy do pomocy wezwano NSA? Czy skorzystano z exploita na nieznaną dotąd podatność? Nie i nie. Serwer Silk Roadu miał zostać namierzony w czerwcu zeszłego roku. Jeden z agentów FBI miał odnaleźć element na stronie, który z racji błędnej konfiguracji ujawniał prawdziwy adres IP serwera (a zatem i jego fizyczną lokalizację). FBI twierdzi, że …i zauważyło, że w jednym z przypadków zwrócone zostały dane zawierające adres IP nie pasujący do żadnego znanego węzła Tor. Kiedy agent wprowadził ten adres IP bezpośrednio do przeglądarki, na jego ekranie miała pojawić się CAPTCHA z Silk Roadu. To miało dowieść tego, że rzeczywiście serwer o danym adresie IP hostuje narkotykowe forum. Dalej w oświadczeniu FBI czytamy: FBI twierdzi, że działało legalnie Według FBI nie ma tu mowy o żadnym nielegalnym szpiegowaniu czy też nielegalnej współpracy z NSA, a zatem sprzeciw obrony Rossa należy oddalić. Dodatkowo FBI twierdzi, że kopię dysków serwera wykonała miejscowa policja z Reykjaviku, a nie amerykańskie służby, dlatego zdobycie nakazu w tym celu nie było konieczne. FBI wskazuje ponadto, że Ross i tak nie ma za wiele do powiedzenia w tym przypadku, ponieważ to nie on był właścicielem serwera — on go jedynie wynajmował zgadzając się przy tym na regulamin usługi najmu, który jasno wspominał o “możliwości monitoringu w celach upewnienia się, że serwer jest wykorzystywany w sposób zgodny z prawem”. Na koniec warto zauważyć, że FBI odrzuciło prośbą obrony o przekazanie listy wszystkich kontraktorów z którymi współpracowało w celu namierzenia lokalizacji serwera i ustalenia prawdziwej tożsamości Dread Pirate Robertsa, a także nie zgodziło się na przekazanie listy oprogramowania wykorzystanego do skanowania serwera pod kątem potencjalnych dziur (a to byłoby bardzo interesujące). “Wpisywanie różnych znaków?” Społeczność specjalistów ds. bezpieczeństwa zastanawia się jak mogło, na skutek “wpisywania różnych znaków” dojść do wycieku adresu IP serwera. Wnioski prowadzą jedynie do udanego ataku SQL injection. Niektórzy z badaczy już ganią FBI za hipokryzję. Agenci ścigają bowiem obywateli za wykonywanie ataków SQL injection, ale jak przyjdzie co do czego, to jak widać sami stoją ponad prawem i mogą bez przeszkód korzystać z tych samych “zakazanych” technik. Niestety tego jak było naprawdę nie dowiemy się nie zaglądając w logi. Być może obrona będzie domagała się ujawnienia logów (jeśli prawdą jest to, o czym informuje FBI, ślady “wpisywania różnych znaków” mogą znajdować się w logach — ale jeśli ich tam nie ma, to obrona może zyskać nowy punkt zaczepienia w walce o odrzucenie części zarzutów). Czy FBI naciąga zeznania żeby ukryć prawdziwy wektor ataku? Być może (zwłaszcza, że nielegalne pozyskanie dowodu mogłoby zatopić sprawę przeciw Rossowi). Ale warto nadmienić, że wyciek adresu IP nie jest taki “niezwykły”, zwłaszcza dla Silk Roadu. Serwer Silk Roada “sam z siebie” bowiem nie raz przynujawniał swoje IP. Sam Ross wspomina to w swoim dzienniku, przejętym przez FBI (poniższe zapiski pochodzą z oświadczenia FBI) Oczywiście możliwe jest, że FBI dotarło do adresu IP Silk Roadu w inny sposób niż poprzez “wyciek” (czyli sposób nie tak legalny jak “podejrzenie źródła odpowiedzi HTTP”), a swoje zeznania naciągnęło, aby były wiarygodne i trudne do obalenia. Problem w tym, że Rossowi brakuje dowodów aby podeprzeć tę hipotezę. Wszystko póki co wskazuje na to, że Dread Pirate Roberts popełnił błąd, jeśli chodzi o poprawne wdrożenie tzw. “ukrytej usługi Tora”. I to nie jeden błąd… ,vi.curry