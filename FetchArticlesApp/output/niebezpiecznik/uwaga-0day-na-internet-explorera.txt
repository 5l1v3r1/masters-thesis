Microsoft poinformował o istnieniu dziury (CVE-2012-1889) MSXML Code Services pozwalającej na zdalne wykonanie kodu. Dziura, wykryta przez Google Security Team i Qihoo 360 Security Center, dotyczy wszystkich wspieranych wersji Windowsa oraz wszystkich wspieranych wersji Microsoft Office 2003 i 2007. Gdzie MSXML jest dziurawy? Podatność występuje, gdy MSXML próbuje odwołać się do obiektów w pamięci, które nie były inicjowane. Może to spowodować modyfikację pamięci, co w konsekwencji umożliwi wykonanie dowolnego kodu napastnika z uprawnieniami zalogowanego użytkownika. Luka ta jest aktywnie wykorzystywana przez przestępców; aktualny wektor ataku to drive-by install z wykorzystaniem przeglądarki IE — jedyne co musi zrobić ofiara, to wejść przy pomocy IE na odpowiednio spreparowaną stronę WWW. Exploit już dostępny Expolit dla Metasploita jest już dostępny. Jak na razie działa on tylko przeciwko IE6 i IE7 na Windows XP SP3. W internecie odnotowano też pierwsze przypadki infekowania internautów przy pomocy exploita — we wtorek na stronie firmy medycznej, wczoraj na stronie firmy lotniczej — Sophos podejrzewa, że atakującym mogło de facto chodzić o inne firmy, ponieważ stronę z częściami samolotów mogą odwiedzać mogą np. osoby związane z przemysłem zbrojeniowym i to w nie wycelowany mógł być atak. Pojawiają się również głosy, że dosyć tajemnicze ostrzeżenia GMaila o “sponsorowanych przez rząd atakach” mogą być związane właśnie z tą podatnością (CVE-2012-1889) — Google przekazał Microsoftowi informacje o dziurze już 30 maja, a ostrzeżenia pojawiły się 6. czerwca. Tymczasowe obejścia problemu Póki co nie istnieje patch łatający podatność, mamy więc do czynienia z podatnością 0day. Microsoft opublikował rozwiązania, które powinny chronić użytkowników “tak dobrze jak to możliwe”: 1) Zainstalować “fix it”, który modyfikuje dll MSXML tak by przy starcie IE inicjował odpowiednie zmienne, przez co exploit nie powinien zadziałać (więcej informacji na blogu Security Research & Defense). “Fix it” nie jest tak dokładnie przetestowany jak normalny patch, ale za to nie wymaga restartu, warto więc rozważyć jego instalacje. Dodatkowo trzeba pamiętać, że nawet po skutecznym zadziałaniu exploita, złośliwy kod może zostać wykonany tylko z uprawnieniami zalogowane użytkownika — pracowanie na koncie administratora nigdy nie jest zalecanym rozwiązaniem. 2) Skonfigurować IE by używało Enhanced Mitigation Experience Toolkit (EMET). EMET to darmowe narzędzie, które ma utrudniać działanie exploita wymuszając mechanizmy takie jak np. data execution prevention (DEP) czy address space layout randomisation (ASLR), bez zmian w samym kodzie uruchamianej w EMET aplikacji 3) Zmienić konfiguracje IE tak aby ostrzegał przy każdej próbie uruchomieniu Active Scripting, wyłączyć całkowicie Active Scripting, korzystać tylko z zaufanych stron… Do czasu wydania odpowiedniej poprawki zawsze można pomyśleć… o tymczasowym (choć mamy nadzieję, że jednak permanentnym) korzystaniu z innych przeglądarek ;) W dużych firmach, które zarządzają IE poprzez mechanizm polis (GPO) może to być jednak trudniejsze niż się wydaje. P.S. Biorąc po uwagę, że w tym miesiącu wyszła poprawka MS12-037 łatająca 13 innych podatności w IE (w tym CVE-2012-1875, która również jest aktywnie wykorzystywana) można powiedzieć, że nie jest to najbardziej udany miesiąc dla IE… ,Anonim