Kilka dni temu na konferencji Black Hat, Brendan O’Connor przedstawił CreepyDOL, czyli prototyp sieci inwigilującej przechodnia w oparciu o czujniki zbudowane z 10 Raspberry Pi. Kiedy projekt nagłośniono, okazało się, że jedna z firm już rok temu wdrożyła podobne rozwiązanie w Londynie, aby “zliczać” i analizować mieszkańców. TL;DR: Twoja komórka ujawnia dużo informacji na twój temat przez Wi-Fi i Bluetooth, nawet jak nie jesteś podpięty do żadnej sieci. Jeśli chcesz wiedzieć jak się przed tym chronić, możesz od razu skoczyć do tej części artykułu. CreepyDOL Najpierw przedstawmy w szczegółach projekt Brendana. CreepyDOL służy do skanowania kanałów Wi-Fi pod kątem obecności klientów i pasywnej analizy widzianego ruchu sieciowego (wspierane są sieci otwarte, ale nic nie stoi na przeszkodzie aby włamypodpinać się także do sieci zaszyfrowanych przy pomocy znanych ataków na WEP, lub Reavera w przypadku sieci WPA). Jakie dane zbiera CreepyDOL? 1. Adresy, w których przebywała ofiara.. Niepołączone z siecią Wi-Fi urządzenia mobilne wysyłają w eter ramki z nazwami historycznych sieci, do jakich były podpięte, pytając czy znajdują się one w pobliżu. CreepyDOL zbiera nazwy i odpytuje o nie geolokalizacyjne bazy Wi-Fi (np. Google ma taką bazę, w której oznacza pozycję danej sieci. Dane pochodzą z samochodów StreetView oraz od każdego użytkownika telefonu z Androidem i modułem GPS — tak, tak, drogi użytkowniku Androida, podłączając się do jakiejś sieci Wi-Fi, wysyłasz na serwery Google jej lokalizację). 2. Tożsamość inwigilowanej ofiary. Jeśli ofiara korzysta z niezaszyfrowanej sieci (otwartego hotspota), to jej ruch da się monitorować. CreepyDOL wyszykuje w ruchu przy pomocy specjalnych filtrów dane identyfikujące nadawce, wysyłane do serwisów takich jak Twitter, DropBox, Facebook, itp. bez szyfrowania. Dane te często zawierają e-mail ofiary lub ID jej profilu. Na podobnej zasadzie działa rozszerzenie do Firefoksa “Firesheep“. 3. Inne usługi, z których nie korzystał użytkownik w trakcie inwigilacji. Przechwytując np. zdjęcie wysyłane na serwer randkowy, można odpytać sieć o inne URL-e, pod którymi zdjęcie to występuje i np. w ten sposób namierzyć profil na Facebooku — tym razem założony przez ofiarę na oryginalne dane, a nie fałszywe, typu DyskretnyJanusz_23cm, które często wykorzystuje się w serwisach randkowych ;-) 4. Przyjaciół w rzeczywistym świecie. Jeśli sensory widzą, że w danym obszarze zawsze pojawiają się te same MAC adresy jednocześnie, można założyć, że ich właściciele podróżują razem, a więc zapewne znają się w rzeczywistym świecie. Rodzina? Przyjaciele? A może ktoś ma 2 telefony? 5. Rodzaj sprzętu z jakiego korzysta ofiara. User-Agent to nie wszystko — niektóre aplikacje, np. te korzystające z protokołu iMessage, wysyłają regularnie do serwera sprzętowy opis urządzenia: 6. Aktualną pozycję inwigilowanej ofiary. Tym dokładniejszą, im więcej czujników uda nam się rozlokować na inwigilowanym obszarze. Warto tu przypomnieć pomysł forsowany w moskiewskim metrze, gdzie mając lokalizację danej osoby ustaloną na podstawie czujników, chcą robić zdjęcia tej osobie, aby poznać jej wygląd… CreepyDOL w praktyce, miesiąc wcześniej… Wdrożenie CreepyDOL-a, czy też innej sieci inwigilującej bywalców danego obszaru może mieć także “niezłośliwe” uzasadnienie; np. chęć identyfikowania złodziejów (por. moskiewskie metro) lub pomoc w podniesieniu sprzedaży produktów w supermarketach. I tak docieramy do marketingowców z Londynu, którzy zainstalowali podobne do CreepyDOL-a czujniki w 12 miejskich koszach na śmieci. Celem było zmapowanie zachowania właścicieli telefonów (gdzie dana osoba lubi jadać, jak długo średnio przebywają klienci w danym sklepie, ile czasu mija pomiędzy ich kolejnymi wizytami, czy poruszają sie samochodem i przekraczają prędkość, czy to kobieta — wejście do damskiej przebieralni). Marketingowcy nazywają tę technologie “ciasteczkiem w realnym świecie“: Oto dane, jakie kosze na śmieci zebrały w jeden tydzień: 4 miliony zauważonych urządzeń (530 000 unikatowych) Jeden z producentów odpowiada za 67% widzianych urządzeń Firma nastawiona jest głównie na marketing, korelacje danych z billbordami i ich sprzedaż innym podmiotom. Wygląda na to, że nie poczuwa się w obowiązku ostrzegania przechodniów o prowadzonym próbkowaniu ich telefonów… Jak chronić swoją “mobilną” tożsamość? Przede wszystkim zauważmy, że zbieranie danych jest możliwe, bo urządzenia non stop wysyłają dane o znanych im sieciach Wi-Fi, a aplikacje z których korzystamy są gadatliwe (ciągle łączą się ze swoimi serwerami “w tle). 1. Wyłącz Wi-Fi i Bluetooth gdy z nich nie korzystasz Aby poradzić sobie z pierwszym problemem, po prostu wyłącz Wi-Fi (oraz Bluetooth) jeśli z nich w danej chwili nie korzystasz (bonus: bateria pożyje dłużej). Ale uwaga — w Androidzie 4.3 to może nie wystarczyć. 2. Zapominaj sieci Wi-Fi Jeśli jednak często korzystasz z Wi-Fi, zadbaj o to, żeby wyłączać “automatyczne podłączanie się do znanych sieci” oraz regularnie kasować zapamiętane ustawienia sieci Wi-Fi (“zapomnij tę sieć“) — niestety nie ma tu wygodnego ustawienia które automatyzuje “zapominanie”… 3. Szyfruj ruch po podpięciu do obcej sieci Aby poradzić sobie z drugim problemem, należy szyfrować cały ruch wychodzący z telefonu. Można tego dokonać przy pomocy spiętego na stałe VPN-a. na telefonie można skonfigurować VPN na stałe, np. do naszego domowego routera Wi-Fi (większość z domowych routerków pozwala na postawienie serwera VPN): Warto jednak wspomnieć o tym, że zanim zdążymy “zakliknąć” VPN po podłączeniu do sieci Wi-Fi — część z aplikacji może być szybsza i da radę wysłać ujawniające naszą tożsamość dane przed zestawieniem tunelu, bez szyfrowania… Tutaj apel do deweloperów aplikacji mobilnych: dane identyfikujące użytkownika lub jego sprzęt przesyłajcie na swoje serwery zaszyfrowane (czyli po SSL-u). na komputerze wystarczy ustawić w systemie SOCKS proxy dla ruchu wychodzącego, wskazujące na 127.0.0.1:6666, uprzednio wykonując polecenie “ssh naszlogin@na.jakimkolwiek.serwerze.ssh -D 6666“). Aleternatywą jest skorzystanie z serwisów udostępniających tunele VPN za opłatą. 4. Zmieniaj MAC na losowy, regularnie! Ciekawą opcją zniknięcia w tłumie (przy założeniu spełnienia wymogu szyfrowania ruchu wychodzącego) będzie ustawianie losowego MAC adresu co kilka minut. Nie jest to niestety łatwe zadanie, zwłaszcza na niezjailbreakowanych urządzeniach mobilnych, gdzie nie można ot tak po prostu wydać polecenia: ifconfig en0 lladdr MAC lub skorzystać z MACaddy (iOS) albo MAC Ghost (Android). Jak jeszcze można nas inwigilować? Macie pomysł co jeszcze, oprócz interfejsów do Wi-Fi/Bluetootha może posłużyć do pasywnego zbierania danych na temat przechodniów? Może sam sygnał sieci GSM? Aż strach się bać danych, jakie mogłyby być dodatkowo monitorowane, gdyby ktoś rozlokował na monitorowanym obszarze tanie IMSI Catchery (ostatnie doniesienia mówią, że można zbudować IMSI Catchera za ok. 1000 dolarów). Mój telefon/tablet ma teraz Podniesiony Wi-Fi, niepodpięty do żadnej sieci Podniesiony Blootooth niepodłączony do żadnego urządzenia Podniesiony Wi-Fi, podpięty do sieci Podniesiony Bluetooth, sparowany z innym urządzeniem Nie ma podniesionych interfesjów Wi-Fi / Bluetooth Zobacz wyniki ankiety PS. W Krakowie niedawno powstał startup o nazwie Estimote, wykorzystujący specjalne czujniki bazujące na BLE (Bluetooth 4.0 Low Energy), które można kupić i rozlokować w swoim lokalu usługowym. Zdaniem czujników jest komunikacja ze smartphonami klientów (zasięg 50m), a raczej specjalnymi aplikacjami na nich zainstalowanymi. Czujniki mają wbudowany akcelerometr i termometr. Właśnie ruszyła sprzedaż dev-kitów — ktoś ma pomysł, czy da się je przekonwertować na mini-sieć służącą do inwigilacji? (normalnie do interakcji wymagana jest specjalna aplikacja na telefonie) ,Piotr Konieczny