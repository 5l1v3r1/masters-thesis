Skrypty do kopania kryptowalut znajdziemy nie tylko na The Pirate Bay. Można się ich spodziewać na stronach sklepów, blogach i nawet na stronach urzędów. Umożliwiają zarabianie włamywaczom, którzy szukają stron z nieaktualnym, dziurawym oprogramowaniem. Cryptojacking Jesteśmy pewni, że słyszeliście już o Coinhive – koparce kryptowaluty Monero, która jest instalowana na stronach internetowych w postaci skryptu. Zasadnicza idea Coinhive była dobra. Chodziło o to, by strony mogły dodatkowo spieniężać ruch wykorzystując CPU odwiedzających. Narzędzie zdobyło rozgłos gdy okazało się, że The Pirate Bay wstawia je na niektóre swoje strony. Początkowo The Pirate Bay źle skonfigurowała koparkę, pozwalając na wykorzystanie pełnej mocy procesora. Później to poprawiono. Niestety Coinhive można użyć w sposób złośliwy np. dodać do rozszerzenia przeglądarki, co spowoduje ciągłe dodatkowe obciążenie procesora. Skrypt można też znaleźć na stronach utworzonych przez typosquatterów oraz – co chyba najgorsze – mogą być one dodawane do dowolnych stron bez wiedzy ich twórców/administratorów. W tym ostatnim przypadku na koparce zarabia ktoś, kto włamał się na stronę i dorzucił złośliwy kod. To właśnie jest cryptojacking. Popularność rośnie Interesujące badania na temat cryptojackingu przeprowadził niezależny badacz Willem de Groot. Sprawdził on 2496 stron e-sklepów, które działały w oparciu o przestarzałe oprogramowanie ze znanymi lukami bezpieczeństwa. Na wszystkie te strony podrzucono skrypt Coinhive, a Willem de Groot ustalił, że: 80% stron zawierało nie tylko skrypt koparki, ale również oprogramowanie do przechwytywania danych o płatnościach. Wyglądało to tak, jakby przestępcy chcieli wycisnąć ze strony wszystko co możliwe. 85% skryptów na stronach było połączonych z zaledwie dwoma kontami Coinhive (co można stwierdzić analizując unikalne ID). Są też powody by sądzić, że pozostałe 15% pojedynczych kont kontroluje jedna osoba lub grupa osób. Raport na temat cryptojackingu wcześniej wydała firma MalwareBytes. Zwraca on uwagę na to, że opłacalność kopania kryptowalut zależy m.in. od rachunków za prąd. W przypadku skryptów na stronie, koszt prądu jest przerzucany na odwiedzającego i to czyni takie koparki atrakcyjnymi. Na oszacowania zysków można sobie pozwolić w przypadku The Pirate Bay. Ta strona ma 282 mln użytkowników miesięcznie i każdy spędza na niej średnio 5 minut. Szacuje się, że The Pirate Bay może zarobić 127.5 XMR miesięcznie, co przy obecnej cenie Monero daje ponad 24 tys. USD miesięcznie. Nawiasem mówiąc niedawno firma MalwareBytes odkryła, że kopanie kryptowalut może trwać nawet po zamknięciu okna przeglądarki. Umożliwia to okienko pop-under, które jest przeskalowane w taki sposób, aby dało się je schować pod zegarkiem na pasku zadań. Cryptojacking może dotykać popularnych stron. Skrypty Coinhive znaleziono m.in. na stronie CBS’s Showtime i najwyraźniej nie zostały tam dodane przez administratorów strony. Podobny problem miała strona Bigprepaid.com. Firma Sucuri donosiła o kilku kampaniach cryptojackingowych, które były wycelowane w popularne platformy WordPress i Magento. W wielu przypadkach obecność koparki na stronie można łatwo stwierdzić… …jednak w niektórych przypadkach opisanych przez Sucuri w kodzie stron nie było widać skryptu Coinhive. Był natomiast skrypt security.fblaster.com, który ładował skrypt Coinhive. Co ciekawe, adres IP serwera security.fblaster.com występował już wcześniej w połączeniu z innym atakiem (RevSlider). Najwyraźniej sama infekcja nie była nowa, natomiast atakujący zmodyfikowali złośliwy skrypt, nie musząc nic zmieniać na stronach wykorzystanych później do kopania. Firmy z branży bezpieczeństwa spodziewają się rosnącej popularności cryptojackingu. Atakujący nie muszą polegać na dużych stronach z milionami odwiedzających, bo równie dobrze mogą atakować liczne nieduże strony, na których złośliwy skrypt może funkcjonować niezauważenie. W tym kontekście dobrze będzie pokazać przypadek z naszego podwórka. Coinhive w Kołbaskowie Pod koniec września br. jeden z czytelników doniósł nam, że na stronie gminy Kołbaskowo dało się znaleźć skrypt Coinhive. Akurat w tym przypadku nietrudno było go zauważyć. Natychmiast zadzwoniliśmy do pani Wójt, ale nie udało nam się z nią porozmawiać (była na sesji). Przełączano nas do różnych osób odpowiedzialnych za stronę WWW gminy. Pech chciał, że gminny informatyk był na urlopie, ale ten informatyk i tak dowiedział się o sprawie i skontaktował się z nami. Informatyk wiedział, że strona gminy działa na starej wersji Joomli (co uznawał za cudzy problem, skoro urząd miał osobną umowę na zarządzanie stroną). Ustalił, że plik zmodyfikowano 23 września wieczorem. Zaktualizował CMS, mimo iż nie należało to do jego obowiązków. Tyle dowiedzieliśmy nieoficjalnie. Dopiero później nadeszła do nas odpowiedź oficjalna, podpisana przez sekretarza gminy Janusza Kwidzińskiego. To my pogrubiliśmy zdanie w ostatnim akapicie. Jak widzicie, aktualizowanie strony gminy jest czymś, co trzeba “wyegzekwować”. Wiemy, że podobna sytuacja jest w niejednej gminie i niejednym urzędzie co oznacza, że strony polskich instytucji publicznych są dobrym celem cryptojackingu. Nie chcę kopać. Co robić? Jak żyć? Osoby prowadzące strony internetowe muszą dbać o aktualność stosowanego oprogramowania. Jeśli zaś chcecie się chronić jako użytkownicy to wiedzcie, że niektóre adblockery (m.in. AdBlock Plus oraz AdGuard) radzą sobie z CoinHive. Pojawiły się również “antykoparkowe” rozszerzenia do Chrome m.in. AntiMiner, minerBlock albo No Coin. Twórcy Coinhive odnotowali na swoim blogu, że rozgłos wobec ich narzędzia skończył się paradoksem. Alternatywa dla reklam jest teraz blokowana przez adblockery. Niestety popełniono pewne błędy np. umożliwiono stosowanie koparki bez informowania o tym użytkowników. Wszystko wyglądałoby inaczej, gdyby osoby odwiedzające stronę przynajmniej wiedziały o stosowaniu skryptu. “Złośliwe” zastosowania dopełniły dzieła. Teraz Coinhive musi walczyć z przyklejoną mu etykietką “narzędzia legalnego, acz często stosowanego nieetycznie”. Szkoda, bo idea takiej monetyzacji sama w sobie była ciekawa. ,Marcin Maj