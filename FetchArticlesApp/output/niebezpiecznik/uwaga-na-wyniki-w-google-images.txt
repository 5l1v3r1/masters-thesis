Wyszukiwarkę grafiki od Google zalała fala “złośliwych” obrazków — klikając na nie, internauci zostają przenoszeni na strony próbujące zainstalować w ich systemie złośliwe oprogramowanie. Poniżej radzimy jak chronić się przed fałszywymi wynikami wyszukiwania w Google Images. Jak przebiega atak? Zjawisko, które obserwujemy w wynikach wyszukiwania na Google Images wynika z tego, że ktoś stworzył tysiące fałszywych stron, które — korzystając z technik Black SEO — spozycjonował tak, aby zajmowały wysokie pozycje w wynikach wyszukiwania dla popularnych słów kluczowych (ostatnio np. “Osama bin Laden“). Sytuacja jest poważna, z szacunków wynika, że miesięcznie na podstawione, złośliwe strony może być kierowanych aż 15 milionów internautów. Jeśli interesują cię tego typu ataki, przypominamy że szczegółowo omawiamy je na naszym szkoleniu z atakowania i ochrony webaplikacji. Na termin majowy zostało tylko jeszcze 1 miejsce wolne. Poniżej scenariusz ataku: Atakujący korzystają z wykradzionych loginów i haseł do serwerów FTP, na które uploadują pliki .php. Włamania najczęściej dokonywane są z adresów IP: 46.252.130.109 oraz 91.200.240.10. (sprawdźcie swoje logi). Plik z reguły wygląda tak: <? eval(gzuncompress(base64_decode('eNqdWNtuGkkQ/ZmVSKRVBINtZbTiAR4Yd ...pominięto... wV/UO/k/6QMUUQ=='))); ?> Plik .php generuje spamerskie strony, korzystając ze słów kluczowych, które w danej chwili są najpopularniejsze w internecie (np. Osama bin Laden). Dodatkowo, strony zasilane są hotlinkowanymi obrazkami, tematycznie związanymi ze spamerskimi słowami kluczowymi. Dzięki temu podstawione strony zajmują wysokie pozycje w rankingu. Tutaj szczegóły spamerskiego algorytmu. Internata szukający obrazka trafia na spamerską stronę. Skrypt .php sprawdza nagłówek Referer i jeśli zauważy, że internauta przychodzi z Google, to podmienia zawartość strony z obrazkiem na złośliwy JavaScript, który przekierowuje i nakłania użytkownika do instalacji FakeAV, czyli fałszywego antywirusa. Jak chronić się przed atakami? Google dzielnie walczy ze spamem w wynikach wyszukiwania na własną rękę, ale z racji liczby zainfekowanych stron i ich dynamicznego przyrostu, nie wszystko udaje się zablokować na czas. Jeśli jesteś webmasterem, nie pomagaj atakującym — nie zapamiętuj haseł do swoich serwerów w klientach FTP, sprawdź swój komputer programem antywirusowym i zweryfikuj, czy wśród strony twojego serwisu Google przpadkiem nie zindeksowało czegoś podejrzanego (parametr site:twojadomena.pl). Jeśli jesteś administatorem sieci i masz dość skarg swoich użytkowników, że wyniki wyszukiwania w Google’u każą im instalować programy antywirusowe, możesz rozważyć wyczyszczenie nagłówka Referer (dla Google Images) na proxy/WAF dla ruchu wychodzącego. Jeśli jesteś zwykłym internautą, możesz wyłaczyć obsługę JavaScript w swojej przeglądarce. W tym celu najwygodniej jest skorzystać z dodatku NoScript dla Firefoksa, lub NoScripts dla Google Chrome — oba pozwalają włączać JavaScript tylko na stronach, na których rzeczywiście go potrzebujemy. Ale przede wszystkim, po prostu PATRZ na co klikasz i nie instaluj bezmyślnie wszystkiego, co ci ktoś podsuwa pod myszkę. Jeśli interesuje cię bezpieczeństwo webaplikacji, przypominamy że szczegółowe przykłady ataków i ochrony webaplikacji omawiamy na naszym szkoleniu. Na termin majowy zostało tylko 1 miejsce wolne. ,igH