Reset do ustawień fabrycznych to jedna ze standardowych funkcji praktycznie każdego urządzenia. Posiadają ją także telefony firmy Samsung. Niestety, okazuje się, że reset do ustawień fabryczych można aktywować zdalnie — wystarczy, że ofiara wejdzie na odpowiednio spreparowaną stronę WWW. Jak zresetować Samsung Galaxy S3 do ustawień fabrycznych za pomocą jednej linijki HTML? Standardowo, reset telefonu Samsung uzyskuje się poprzez wstukanie na klawiaturze telefonu specjalnego kodu: *2767*3855# Okazuje się jednak, że wystarczy iż na stronie WWW pojawi się taki kod: <frame src="tel:*2767*3855%23" /> …i już przeglądający tę stronę na telefonie Samsung Galaxy S3 będą zmuszeni do przypomnienia sobie, gdzie mają kopię zapasową danych… Dlaczego? Bo ich smartphone automatycznie zostanie zresetowany do ustawień fabrycznych. Ups! Które telefony Samsunga są podatne na atak? Przy pomocy tego błędu można resetować wszystkie smartphony Samsunga, które mają zainstalowane oprogramowanie TouchWiz, standardowo instalowane przez Samsunga na nowych modelach smartphonów. Zresetować można więc telefony Samsung Galaxy II, a nie tylko SIII (Nexus od Google ponoć nie jest podatny, podobnie jak i niektóre międzynarodowe wersje Samsung Galaxy S3). Ponieważ luka znajduje się w TouchWiz, ciężko mówić o błędzie samego Androida (a więc nie tak prędko, miłośnicy Apple — ta wpadka to nie kolejny argument w wojnie Android vs iOS). Pokaz ataku na filmiku poniżej (start w 10 min.) Co ciekawe atak ten można przeprowadzić także przy użyciu kodu QR oraz chipa NFC (zbliżeniowo). Nie stykajcie się więc swoimi Samsungami z kolegami ;-) Jak się zabezpieczyć przed tym błędem? Wieść gminna niesie, że błąd poprawiono w najnowszym OTA/Ice Cream Sandwich incremental patch, a więc spora część Samsungów Galaxy S3 może już nie być podatna na ten atak. Opóźnienie w dystrybucji aktualizacji Androida jest jednak dość spore (zanim dotrze do sieci GSM, zanim dotrze do klientów, itp), a więc żartownisie maja wciąż duże pole do popisu. Alternatywnym rozwiązaniem może być podmiana systemowego dialera na Dialer One, jak sugeruje Dariusz …lub instalacja Skype’a (wtedy protokół “tel:” wykorzystywany w ataku jest przechwytywany przez Skype z pytaniem, czy numer wybrać za pomocą telefonu, czy Skype’a — a to uniemożliwia automatyczne wykonanie kodu USSD) Mam smartphone’a Samsunga, czy jestem podatny na atak? Aby sprawdzić, jak zachowuje się nasz telefon (i czy da się go skłonić do automatycznego resetu do ustawień fabrycznych) warto potestować jak na exploita reagują różne przeglądarki z których korzystamy — niektóre z nich mają bowiem wbudowaną ochronę przed automatycznym wykonywaniem kodów USSD. Podatność można weryfikować na kodzie *#06#, o którym wspomina Dariusz w komentarzach poniżej (kod wyświetla IMEI). Pamiętajcie tylko aby odpowiednio zakodować znak “#” występujący w kontekście URL (%23). Przykładowa strona z niegroźny exploitem tutaj. Aktualizacja 23:45 Jak się okazuje, na ten wektor ataku podatne są także telefony HTC… a więc problem automatycznego przetwarzania protokołu tel: jest związany z Androidem. Kod służący do resetu telefonów HTC do ustawień fabrycznych to *#*#7780#*#*. Dodatkowo, nawet jeśli dany producent nie posiada kodu resetu, to można próbować kodów, które służą do przekierowywania połączeń przychodzących na swój numer (a więc mówimy o przejęciu czyjegoś numeru). Kod, który do tego służy to *21*NUMER-TELEFONU#. Powodzenie ataku zależy oczywiście od tego, czy na danym telefonie kod wykonany zostanie automatycznie, czy konieczna będzie jego akceptacja ręczna przyciskiem słuchawki. Różne modele, różne podejścia… ,Piotr Konieczny