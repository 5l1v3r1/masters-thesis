Renesys, firma zajmująca się analizą ruchu internetowego na świecie, opublikowała interesującą analizę kilku incydentów bezpieczeństwa, które wydarzyły się w tym roku, a które dotyczyły przechwytywania routingu do 1500 adresów poprzez wstrzyknięcia prefiksów BGP. W sumie, przez ponad 60 dni obserwowano “na żywo” atak typu Man in the Middle — z tym, że “człowiekiem” w środku była Białoruś, a potem Islandia… Przekierowanie ruchu internetowego, o którym jest mowa w artykule nazywane jest jako IP Hijacking i bazuje na wstrzykiwaniu cudzych prefiksów BGP. Więcej o BGP Hijackingu, wspominaliśmy także przy okazji incydentu w Chinach, kiedy o przez kilkanaście minut przez chińskie routery przechodziło kilkanaście procent światowego ruchu internetowego. Epizod Białoruski W lutym ruch internetowy kilku firm i instytucji był przekierowywany przez Białoruś — a dokładniej, przez routery tamtejszego dostawcy Internetu “GlobalOneBel”. Ataki trwały czasem po kilka minut, a czasem po kilka godzin. Ofiarami były w większości z instytucje finansowe, rządowe, a także lokalni dostawcy Internetu, z USA, Korei Płd., Niemiec, Czech, orazLitwy, Libii i Iranu. Dlaczego możliwe było przejęcie ruchu? Często umożliwia to “zaufanie” jakim obdarzają się partnerskie sieci. Schemat jest następujący: “wrogi” operator rozgłasza swoim partnerom bardziej specyficzną trasę do przejmowanej sieci. Ci mu ufają i rozgłaszają trasę dalej/wyżej, aż wędruje ona do operatora globalnego, np. Level 3. Jim Cowie, autor wpisu z Renesys przedstawił nawet przykładową trasę pakietów w tamtym okresie. Rozpoczynająca się w Guadalajara w Meksyku, a kończąca w Waszyngtonie po drodze standardowo przechodziła przez Londyn potem Moskwę, a następnie Frankfurt, skąd wracała do Ameryki. Natomiast w trakcie ataku, ktoś tak zmodyfikował roting, że pakiety dodatkowo przechodziły przez Mińsk, na trasie między Moskwą, a Frankfurtem. Jeśli więc, ktoś wysyłał wiadomość e-mail z Meksyku do USA, nie miał świadomości, że jego wiadomość była czytana na Białorusi. Oczywiście mógł to wykryć przy pomocy połaczenia traceroute — ale metoda ta na nic by się zdała, gdyby modyfikować tylko ruch powrotny pakietów (tzn. od węzła z którym rozmawia ofiara do niej). Należy zwrócić uwagę, że przechwytywać za pomocą BGP można albo sam ruch do, albo ruch od, albo w obu kierunkach. …i nastał epizod Islandzki Po tym interesującym zjawisku, nastała znowu cisza ale tylko do 31 lipca… Wtedy to inny lokalny dostawca Internetu w Islandii — “Opin Kerfi” — rozpoczął nagle rozgłaszanie prefiksów do 597 sieci IP, które do niego nie należały. Rozgłaszane sieci, należały do jednego z dużych dostawców VoIP w USA. Islandczycy tłumaczyli się błędem w konfiguracji routera. Przykładowa trasa pakietów z Denver do Denver, przedstawiona została poniżej. Na poniższej ilustracji “epizod Islandzki” odbywał się między Londynem, a Montrealem. Ogółem, Renesys zaobserwowało 17 podobnych zjawisk, gdzie fałszywe przekierowania z kilku państw na świecie, szły przez dostawców Internetu w Islandii. Co robić, jak żyć? Jak zauważa Cowie — jeśli duże firmy ISP (Internet Service Provider), będą na bieżąco monitorowały swoich klientów (w tym także mniejszych, lokalnych ISP), a jednocześnie filtrowały ich ruch, gdy zauważone zostaną fałszywe przekierowania, to jest szansa, że takie ataki uda się ograniczyć. Z punktu widzenia zwykłego internauty, warto upewnić się, że ruch wychodzący z naszego komputera — jeśli to tylko możliwe — jest szyfrowany. Wtedy, nawet jeśli ktoś przekieruje nasze pakiety przez swój router, jest szansa, że nie będzie w stanie złamać szyfrowania. ,Grzegorz Wróbel