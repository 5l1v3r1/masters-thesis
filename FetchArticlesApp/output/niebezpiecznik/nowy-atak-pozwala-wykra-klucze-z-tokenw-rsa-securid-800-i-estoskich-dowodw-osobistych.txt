Tokeny wraz ze standardowymi hasłami są wykorzystywane do tzw. silnego, dwu-składnikowego uwierzytelnienia. Hasło to coś co wiesz. Token to coś co masz. Żeby atakujący dostał się do chronionego systemu i podszył pod ciebie, musi nie tylko znać twoje hasło, ale również mieć twój token. Grupa kilku naukowców właśnie zademonstrowała sposób na “sklonowanie” tokena… Atak na tokeny/smartcardy: wyciągnięcie kluczy W tym raporcie znajdziesz opis ataku typu padding oracle, który pozwala na wyciągnięcie kluczy kryptograficznych zapisanych na tokenie/smartcardzie RSA SecurID 800. Atak padding-oracle jest atakiem typu side-channel i polega na tym, że błędnie dopełniony tekst zaszyfrowany podany na wejście tokena generuje błędy, na podstawie których można odczytać test jawny bez znajomości klucza kryptograficznego przechowywanego na tokenie. Na tokenach znajdują się 2 rodzaje kluczy. Klucz urządzenia (ten nie jest znany) i klucz użytkownika (np. do VPN, który jest importowany/exportowany w formie zaszyfrowanej). Zaprezentowany atak polega na rozszyfrowaniu klucza użytkownika (poznamy go) przy pomocy klucza urządzenia (tego nie poznamy) poprzez funkcję API, umożliwiającą import i zdradzającą informacje dot. poprawnego/niepoprawnego paddingu w importowanym, zaszyfrowanym materiale. Badacze usprawnili atak Bleichenbachera na RSA PKCS#1v1.5 jeśli chodzi o wariant z kryptografią asymetryczną oraz atak na CBC Vaudenay’a w przypadku kryptografii symetrycznej. Ile trwa atak i kto jest na niego podatny? Aby rozszyfrować secret (np. klucz do VPN) przy pomocy tokena (lub smartcarda) wymagane jest wykonanie 9400 operacji (mediana: 3 800), co trwa ok. 13 minut. Na atak podatne są nie tylko tokeny RSA, ale również estońskie dowody osobiste (smartcardy) Aladdin eTokenPro, iKey 2032 od SafeNet CyberFlex od Gemalto Siemensowy CardOS. Czasy rozszyfrowywania tekstu zaszyfrowanego różni się w zależności od tokena/smartcarda. Dla estońskiego dowodu osobistego podano czas ok. 13 godzin — i daltego Estończycy określili ten atak jako małopraktyczny. Co to wszystko oznacza w praktyce? Krótko mówiąc, podpięcie takiego tokena do komputera, który jest zainfekowany złośliwym oprogramowaniem, może spowodować a) przechwycenie eksportowanego (ale zaszyfrowanego!) klucza z tokenu b) jeśli token znajduje się w komputerze przez 13 min., jego szyfrowanie eksportowanego klucza zostanie złamane, rozszyftowany klucz zostanie wyciągnięty, a atakujący będzie mógł swobodnie podszywać się pod właściciela tokenu (np. podpiąć się do jego VPN-a). Warto przypomnieć, że rok temu nastąpiło potężne włamanie na serwery RSA, a atakujący wykradli wtedy seedy tokenów RSA SecurID. Chwilę potem koncern wojskowy Lockheed Martin upublicznił informacje dotyczące włamania, w których stwierdził, że włamanie do RSA pomogło atakującym w ataku na Lockheed Martina. Jak na razie RSA odmawia komentarzy w sprawie ataków na swoje tokeny. ,vi.curry