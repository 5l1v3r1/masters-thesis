Ciekawy atak rozegrał się na stronach Amnesty International. Wykorzystywał 0day’a na Flasha i w nowatorski sposób pobierał złośliwe oprogramowanie z zewnętrznego serwera. Drive-by Cache Atakujący wstrzyknęli na stronę Amnesty International kod, próbujący przeprowadzić na internautach tzw. atak drive-by-download z wykorzystaniem załatanej zaledwie kilka dni temu dziury we Flashu. Nie to jest jednak w tym ataku wyjątkowe… Dziura we Flashu oczywiście pozwalała atakującym na wykonanie kodu — standardowo w tego typu atakach atakujący wywołałby z funkcję URLDownloadToFile() (urlmon.dll) aby ściągnąć (i uruchomić) faktyczny malware z zewnętrznego serwera. Programy antywirusowe zdają sobie jednak sprawę, że rzadko kiedy powyższa funkcja używana jest w innym celu niż ściągnięcie złośliwego oprogramowania i z reguły w tego typu przypadkach podnoszą alarm. Dlatego też przestępcy, aby uniknąć wykrycia przez antywirusy, skorzystali z ciekawego triku: plik wykonywalny (.exe) osadzili na stronach Amnesty International za pomocą tagu <script> (jako zewnętrzny plik JavaScript). Efekt? Przeglądarka odwiedzając stronę pobierała i cache’owała podpięty JavaScript (a tak naprawdę malware). Nie była go jednak w stanie uruchomić, bo nie był to poprawny JavaScript. Z kolei atak drive-by download wykorzystujący lukę we Flashu nie uruchamiał przewidywalnej w tym przypadku funkcji URLDownloadToFile(), a przeszukiwał cache przeglądarki w poszukiwaniu malware’u i uruchamiał go. Malware łączył się z adresem 182.237.3.105 w Hong Kongu. Ten wariant ataku nazwano drive-by cache. Armorize twierdzi, że pomimo tego, iż luka została załatana w trakcie trwania ataków, żaden z 42 antywirusów nie zgłaszał zastrzeżeń co do pliku z exploitem. Szczegółową analizę ataku znajdziecie na stronach Armorize. Jak obronić się przed atakami Drive-by download? Najlepszą metodą jest posiadanie aktualnego oprogramowania (w tym przypadku: playera Flasha), np. przeglądarka Google Chrome sama czuwa nad aktualnością dodatków i pluginów. Zdarza się jednak, że atakujący wykorzystują luki, na które nie ma jeszcze patcha… Co wtedy? Wtedy warto wyłączyć niewykorzystywane (albo sporadycznie wykorzystywane) pluginy w przeglądarce, zwłaszcza Javę. Z Flashem, głównie za sprawą video, niektórym będzie ciężko się rozstać, dlatego dogodną alternatywą jest zainstalowanie wtyczki typu FlashBlock, która po wejściu na stronę zablokuje wszystkie odwołania do obiektów Flasha, ale pozwoli użytkownikowi je uruchomić, jeśli ten świadomie na nie kliknie. W przypadku powyższego ataku FlashBlock wystarczy, ale często lepszym rozwiązaniem (chociaż bardziej uciążliwym) jest zainstalowanie dodatku typu NoScript. Kilka przydatnych dodatków do przeglądarek opisaliśmy w artykule: jak zabezpieczyć Google Chrome. ,vi.curry