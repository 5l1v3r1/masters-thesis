Sony ogłosiło, że każdy, kto korzysta z nieoficjalnego firmware’u zostanie zabanowany na PSN (PlayStation Network), czyli sieci pozwalającej m.in. na granie przez internet. Dodatkowo, w sieci pojawiły się informacje, że dane użytkowników (w tym numery kart kredytowych) są przechowywane w PSN w sposób “niebezpieczny”. “Hakerzy mają numer mojej karty kredytowej!” Oh RLY? Panikę w sieci rozpoczął autor tego bzdurnego artykułu ArsTechniki, w którym pojawiły się informacje, że dane karty kredytowej właścicieli PS3 nie są przez firmę Sony przechowywane w bezpieczny sposób. Jeden z internautów miał włamać się do PSN i zauważyć, że konsola wysyła do PSN numer karty kredytowej i robi to nawet jeśli nie jest się podłączonym do PSN — wystarczy samo połącznie konsoli do internetu: creditCard.paymentMethodId=VISA&creditCard.holderName=Max& creditCard.cardNumber=45581234567812345678&creditCard.expireYear=2012 &creditCard.expireMonth=2&creditCard.securityCode=214 &creditCard.address.address1=examplestreet%2024%20 &creditCard.address.city=city1%20&creditCard.address.province=abc%20. Bzdura! Doniesienia dziennikarzy z ArsTechniki są mocno przesadzone. Konsola PS3 łączy się z PSN przy pomocy SSL-a, a więc przesyłane dane są szyfrowane na drodze PS3->PSN. Problem z numerami kart jest zgoła innej natury, ale dotknąć może tylko tych, którzy korzystają z nieoryginalnego firmware’u (to się Sony ucieszy…) Na czym polega atak? Jak zawsze przy połączeniach SSL, autentyczność serwera (PSN) do którego łączy się klient (PS3) musi zostać potwierdzona. Weryfikacja następuje poprzez sprawdzenie kryptograficznego podpisu złożonego na SSL-owym certyfikacie PSN-u. Podpis musi zostać zweryfikowany przy pomocy certyfikatu, znajdującego się na konsoli PS3, w tzw. lokalnym “magazynie” zaufanych certyfikatów. Owy magazyn znajduje się zarówno na każdej PS3, jak i innych systemach operacyjnych (np. Windows) — ba, nawet przeglądarki internetowe posiadają swoje zbiory zaufanych certyfikatów. Jeśli ktoś korzysta ze zmodyfikowanego firmware’u, istnieje ryzyko, że twórca firmware’u do zaufanych certyfikatów dodał swój “zły” certyfikat, a dodatkowo firmware wymusza na konsoli PS3 korzystanie on z “podstawionego” serwera DNS. Atak polega na tym, że zamiast do prawdziwego serwera PSN, konsola łączy się tak naprawdę z fałszywym, podstawionym przez twórcę złośliwego firmware’u serwerem proksującym ruch do oryginalnych serwerów PSN. Połączenie z fałszymy serwerem PSN umożliwia “nadpisany” DNS, który zamiast zwrócić prawdziwy IP, odpowiada adresem IP serwera będącego pod kontrolą atakującego. Tożsamość fałszywego serwera PSN musi zostać potwierdzona …i zostaje potwierdzona, ale w oparciu o podstawiony certyfikat (ten podrzucony przez atakującego). Mamy więc klasyczny atak Man in The Middle, erm Console?. W tym przypadku komunikat z numerem karty kredytowej, mimo że zaszyfrowany, trafia do atakującego — w końcu jest szyfrowany przy użyciu podstawionego przez niego certyfikatu (PSN). Jak się bronić przed “złośliwymi” firmware’ami? Nie instalować ich z “niezaufanego” źródła ;) A ci z Was, którzy bardzo muszą, niech na “hackniętych” firmware’ach powstrzymają się od robienia zakupów poprzez swoją kartę kredytową — lepiej skorzystajcie ze specjalnych, “prepaidowych” kart PSN. ,igH