O zagrożeniach związanych z wykorzystywaniem telefonu komórkowego pisaliśmy już wielokrotnie. Ponieważ kolejne informacje ujawnione przez Edwarda Snowdena sugerują, że NSA podsłuchiwała 35 głów państw, w tym kanclerz Niemiec, Angelę Merkel, spróbujmy zastanowić się jak od strony technicznej NSA mogła tego dokonać. Podsłuch telefonu komórkowego Telefony komórkowe, a raczej komunikację prowadzoną za ich pomocą, można podsłuchać na (co najmniej) 3 różne sposoby: 1. Podsłuch telefonu na warstwie protokołów komunikacji GSM. Podsłuchujący podstawia fałszywy BTS (stację bazową), do której podłącza się telefon ofiary. Fałszywą stację bazową, czyli tzw. IMSI Catcher, popularnie zwany “jaskółką” można albo kupić (ale ceny oficjalnych oscylują w okolicy miliona dolarów a ich sprzedaż jest limitowana do służb) albo zrobić samemu, m.in. przy pomocy USRP i OpenBTS. Jak działa IMSI Catcher? Po włączeniu IMSI Catchera, telefony komórkowe w okolicy zauważają, że pojawił się mocniejszy sygnał sieci i przepinają się na fałszywy nadajnik. Fałszywy nadajnik z kolei łączy się z oryginalną siecią, aby przechwycone komórki mogły wykonywać i odbierać połączenia. Jest to klasyczny atak Man in the middle — będąc w środku komunikacji, fałszywy BTS wcale nie musi łamać szyfrowania protokołów sieci GSM, bo po prostu wymusza brak szyfrowania połączeń, korzystając z tego, iż większość telefonów komórkowych w żaden sposób nie sygnalizuje swojemu właścicielowi, że podłączyło się do sieci GSM bez szyfrowania. Brak szyfrowania pozwala fałszywemu BTS-owi na podsłuchiwanie rozmów, SMS-ów, transmisji pakietowej (internet). Podsłuchiwane połączenia można oczywiście nagrywać. Dodatkowymi funkcjami fałszywego BTS-a jest korelacja danych, czyli możliwość namierzenia osoby, która zmieniła telefon (ale korzysta z tej samej karty) lub zmieniła kartę SIM (ale korzysta z tego samego telefonu) lub zmieniła kartę SIM i telefon jednocześnie (ale dalej wykonuje połączenia na te same numery). 2. Podsłuch telefonu na warstwie innych niż GSM protokołów komunikacyjnych, np. poprzez interfejs sieci bezprzewodowych Wi-Fi. Większość smartphone’ów ma interfejsy Wi-Fi, których użytkownicy nie wyłączają, kiedy przestają korzystać z sieci bezprzewodowej Wi-Fi (wychodzą spoza jej zasięgu). Wtedy taki telefon, np. schowany w kieszeni w trakcie podróży po mieście, co jakiś czas skanuje okolicę w poszukiwaniu SSID znanych mu sieci Wi-Fi …i jeśli widzi znajomą sieć (np. hotspot w kawiarni, do którego już kiedyś się podłączaliśmy), to łączy się z nim automatycznie — a po połączeniu, wiadomo, część aplikacji ożywa; odbiera się poczta, synchronizują się wiadomości na Facebooku, itp. W tym przypadku atak polega na podstawieniu fałszywego access-pointa, który wykrywa próby wyszukiwania przez telefon znanych mu sieci Wi-Fi i błyskawicznie uruchamia fałszywe access pointy o nazwach, których szukał telefon. To sprawia, że telefon myśli, że znalazł “znajomą” sieć i łączy się z fałszywym access pointem. Ten oczywiście podsłuchuje ruch internetowy smartphone’a lub wręcz modyfikuje go aby podsłuch był łatwiejszy, np. zamieniając próby połączeń HTTPS na HTTP (o ile serwer, do którego łączy się podsłuchiwany telefon jest źle skonfigurowany — taki atak, z wykorzystaniem sslstripa opisaliśmy na przykładzie warszawskiego Veturilo). Ponieważ podsłuchiwana jest łączność internetowa, a nie telefoniczna (GSM), w tym przypadku podsłuch rozmów nie jest możliwy, o ile nie są prowadzone z wykorzystaniem klienta VoIP. 3. Podsłuch telefonu na warstwie (złośliwej) aplikacji. Nagrania rozmów i SMS-y możemy także wykradać z telefonu przy pomocy złośliwej aplikacji, którą nieświadomie zainstalowała ofiara na swoim telefonie (bo myślała, że to inna użyteczna aplikacja, por. aplikacja ukradkiem fotografująca twój dom) lub którą ktoś zainstalował ofierze w momencie, w którym spuściła ona swój telefon z oczu (np. zostawiła go w hotelowym pokoju przed wyjściem na basen). Ale to nie wszystkie możliwości: czasem jeden SMS wystarczy, aby przejąć czyjś telefon. Zainfekować telefon złośliwą aplikacją możemy także poprzez zwykłe wejście na stronę internetową z poziomu przeglądarki w telefonie… Aplikacje służące do podsłuchu korzystają z mikrofonu i głośnika; nagrywa to co mówi ofiara, i to co słyszy (często ma także dodatkowe funkcje, np. robienie zdjęć, wgrywanie innego oprogramowania). Warto tu podkreślić, że korzystanie z szyfrowania transmisji (nawet na poziomie karty SIM, jak w przypadku Angeli Merkel) nie ma wpływu na tego typu podsłuch — on odbywa się bowiem na końcówce kryptograficznej — tzn. przed zaszyfrowaniem słów ofiary i po rozszyfrowaniu słów rozmówcy ofiary. Inne rodzaje podsłuchu rozmów telefonicznych Rozmowa telefoniczna może zostać podsłuchana na łączach operatorskich. W końcu stojące w polach BTS-y łączą się przewodowo (niekiedy z wykorzystaniem infrastruktury internetowej) z “centralą” sieci GSM. Jeśli połączenie pechowo przechodzi przez punkt wymiany ruchu, w którym NSA zainstalowało swoją sondę PRISM lub XKEYSCORE to jest szansa, że rozmowa została przechwycona (pytanie czy w ogóle była szyfrowana, jeśli tak, to czy NSA ma backdoora lub moc obliczeniową która pozwoli złamać szyfrowanie?). Nie zapominajmy także o mikrofonach kierunkowych/laserowych. Za ich pomocą można z dużych odległości wyłapywać dźwięki, także osób rozmawiających przez telefon. Są też metody analizy ulotu elektromagnetycznego (por. jak NSA podsłuchiwała faksy UE)… Jak ochronić się przed podsłuchem? O ogólnych technikach ochrony przed inwigilacją już kiedyś pisaliśmy w tekście pt. “Służby czytają nasze SMS-y, jak się zabezpieczyć przed inwigilacją”. Poniżej wypisujemy najważniejsze porady dla posiadaczy telefonów komórkowych: Aktualizuj oprogramowanie i system operacyjny twojego telefonu. Dzięki temu zmniejszysz ryzyko wykorzystania podatności służącej do zainstalowania ci na telefonie złośliwej aplikacji Blokuj dostęp do ekranu twojego telefonu; jeśli to możliwe ustaw coś więcej niż tylko 4 cyfrowy PIN i włącz opcję czyszczenia zawartości telefonu w przypadku 10 błędnych prób podania kodu dostępu. Dzięki temu przypadkowy znalazca twojego telefonu nie dostanie się do twoich danych, a znajomi nie wykorzystają chwili nieuwagi, żeby doinstalować ci złośliwą aplikację. Pilnuj też bezpieczeństwa swojego komputera — NSA inwigiluje telefony wykorzystując to, że synchronizują się z komputerami. Wyłączaj interfejsy komunikacyjne, z których nie korzystasz (Wi-Fi, Bluetooth, NFC). Wyłącz także “automatyczne podłączanie się do znanych sieci Wi-Fi”. Dzięki temu atak opisany w punkcie 2 atak z wykorzystaniem fałszywego access-pointa będzie trudniejszy. Jeśli twój telefon wspiera VPN, skonfiguruj go i ustaw aby zawsze był włączony. To uchroni cię przed skutkami ataku z wykorzystaniem fałszywego access-pointa, opisanego w punkcje 2. Sprawdź czy twój telefon informuje o nieszyfrowanych połączeniach z siecią GSM — i jeśli to możliwe, spróbuj zablokować tego typu połączenia. Warto także zwrócić uwagę na to, aby nie korzystać z urządzeń elektronicznych, które otrzymaliśmy jako prezent, np. podczas zagranicznej wizyty u partnera biznesowego. Nie zawsze bowiem “oryginalnie” ofoliowany sprzęt pochodzi wprost od producenta… Przede wszystkim jednak, jeśli obawiasz się podsłuchu, wrażliwe sprawy poruszaj tylko w rozmowach w 4 oczy, na terenie, który uprzednio został sprawdzony przez odpowiednią firmę pod kątem podsłuchów. Nie tylko to o czym mówimy jest ważne… Na koniec warto zwrócić uwagę na to, że nie zawsze ważna jest sama treść rozmowy przez telefon. Czasem wystarczy pozyskać wiedzę, że właściciel danego telefonu komórkowego w danym czasie przebywał w danym miejscu. I że w tym samym miejscu i czasie była także inna osoba. Pozyskanie tego typu informacji — zgadliście — też jest możliwe dzięki telefonom komórkowym, których położenie można przecież precyzyjnie lokalizować. Przypomnijmy, że taką lokalizację już się stosuje — zarówno na poziomie operatora GSM (w Polsce chciano wprowadzić specjalne prawo ułatwiające zbieranie danych na temat historycznych lokalizacji Polaków) jak i na poziomie innych interfejsów komunikacyjnych; w Wielkiej Brytanii supermarkety analizują którymi alejkami najczęściej chodzą klienci przy pomocy przechwytywania ich sygnału. To samo Rosjanie chcą wdrożyć w swoim metrze… ale tak naprawdę każdy, bardzo niskim kosztem, może sobie zbudować inwigilującą posiadaczy telefonów komórkowych infrastrukturę (sieci reklamowe w Londynie już z niej korzystają). Podobno prezydent Obama z tego powodu podróżuje z przenośnym BTS-em, który anonimizuje jego numer IMSI. Zostaw telefon w domu Idąc na weekendowy spacer, zostawcie komórkę w domu, przypomnijcie sobie jak czuliśmy się 15-20 lat temu, kiedy użycie telefonu komórkowego nie było tak powszechne. Zdjęcie spotkanego w parku kota możecie przecież równie dobrze zrobić zwykłym aparatem — spokojnie, na Facebooka wgracie je po powrocie do domu. Przez to godzinne opóźnienie świat się przecież nie zawali… ,Piotr Konieczny