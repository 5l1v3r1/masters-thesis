3 lata temu opisywaliśmy jak złamać hasło do BitLockera i TrueCrypta. Wspomnieliśmy wtedy o ataku Cold Boot, czyli nie tak szybkiej ulotności danych z pamięci RAM jak uczyli nas w szkołach. Wyjaśniliśmy też atak Evil Maid autorstwa Joanny Rutkowskiej. Dziś mamy dla was praktyczną implementację ataku “złośliwej pokojówki”. Evil Maid w akcji Atak Evil Maid polega na przechwyceniu hasła służącego do rozszyfrowania dysku twardego. Atak wykorzystuje fakt, że aby rozszyfrować dysk musimy najpierw uruchomić z pamięci niezaszyfrowany kod funkcji rozszyfrowującej, która wygeneruje klucz na podstawie hasła przekazanego przez użytkownika. Funkcja ta, ponieważ nie jest zaszyfrowana, może zostać swobodnie zmodyfikowana przez atakującego, w szczególności w taki sposób, aby zapisać wprowadzone przez ofiarę hasło i wysłać je do atakującego. Alex Webr zaimplementował atak Evil Maid przy pomocy “fałszywego” narzędzia CHKDSK (512 bajtów!), którego zadaniem jest poprosić użytkownika o hasło do dysku w trakcie bootowania pod pozorem wykrycia usterki w filesystemie. Po przechwyceniu, hasło jest zapisywane na nośniku z którego uruchomiono CHKDSK, a następnie komputer restartuje się… Wszystko wygląda więc jakby rzeczywiście nastąpił problem z dyskiem, z którym na szczęście narzędzie CHKDSK sobie poradził. Przypomnijmy, że aby przeprowadzić atak Evil Maid, atakujący z reguły musi uzyskać fizyczny dostęp do komputera ofiary aby podmienić bootloader. Stąd też nazwa “złośliwa pokojówka”, wskazująca na sytuację w której zostawiamy laptopa w hotelowym pokoju, schodząc np. na kolację. Jak się ochronić przed atakiem Evil Maid? Aby zabezpieczyć się przed atakiem Evil Maid należy: Nie spuszczać swojego laptopa z oczu. Nigdy. Nierealne? No to lecimy dalej; Ustawić hasło na BIOS i zmienić kolejność bootowania tak, aby nie można było wystartować komputera z innego nośnika (to pozwala atakujacemu na podmianę bootloadera). Zapisać sumę kontrolną swojego bootloadera i weryfikować ją przed każdym “zimnym” startem komputera (narzędzie typu disk hasher). Alternatywnie, usunąć kod bootloadera z dysku i startować komputer z bootloadera z karty pamięci, pendrive lub płyty CD. Albo skorzystać z TPM i jednocześnie bacznie rozglądać się w poszukiwaniu hardware’owych keyloggerów w trakcie wprowadzania hasła. Tym, którym atak wydaje się być małoprawdopodobnym, dedykujemy nasz niedawny artykuł pt. “miętówkami w agentów” opisujący historię HD Moora i jego laptopa pozostawionego w hotelowym pokoju… ,Piotr Konieczny