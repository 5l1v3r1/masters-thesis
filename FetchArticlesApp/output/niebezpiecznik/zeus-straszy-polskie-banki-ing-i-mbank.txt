Historia ta zaczyna się dokładnie 10-tego lutego, kiedy po polskim internecie zaczyna krążyć zmodyfikowana wersja popularnego ZeuSa, atakująca *polskojęzycznych* klientów ING Banku Śląskiego i mBank. Czym jest ZeuS i jak on działa? ZeuS do niedawna działał głównie na zasadzie zbliżonej do keyloggera, który przechwytuje loginy i hasła do bankowości internetowej. Infekcja komputera ZeuSem z reguły następuje poprzez ataki drive-by-download, wykorzystujące błędy w oprogramowaniu internauty (złośliwe oprogramowanie uwielbia, kiedy korzystacie ze starych, niezaktualizowanych wersji przeglądarek internetowych). ZeuS do ataku wykorzystuje również phishing i elementy inżynierii socjalnej: klient trafia na stronę internetową i myśli, że ogląda oryginalną strona banku, więc podaje wszystkie dane, o które się go prosi. ZeuS nam nie straszny, mamy kody SMS! Z ulgą oddychały banki, które do autoryzacji transakcji internetowych wykorzystywały SMS kody (mTAN), przesyłane do klientów na ich telefony komórkowe. Zeus, stosując opisane powyżej metody, nie był im straszny… do teraz, kiedy to wykorzystywana już rok temu za granicą wersja Zeusa implementująca ataki Man-in-the-Mobile dotarła do Polski. Ataki na klientów ING “Dedykowana” polskim klientom ING Banku Śląskiego wersja Zeusa modyfikuje stronę internetową banku (wstrzykując dodatkowe fragmenty kodu HTML). Klient podaje login i hasło (pełne!), a następnie widzi zeusowy komunikat “bezpieczeństwa”, proszący go o podanie modelu i numeru telefonu w celu przesłania “certyfikatu bezpieczeństwa“. Oczywiście link, który SMS-em dostaje klient banku, to złośliwa aplikacja dopasowana do modelu telefonu. Aplikacja ta monitoruje wszystkie przychodzące SMSy i przesyła je na numer “operatora” Zeusa. Właściciel telefonu nie widzi nawet powiadomienia, że dostał nową wiadomość. Przez ZeuS-a wspierany jest Symbian (.sis) oraz BlackBerry (.jad) a od tej wersji także Windows Mobile (.cab). Dlaczego nie ma iPhone’a? Bo użytkownicy tego telefonu w założeniu nie mogą sami instalować na nim aplikacji — muszą je ściągnąć z AppStore’a kontrolowanego przez Apple. I tak oto Zeus obchodzi dwuskładnikowe uwierzytelnienie — mając login, hasło i możliwość odczytania kodu SMS-owego przesłanego na komórkę klienta, Zeus ma też możliwość wyczyszczenia nam konta. Polskie Banki zaczynają ostrzegać klientów Jak donoszą nasi czytelnicy na Facebooku, przed atakami ZeuSa ostrzega ING (co oczywiste): Ostrzega też mBank, którego klienci co prawda nie są celem ataków ZeuSa. Jeszcze [Aktualizacja 22.02.2011: a jednak mBank również był celem ZeuSa, por. ten komentarz]. Wczoraj rano otrzymałem poniższą wiadomość e-mail: przy logowaniu zobaczyłem: po zalogowaniu zobaczyłem: a wieczorem dodatkowo otrzymałem takiego SMS-a: Co ciekawe, rozesłanie tego SMS-a najprawdopodobniej do wszystkich klientów banku spowodowało ciekawy (dowcipny?) efekt uboczny — zalanie niebezpiecznikowej skrzynki kontaktowej spanikowanymi wiadomościami typu “chyba ktoś zhackował mbank“, “czy nasza kasa w mBanku jest bezpieczna, właśnie dostałem taki sms od nich“, etc. — to pokazuje jak ciężkim zadaniem jest ostrzeganie/informowanie klientów o incydentach bezpieczeństwa (i to tych które przecież jeszcze nie nastąpiły!), tak aby nie wywołać paniki. Zadziwia mnie, że tyle osób, po tak wyważonym i jasnym komunikacje mBanku od razu ubzdurało sobie “czarny scenariusz” na zasadzie: Brak ofiar? …to zależy jak rozumiemy “ofiarę” W wywiadzie dla Gazety, rzecznik ING powiedział, że “żaden z klientów banku nie padł jeszcze ofiarą Zeusa” — jak mniemam, przez “padanięcie ofiarą” rzecznik uznaje odczuwalną przez klienta banku utratę pieniędzy z konta, a nie samą infekcję ZeuSem. Sprytna definicja, bo zainfekowanych osób na pewno “kilka” się znajdzie …i potwierdza to nawet sam ING, publikując na swoich serwerach instrukcję usunięcia Zeusa… Finansowych strat ofiary jednak nie odczują (klienci, nie bank), bo zasada jest taka, że straty klientów pokrywa bank — i stąd, tak agresywne informowanie klientów o atakach bardzo się opłaca (wszystkim, nie tylko bankowi, bo nie zapominajmy, że ZeuS oprócz danych do kont bankowych potrafi gwizdnąć o wiele więcej danych użytkownika). Sam builder binarki ZeuS-a można kupić za kilkaset do kilu tysięcy dolarów. Wygląda on tak: Pola które widzicie podczas generowania konfiga bota, takie jak WebFilters i WebDataFilters zawierają listy URL-i i wyrażeń, które mają być przechwytywane przez bota i wysyłane do jego autora. WebFakes to z kolei parametr, który instruuje ZeuS-a, że URL-e z tej listy należy przekierować na inny adres. Pliki konfiguracyjne ZeuSa są szyfrowane, do ich odkodowania można wykorzystać ten program. Brawo mBank! A jednak nie ;) Pojawienie się wersji Zeusa atakującej klientów jednego polskiego banku, i tak szybka i szeroka akcja “uświadamiająca” innego banku jest naprawdę godna pochwały [Aktualizacja 22.02.2011: mBank też był celem ZeuSa, por. ten komentarz — co przekreśla altruizm informacyjnej akcji mBanku]. Takie informacje o trwających atakach są dla mnie ciekawe z dwóch powodów — pieknie obrazuje ilu “zwyklych” użytkowników komputera (tj. nierozumiejących podstawowych zasad bezpieczeństwa tego całego internetu) jest klientami bankowści online i jak niska musi być bariera wejścia w bankowość internetową, skoro nawet ci co jej nie rozumieją, potrafią z niej skorzystać. Od dawna powtarzam, że: dwuskładnikowe uwierzytelnienie i inne środki ochrony zawsze będą nieskuteczne, jeśli człowiek, który z nich korzysta jest idiotą Gdybyście chcieli poczytać o podatności na social-engineering, to zagadnienie to poruszyłem w moich przewidywaniach dotyczących przyszłości bezpieczeństwa komputerowego. P.S. W kontekście powyższych ataków, warto wspomnieć niedawny post opisujący praktyki stosowane przez niektóre sieci telefonii komórkowej, które dzwonią do swoich klientów i pytają ich o hasło… — pięknie kłóci się to z dobrymi praktykami, które w konteście ataków ZeuSa stara się wśród swoich klientów zaszczepić ING: No ale przecież PLAY od miesięcy powtarza mi, że podawanie hasła dzwoniącemu do mnie konsultantowi jest OK! Aktualizacja 21.02.2011; 21:00 W dzisiejszym Teleekspresie poruszono temat ZeuSa, niestety po łebkach; materiał zobrazowano przy pomocy formatek banku Inteligo (akurat nie będącego celem tej wersji ZeuSa), jest wypowiedź policjanta o “kodach kreskowych” (sic!), a na koniec rada (totalnie w przypadku ZeuSa nietrafiona) aby sprawdzać czy przed adresem banku jest HTTPS… *triple*facepalm* — nagranie tutaj, aby umrzeć ze śmiechu, przeskoczcie do 7-mej minuty. W wiadomościach TVP też poleciał materiał o ZeuSie. Była nawet “ofiara” — ale nie jestem pewien, czy właśnie tego trojana, o którym się tu rozpisujemy… Aktualizacja 22.02.2011, 15:20 Jak wynika z komentarza jednego z klientów mBanku, nie tylko ING Bank Śląski był atakowany przez Zeusa, mBank także był celem ZeuSa (tu kolejny dowód). Weszliśmy w posiadanie próbek opisywanej w artykule wersji ZeuSa — analiza trwa. W międzyczasie, analzują też inni. Kaspersky informuje o tym, że ZeuS atakuje także Windows Mobile [pl]. Chciałbyś własnoręcznie przeanalizować Zeusa? Możesz to zrobić na naszym szkoleniu. ,Piotr Konieczny