W routerach TP-Link znaleziono backdoora, który daje dostęp do debug-shella na prawach roota. Potencjalnie można więc przejąć kontrolę nad routerem (access pointem), zmienić jego konfigurację lub podsłuchać ruch jego użytkowników. Poniżej o tym, jak sprawdzić, czy wasz model routera jest podatny oraz co zrobić, aby się przed tym zabezpieczyć. Backdoor w routerach TP-Link Firma Websec opisała 2 dni temu interesującego backdoora w modelach TP-Link WDR740N, WDR740ND (firmware: 3.12.11 Build 111130 Rel.55312n). Okazuje się, że programiści panelu zarządzania routerem zahardcodowali dane dostępowe do tajnego zasobu, umożliwiającego przejęcie kontroli nad routerem: http://TPLINK_IP/userRpmNatDebugRpm26525557/linux_cmdline.html Login: osteam Hasło: 5up Powyższe dane umożliwiają dostęp do konsoli, dzięki której można uruchamiać dowolne polecenia na routerze. Jak się ochronić? Sprawa nie jest prosta — odkrywcy błędu twierdzą, że do shella można dostać się lokalnie (LAN) i zdalnie (najprawdopodobniej chodzi o WAN). Z racji tego, że backdoor jest zaszyty w firmware, dopóki nie mamy patcha niewiele możemy zrobić aby go usunąć. Najlepiej, do czasu wydania patcha, przeflashować nasz router na firmware od OpenWRT — tutaj lista wspieranych przez OpenWRT modeli — ale uwaga! jest szansa, że nie będziecie już chcieli wracać na oryginalny firmware od producenta ;) To nie pierwszy backdoor w routerach Jako pierwsi sprawę nagłośnili użytkownicy serwisu reddit.com, którzy celnie spostrzegli, że nie TP-Link pierwszy i zapewne nie ostatni… Czytelnicy Niebezpiecznika powinni pamiętać niedawną wpadkę dotyczącą loadbalancerów F5 oraz backdoory w switchach firm 3Com, Dell oraz innych. PS. Na marginesie, firma Websec opublikowała także błąd typu path traversal w tych samych routerach: …a później dopisała do swojego oświadczenia, że na te same błędy wpadli wcześniej …Rosjanie — i to już w lutym 2011 roku… (z małą różnicą, bo Rosjanie piszą o modelach TL-WR741N i TL-WR741ND). Ciekawe co jeszcze wiedzą Rosjanie? ;-) 23:00 Jak zauważają w komentarzach nasi czytelnicy posiadający routery TP-Linka, niektóre z modeli (inne niż te wymienione powyżej) także zawierają “backdoora”, ale w części z routerów aby z niego skorzystać należy się najpierw poprawnie uwierzytelnić. ,igH