Misfortune Cookie to nazwa dziury, która ma dotykać 12 milionów domowych routerów (ok. 200 różnych modeli). Dzięki temu atakowi, intruz ma mieć możliwość zalogowania się na routerze jako administrator bez potrzeby znajomości hasła — a do czego to prowadzi, pisaliśmy już nie raz (por. stracił 16 000 PLN bo miał dziurawy router). Misfortune Cookie Producenci rozwiązań bezpieczeństwa chyba ostatnio prześcigają się między sobą, który z nich opublikuje bardziej medialny raport, o poważniejszym błędzie, z najfajniejszą nazwą i najbardziej ślicznym logiem. Po HartBleadzie i Shell Shocku, kampaniach takich jak Cleaver czas na CheckPointa i Misfrotune Cookie. Na czym polega atak? Do routera trzeba wysłać odpowiednio zmodyfikowane ciasteczko. Dzięki błędowi w jego obsłudzie router “głupieje” i uznaje osobę przesyłającą to ciasteczko za administratora. Atakujący korzystający z tej dziury, którzy dostaną się na poziom domowych routerów, zapewne będą podmieniali DNS-y na złośliwe, albo wykonywali inne ataki typu Man in the Middle (np. zmiana w routingu może prowadzić do przejmowania Bitcoinów). Na razie brak kodu exploita, ale zapewne pojawi się na dniach, ponieważ… błąd ten został już ponoć załatany przez producenta w 2005 (!!!) roku, ale z analizy firmy CheckPoint wynika, że wciąż 12 000 000 routerów korzysta z dziurawej wersji tego webserwera. Jakoś nas to nie dziwi, bo dziura która w styczniu tego roku dotknęła ponad milion Polaków też została odkryta po raz pierwszy 10 lat temu (!!!). Przyczyną dziury Misfortune Cookie ma być błąd w oprogramowaniu webserwera RomPager firmy AllegroSoft (dla wersji poniżej 4.34), w oparciu o który pracuje spora część domowych routerów różnych producentów, m.in: TP-Link D-Link Edimax Huawei ZTE Zyxel Mam router; co robić, jak żyć? Nie wpadajcie w panikę. Problem najbardziej dotyczy tych routerów, które udostępniają panel zarządzania na interfejsie WAN (od strony internetu). Ale mamy nadzieję, że po ostatniej fali ataków na routery już dawno je przekonfigurowaliście tak, aby nie dało się na nie logować od strony internetu. Mniej ucierpią ci, którzy, choć mają wyblokowane możliwości nawiązywania połączeń z interfejsem administracjnym routera od strony internetu, to zezwalają na tego typu dostęp od strony sieci lokalnej po Wi-Fi, o ile do swojej sieci wpuszczają niezaufane osoby. UWAGA! Taką konfigurację często spotyka się np. w kawiarniach i publicznych hotspotach — ale łącząc się z internetem z niezaufanej sieci i tak zawsze powinniście zaczynać od zestawienia połączenia VPN. Krótko mówiąc, najlepiej całkowicie zablokować zarządzanie routerem od strony internetu, oraz od strony sieci lokalnej (Wi-Fi), a zostawić możliwość administracji jedynie poprzez bezpośrednio połącznie “po kablu” (nie zapomnijcie tylko schować routera do szafeczki na kłódkę, żeby nikt swojej skrętki mu nie wsadził :) Można też oczywiście — co zawsze polecamy — sprawdzić czy Wasz router udźwignie alternatywny firmware, taki jak OpenWRT lub Tomato …i przeflashować go (oraz całej swojej rodzinie, w prezencie pod choinkę). PS. Ciężko oprzeć się wrażeniu, że Checkpoint robi z tego zananego od 9 lat błędu marketingowo-PR-ową zagrywk, pt. kup naszego firewalla. Najbardziej jednak urzekły nas słowa ilustrujące “realne” zagrożenie związane z tą dziurą: i dopisek w nawiasie: “potencjalnie, jeśli używasz domyślnego hasła“… Niniejszym ogłaszamy więc, że możemy się włamać na skrzynkę e-mailową prezesa CheckPointa (jeśli potencjalnie używa domyślnego hasła). ,igH