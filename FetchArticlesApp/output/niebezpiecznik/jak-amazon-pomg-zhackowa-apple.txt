Pamiętacie horror story dziennikarza Wired/Gizmodo, któremu ktoś zdalnie skasował dane z Macbooka, iPhone’a, przejął konto na Twitterze i skasował skrzynkę na GMailu? Okazuje się, że winnym jest nie tylko pracownik infolinii Apple (który, jak oświadczyło Apple nie podążął za wszystkimi procedurami), ale również beznadziejne procedury Amazonu… Amazon pozwolił zaatakować Apple W opisywanym przez nas kilka dni temu przypadku, wszystko zaczęło się od ataku socjotechnicznego na pracownika infolinii Apple, którego efektem był reset hasła do konta Mata Honana, dziennikarza Wired i Gizmodo. Jak dokładnie wyglądał atak? Phobia (to nick hackera), poprosił o reset hasła do konta dziennikarza Mata, podszywając się pod niego, a Apple w tym celu wymagało podania jedynie 4 ostatnich cyfr numeru karty kredytowej i adresu płatnika (ang. billing address). Mat zauważa, że te dane ma nawet jego 16-letni dostawca pizzy… Amazon pomaga resetować hasła do kont AppleID/iCloud Skąd Phobia miał 4 ostatnie cyfry numeru karty kredytowej Mata oraz jego adres? Z Amazonu. Jak je zdobył? A tak: 1. Z konta Twitterowego Mata, które chciał przejąć trafił (poprzez link w profilu) na domową stronę Mata. Sprawdził dane w WHOIS i poznał adres Mata, który jest właścicielem domeny. 2. Na stronie Mata znalazł też jego adres e-mail i zadzwonił do Amazonu, prosząc o dodanie kolejnej karty kredytowej do konta ofiary. Procedura Amazonu wymagała podania jedynie adresu przypisanego do konta (ten z bazy WHOIS pasował). Atakującemu udało się dodać nowy numer karty kredytowej do konta ofiary. 3. Atakujący kolejny raz zadzwonił do Amazonu i poprosił tym razem o reset hasła do konta. Jaka jest procedura Amazonu w takim przypadku? Amazon prosi o numer karty kredytowej (a dokładniej dowolnej karty skojarzonej z kontem). Atakujący podał numer, który dodał do konta ofiary w kroku 2. 4. Po zresetowaniu hasła i zalogowaniu się na Amazonowe konto Mata, atakujący mógł zobaczyć w ustawieniach …cztery ostatnie cyfry pierwszej, oryginalnej, dodanej przez Mata karty kredytowej. Mając te 4 cyfry zadzwonił do Apple i zresetował hasło do konta iCloud Mata. Mając dostęp do iCloud, odzyskał hasło do GMaila (adres iCloudowy podany był jako backup e-mail). Mając konto do GMaila, przejął konto Mata na Twitterze (po drodze kasując dane ze skojarzonych z kontem iCloudowym urządzeń). Okazało się, że konto Mata było zlinkowane z Twitterem Gizmodo, a więc atakujący mógł wysyłać swoje twity jako Gizmodo. GAME OVER. To by nie wyszło, gdyby… Atak zapewne nie udałby się gdyby ofiara, techniczny dziennikarz Wired/Gizmodo, ukrył swoje dane w bazie WHOIS (można to zrobić w Polsce dla wszystkich domen zarejestrowanych na osoby prywatne). Dodatkowo pomogłoby używanie różnych kart kredytowych dla różnych płatników, ale taka usługa “aliasów” dla kart kredytowych chyba na polskim rynku nie jest (jeszcze?) świadczona przez żaden bank… Przede wszystkim jednak, cały atak nie miałby miejsca, gdyby nie błędy logiczne w telefonicznych procedurach resetu hasła Amazonu i dość luźne wymagania co do telefonicznego resetu hasła w Apple. Na chwilę obecną Amazon poinformował, że uniemożliwił już tego typu postępowanie, a Apple czasowo wyłączyło reset hasła przez telefon. ,igH