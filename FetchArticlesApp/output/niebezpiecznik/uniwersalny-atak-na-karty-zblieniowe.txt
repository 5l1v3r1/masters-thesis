Ostatnio znów jest głośno o problemach z kartami zbliżeniowymi. Wyborcza przypomina stare i dobrze znane (acz poparte realnymi przykładami) problemy płatności zbliżeniowych, na które my uczylaliśmy Was już jakiś czas temu (por. odczytywanie danych z karty zbliżeniowej oraz ataki na karty zbliżeniowe). Dziś chcielibyśmy opisać uniwersalny atak na zbliżeniówki, niewymagający “klonowania” karty i dość jasno pokazujący dlaczego karty zbliżeniowe PayPass czy PayWave mogą być łatwiejszym celem niż standardowe karty (te bez anteny i chipa NFC). Do przeprowadzenia ataku-kradzieży wystarczą nam …2 telefony z odpowiednią aplikacją. Atak przedłużenia terminala Wyobraźmy sobie 2 atakujących. Bożydara i Zygfryda. Bożydar udaje się do sklepu, pakuje do koszyka produkty do 50 PLN (bo to najpopularniejszy limit dla jednorazowej transakcji zbliżeniówką). Bożydar podchodzi do kasy i informuje kasjerkę, że będzie płacić zbliżeniowo. Wyciąga telefon (tak, zbliżeniowo można płacić zarówno zegarkami jak i telefonami) i przykłada go do czytnika. Teraz dzieje się rzecz magiczna. Telefon Bożydara wyposażony jest w chip zbliżeniowy NFC, ale jest jednocześnie połączony przez internet (po 3G lub EDGE lub GPRS) z takim samym telefonem, ale należącym do Zygfryda. Zygfryda nie ma w sklepie — jest w autobusie (albo innym tłocznym miejscu). Zygfryd “obmacuje” swoim telefonem torebki/plecaki przypadkowych osób, licząc na to, że któraś z nich posiada kartę zbliżeniową. Innymi słowy telefon Bożydara komunikujący się z telefonem Zygfryda “przedłuża” sklepowy czytnik kart zbliżeniowych do autobusu, co w konsekwencji sprawia, że za zakupy Bożydara płaci przypadkowa osoba. Zauważmy, że Zygfryd może wykrywać karty zbliżeniowe zanim nastąpi faktyczna transakcja — wtedy wie kto ma kartę i w momencie otrzymania sygnału od Bożydara podkłada telefon pod upatrzoną wcześniej ofiarę. Jak informują badacze, informację z chipów NFC można odczytać nawet z odległości 1 metra. (Ba, mając specjalną aplikację, Zygfryd może nawet odczytywać dane z karty płatniczej ofiary — ale ich znajomość nie jest nam w ataku przedłużenia terminala do niczego potrzebna). Jak widać wcale nie musimy “klonować” czyjejś karty, żeby nią zapłacić. Drogie skimmery na bankomaty nie są tu potrzebne. Zabezpieczenia w postaci zliczania przez kartę liczby transakcji zbliżeniowych, czy też ochrona CVV3 (czyli dynamiczny CVV) w przypadku tego ataku, będącego w istocie atakiem typu relay (atakiem MitM), nie ma żadnego znaczenia. Ochrona przed atakiem przedłużenia terminala Najpierw powiedzmy o ochronie, która nie zadziała. Trzymanie wielu kart zbliżeniowych przy sobie — o ile ogłupia to proste czytniki w bramkach metra, czy kasowniki w autobusach, to nie oszuka profesjonalnego czytnika NFC — te potrafią bezkolizyjnie odczytać kilka kart jednocześnie. Najsensowniejszym zabezpieczeniem będzie schowanie karty w klatce Faraday’a (folii aluminiowej) albo fizyczne uszkodzenie anteny — tak jak to opisaliśmy w tym poście (uwaga, przecięcie zwojów nie “zabija” anteny, a jedynie sprawia, że jest ona mniej wydajna). Szkoda, że producenci kart nie montują na kartach prostego przełącznika, włączającego chip NFC (a więc funkcję płatności zbliżeniowej) jedynie na życzenie klienta (czyli tuż przed transakcją w sklepie). Sam złodziej z kolei może zostać namierzony jedynie przez korelację logów z fałszywej płatności i sklepowego monitoringu (o ile monitoring istnieje i zapis jest archiwizowany). Podsumowując, powyższy atak to kolejny powód do: obwinięcia swojej karty płatniczej w folię aluminiową (podkreślmy to jeszcze raz: dwie karty obok siebie da odczytać profesjonalnym czytnikiem) …lub zastanowienia się, czy warto ryzykować bycie posiadaczem karty zbliżeniowej? Oczywiście można też liczyć na chargebacki i zwrot z ubezpieczenia w przypadku fałszywej transakcji — warto uprzednio upewnić się, powyżej jakiej kwoty one działają (czyt. niekiedy kradzież na sumę poniżej 200PLN nie zostanie nam zwrócona, bo zgodnie z regulaminem środki do 200PLN pokrywa klient). PS. W tworzeniu aplikacji na telefony pomóc może oficjalne API Mastercardu :> z kolei do zabawy z NFC polecamy libnfc — a na Androida gotowe rozwiązanie: nfcproxy. ,Mr. Niebezpieczny