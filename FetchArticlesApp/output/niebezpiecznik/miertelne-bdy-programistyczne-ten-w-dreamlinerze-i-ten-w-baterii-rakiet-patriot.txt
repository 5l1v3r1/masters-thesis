W ostatnich dniach głośno było o katastroficznym problemie wykrytym w oprogramowaniu Boeinga 787 (tzw. Dreamlinera) — błąd programistyczny pozbawiał samolot samolot zasilania, jeśli jego generatory nie były wyłączane przez 248 dni. Ale mało kto wie, że niemalże taki sam błąd 24 lata temu został odkryty w baterii przeciwrakietowej Patriot. Przyjrzyjmy się tym dwóm incydentom bliżej. Jak błąd Patriota zabił 28 żołnierzy? Jest 25 lutego 1991 roku. Trwa wojna w zatoce perskiej. Koszary amerykańskich żołnierzy w Dahahran przed irackimi rakietami Scud ochrania mobilny, bo montowany na ciężarówce, rakietowy system ziemia-powietrze Patriot (na marginesie, jego kolejną wersję właśnie zakupiło Wojsko Polskie). System, pomimo wysokiej skuteczności szacowanej na 90%, nie zauważa jednej z irackich rakiet Scud, która trafia w koszary i zabija 28 amerykańskich żołnierzy. Kiedy wojna się kończy, amerykańscy naukowcy analizują incydenty, w których Patrioty nie zadziałały poprawnie. W lutowym wydaniu New Scientist w 1992 pojawia się obszerny artykuł na ten temat. Profesor Ted Postol stawia tezę, że jedną z przyczyn zawodności systemu jest nowa wersja rakiety Scud, Al-Husayn, która jest tak niestabilna, że “kruszy się” podczas wejścia w atmosferę. Jej odpadające fragmenty mają ogłupiać Patrioty. W marcu 1992 pojawia się jednak raport rządowej jednostki (General Accounting Office) który odnajduje dokładną przyczynę problemów Patriota — błąd programistyczny. Oto kluczowy fragment raportu: Systemy Patriot, które działały dłużej bez restartu, nieprecyzyjnie konwertowały czas. Patrioty w Dhahran działały bez przerwy dłużej niż 100 godzin. Po takim czasie pracy, błąd w konwertowaniu czasu wynosił 1/3 sekundy, co przy prędkości rakiety Scud sprawiało, że system spodziewał się jej w miejscu oddalonym o 600 metrów od poprawnego. Rakieta była więc wykrywana, ale kiedy Patriot zaczynał jej namierzanie, nie widział jej w kolejnych obliczanych przez siebie obszarach na niebie. System stwierdzał więc brak rakiety i nie podejmował reakcji. To nie koniec pouczającej historii dla programistów. Analiza incydentu wykazała bowiem, że dokładnie 2 tygodnie przed tragicznym wydarzeniem w Dhahran, 11 lutego 1991, izraelscy inżynierowie odkryli błąd w precyzji obliczeń systemu Patriot, który stosowany jest przez okres dłuższy niż zalecany (ok. 8 godzin), o czym poinformowali armię USA a jako doraźne obejście błędu doradzali regularne restartowanie baterii Patriot. Tuż po otrzymaniu informacji o błędzie, producent Patriotów rozpoczął prace nad patchem i 26 lutego 1991 wypuścił łatkę do oprogramowania Patriota. Teraz spójrzcie na datę na początku rozdziału… Wykorzystywanie produktu niezgodnie z instrukcją, brak skutecznej dystrybucji informacji o “obejściu” i spóźniona o jeden dzień łatka kosztowała życie 28 żołnierzy. Dziura w Boeingu 787 Dreamliner Przenieśmy się o 24 lata do przodu. Kilka dni temu amerykańska agencja nadzorująca lotnictwo FAA, wydaje raport, w którym informuje o błędzie w oprogramowaniu Dreamlinera (Boeinga 787), który powoduje wyłączanie generatorów prądu. Przyczyną jest tzw. integer overflow na wewnętrznym liczniku w oprogramowaniu generatorów. Przepełnienie zmiennej licznika powoduje przejście generatorów w tryb failsafe, podczas którego moc nie jest dostarczana do urządzeń samolotu. Dreszczyk pojawia się wtedy, kiedy wszystkie 4 generatory jakimi dysponuje Dreamliner włączono w tym samym momencie — ponieważ wtedy każdy z nich przestanie działać w tej samej chwili. Dziennikarze relacjonujący raport sugerowali, że przy braku energii elektrycznej Boeing 787 stanie się “latającą cegłą“; bez działającej klimatyzacji, oświetlenia i bez wszystkich elektronicznych systemów sterowania, czyli tzw. fly-by-wire, który stopniowo wypiera rozwiązania hydrauliczno-mechaniczne. Guardian informował, że jeśli awaria generatorów nastąpi podczas startu lub lądowania, jej skutki mogą być katastrofalne. Żartowano też, że przed rozpoczęciem podróży Dreamlinerem, dla bezpieczeństwa i wyzerowania zmiennej w generatorze prądu, pasażerowie powinni poprosić pilota o zrestartowanie samolotu. Wśród komentujących ten incydent miłośników lotnictwa problem bagatelizowano, twierdząc, że podczas utraty generatorów załączą się akumulatory, dające wystarczająco dużo czasu, aby “zrestartować” generatory, a dodatkowo samoloty wyposażone są także w tzw. RAT (Ram Air Turbine) generujący prąd na podstawie ruchu powietrza pod samolotem. Jakie jest oficjalne stanowisko Boeinga? Producent uspokaja, że nigdy nie zdarzyło się, aby jakikolwiek z samolotów nie był wyłączany przez okres ponad 8 miesięcy. Poprawkę jednak oczywiście wypuści. Pani doktor nie wejdzie do szatni, bo system nie pozwala Na koniec, aby trochę zdystansować się od rakiet, wybuchów i spadających samolotów, chciałem pokazać, że nas — przeciętnych zjadaczy chleba — błędy programistyczne częściej będą dotykać w innych sytuacjach. Przykładem jest pewna pani z tytułem naukowym doktora, która udała się na siłownię, ale nie była w stanie wejść do damskiej szatni. Przydzielony jej kod wejścia nie był przyjmowany przez zamek. Po zgłoszeniu problemu obsłudze zauważono, że system przypisał kobiecie kod do szatni męskiej. Dlaczego? Bo programista uznał, że jeśli ktoś ma tytuł naukowy “Dr”, to musi być mężczyzną. Pani doktor nie była zadowolona sugestią personelu, że do szatni wejdzie, jeśli zrezygnuje ze swojego tytułu naukowego na swojej karcie członkostwa… PS. Wszystkie prowadzone przeze mnie szkolenia dla programistów otwieram zestawieniem kilku błędów programistycznych, które zakończyły się albo śmiercią albo wielomilionową stratą, aby pokazać jaka “moc” i “odpowiedzialność” drzemie pod palcami programistów. Poza powyższymi, warte uwagi są także problemy urządzenia Therac-25 i problemy rakiety Ariane 5 a także Mars Climate Orbiter i pewien ciekawy przetarg dla lotniska w Los Angeles. Jeśli chcecie dowiedzieć się jak bezpiecznie programować, aby ustrzec się nie tylko takich jak te opisane powyżej błędów, to zapraszam do udziału w szkoleniu z Atakowania i Ochrony Webaplikacji — najbliższy termin to 15-16 czerwca w Krakowie. ,Piotr Konieczny