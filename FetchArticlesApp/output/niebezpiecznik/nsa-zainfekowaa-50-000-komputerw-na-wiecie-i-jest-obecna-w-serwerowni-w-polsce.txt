Kolejna z prezentacji ujawnionych przez Snowdena (tym razem “świeża”, bo z 2012 roku), zdradza że NSA zbiera dane z 50 000 lokalizacji na świecie przy pomocy złośliwego oprogramowania, często instalowanego na komputerach ofiar przy wykorzystaniu socjotechniki lub phishingu. Mapa “sond” NSA Ataki, nazywane przez NSA mianem CNE (Computer Network Exploitation) są wykonywane przez departament TAO (Tailored Access Operations) zatrudniający ponad 1000 “hackerów”. Jednostka ta działa od 1998 roku, a malware wykorzystywany do infekcji określany w oficjalnych dokumentach jest przez NSA terminem “implant”, którego najbliższym polskim odpowiednikiem będzie najprawdopodobniej “sonda”. NRC Handelsblad ujawniło mapę sond pochodzącą z prezentacji wykradzionej przez Snowdena. Jeśli nas oko nie myli, na terenie Polski znajdują się sondy typu CNE (czyli te, osadzone w wyniku ataków informatycznych) oraz SCS (nie wiemy na czym polega ich praca i jak są instalowane): To właśnie za pomocą ataków CNE — a konkretnie zwabiania pracowników na fałszywą stronę LinkedIna, która osadzała “implant” na ich komputerze, NSA wespół z brytyjską GCHQ uzyskały dostęp do belgijskiego telecomu Belgacom. Przez kilka lat w sieci Belgacomu instalowano w sieci złośliwe oprogramowanie, które miało podsłuchiwać ruch internetowy i telefoniczny klientów telecomu. I nie ma w tych działaniach nic zaskakującego — tego typu operacje są stosunkowo tanie i przynoszą stosunkowo wiele informacji. Na marginesie dodajmy, że nawet polski MON próbuje budować botenety służące do paraliżowania i przejmowania cudzych sieci komputerowych. Plany NSA na 2012-2016 Dodatkowo, z dokumentu “Sigint Strategy 2012-2016“, upublicznionego przez Snowdena planu rozwoju teleinormatycznego szpiegostwa NSA na kolejne lata, możemy dowiedzieć się że NSA planuje: Zidentyfikować nowe metody dostępu, zbioru i ataku poprzez wykorzystanie wpływów na globalne trendy biznesowe w dziedzinie komunikacji i danych. (Czyżby chodziło o naciski, jakie NSA może wywierać np. przy pracach projektowych nad algorytmami kryptograficznymi, aby celowo umieszczać w nich słabości?) Walczyć z krajowymi programami kryptograficznymi poprzez wszelkie działania, zarówno typu SigInt (działania teleinformatyczne) jak i HumInt (klasyczni szpiedzy). W Polsce celem NSA będzie więc nowopowstałe Narodowe Centrum Kryptologii, które tworzy narodowe szyfry. Na świecie celem pewnie będzie każda firma produkująca oprogramowanie do szyfrowania danych — wiadomo np., że NSA chciała namówić m.in. twórcę Bitlockera do wstrzyknięcia backdoora w swój kod. Tresure Map — czyli mapa internetu od NSA Innym ciekawym rozwiązaniem, którym — jak wynika z dokumentów Snowdena — ma dysponować NSA, jest “Treasure Map” (ang. Mapa Skarbów). Jest to interaktywna mapa całego internetu, działająca praktycznie w czasie rzeczywistym (tu więcej informacji na temat tego systemu). Dane bazują na publicznie dostępnych jak i przechwytywanych przez “implanty” informacjach. Mapa zbiera dane z sieci Wi-Fi i od providerów na temat prawie 50 milionów unikatowych adresów IP. Za pomocą tych danych, NSA może określić położenie konkretnego urządzenia na mapie — jak stoi w dokumencie opisującym projekt, jest on w stanie mapować “any device, anywhere, all the time“. Czyżby chodziło o identyfikacje unikatowych adresów MAC “podejrzanego” i określenie w której sieci znajduje się on w danej chwili oraz gdzie geograficznie jest zlokalizowana ta sieć? Śledzenie “any device” tylko po adresach IP nie spełnia warunku “anywhere, all the time” — chyba, że NSA stosuje “wstrzyknięcia” ciasteczek, którą to technikę w szczegółach opisywaliśmy w artykule “TOR jest bezpieczny, NSA nie daje mu rady, ale…“? “Paczka” wstrzyknięta do polskiej serwerowni Do budowy Mapy Skarbów NSA wykorzystała inny swój program, o kryptonimie Packaged Goods (“zapakowane rzeczy”) — za jego pomocą miała uzyskać dostęp do 13 serwerów w niczego nieświadomych serwerowniach. Niestety jedną z serwerowni jest któraś zlokalizowana w Polsce. Co ciekawe, NSA zapiera się, że nie “hackuje” serwerowni, a jedynie wykorzystuje podstawione firmy, aby wydzierżawić w nich swoje serwery. Do czego je wykorzystuje? Czy tylko do analizy “tras” pakietów z danej serwerowni, co zapewne pomaga w “mapowaniu” internetu i określaniu w jakich węzłach sieciowych gdzie umieszczać sondy do zbierania ruchu z danej serwerowni? Może jednak czasem serwery te wykorzystywane są jako “stacje przeskokowe”, wykonujące ataki “wgłąb” serwerowni w celu szerszej penetracji jej usług? Niestety, nie mamy dla was przepisu na to jak wykryć to, czy NSA osadziła swój serwer właśnie w Waszej serwerowni. Teraz już jednak wiecie, że któreś z polskich Data Center na pewno hostuje amerykańskich szpiegów. Admini serwerowni powinni jak najszybciej zweryfikować jak wygląda separacja pomiędzy serwerami ich klientów oraz siecią zarządzającą serwerowni — co niestety, jak pokazują wykonywane przez nas testy penetracyjne jest dość powszechnym problemem w różnych polskich serwerowniach. A brak rozsądnej separacji pomiędzy serwerami różnych klientów to podstawowa przyczyna pozwalająca atakującemu na swobodne “skakanie” po serwerach kolejnych klientów, w momencie przejęcia tylko jednej maszyny. ,vi.curry