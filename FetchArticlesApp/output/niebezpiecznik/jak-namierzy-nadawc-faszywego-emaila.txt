W dniu dzisiejszym do kilku polskich instytucji (szpitali, prokuratur) wpłynęły e-maile z informacją o podłożeniu ładunków wybuchowych. Zarządzono ewakuację obiektów — w sumie ok. 2000 osób. E-maile były anonimowe, ale Policja już zatrzymała pierwszego podejrzanego (brawo za błyskawiczną reakcję!). Jak im się to udało? E-maile można fałszować Adres e-mail nadawcy, który programy pocztowe wyświetlają po otwarciu wiadomości, bardzo łatwo można sfałszować. Odpowiednie narzędzia są dostępne za darmo w internecie, a z ich obsługą poradzą sobie uczniowie podstawówki. Z tego względu, praktycznie każdy może wysłać e-maila wyglądającego jakby pochodził np. z adresu e-mail samego prezydenta, Bronisława Komorowskiego. Wykrycie, że e-mail to fałszywka z reguły polega na ustaleniu, z jakiego serwera pocztowego (ang. mailservera) nadano wiadomość (i czy rzeczywiście był to serwer odpowiadający za obsługę poczty domeny nadawcy). W tym celu należy obejrzeć nagłówki wiadomości. Nagłówki, to dodatkowe informacje dotyczące e-maila, których z reguły program pocztowy domyślnie nie pokazuje (w GMailu trzeba kliknąć na “show original”, a w Outlooku wcisnąć CTRL+F3). Najważniejszym z nagłówków, w kontekście identyfikacji prawdziwego nadawcy jest nagłówek Received, opisujący hosty (w tym serwery pocztowe) przez które wędrował e-mail od skrzynki nadawcy do skrzynki odbiorcy. Serwery dopisują adresy hostów od których otrzymały pocztę w kolejnych nagłówkach “Received” (te na górze są najświeższe) — a zatem patrząc na adres wpisany w najstarszym nagłówku Received patrzymy najprawdopodobniej na host, z którego nadano wiadomość. Skąd wiadomo jaki serwer odpowiada za wysyłkę poczty z danej domeny? Tego nie da się ustalić — naszym najlepszym strzałem będzie więc podejrzenie serwera poczty przychodzącej, który zazwyczaj jest zbliżony w nazewnictwie do serwera poczty wychodzącej (ale nie musi). Komenda, która do tego służy to: host -t MX domena.pl. Jak ustalić prawdziwego nadawcę e-maila? Wiemy już, że e-mail jest fałszywy — teraz naszym zadaniem będzie ustalić kto go wysłał. W tym celu znów należy sięgnąć do nagłówków e-maila. W najstarszym nagłówku Received najprawdopodobniej ujrzymy adres IP serwera, z którym łączył się nadawca (nie zawsze będzie to prawdą, niektóre “anonimizery” są w stanie “czyścić” lub modyfikować starsze nagłówki Received). To że mamy adres IP serwera pocztowego z którego nadano wiadomość jeszcze nic nie oznacza. Potrzebujemy adresu IP nadawcy — ten policja, dysponując odpowiednim nakazem, może pozyskać od administratora serwera pocztowego, o ile administator przechowuje logi połączeń do swojego serwera. Jak ustalić właściciela adresu IP? Ale nawet tak pozyskany adres IP nadawcy może nie być prawdziwy. W większości tego typu przypadków żartownisie korzystają z serwerów proxy, np. sieci TOR. I tu — jeśli ktoś umiejętnie skorzystał z TOR-a — ślad zazwyczaj się urywa. Ale na szczęście (dla organów ściagania) — nie wszyscy potrafią z TOR-a korzystać w sposób zapewniający anonimowość i prywatności… Ujawniono informacje, że w kontekście tej sprawy Policja kontaktowała się z zagranicznymi służbami — zapewne w grę wchodziło użycie serwera proxy — nie można jednak tego potwierdzić nie zaglądając w nagłówki wiadomości, a tych Policja nie ujawniła. Niestandardowe metody ustalenia tożsamości nadawcy Gdyby administrator serwera Proxy czy też usługi VPN nie trzymał logów i nie można było na tej podstawie namierzyć sprawcy, czy istnieją inne metody? Tak. Oto kilka z nich: Korelacja logów ISP. Jeśli e-maile wysyłano o 4.20 nad ranem korzystając z TOR-a, można pokusić się o stwierdzenie, że o tej godzinie w Polsce tylko kilka osób łączyło się z siecią TOR (listę tzw. entry node’ów można pobrać z sieci i monitorować połączenia na te adresy). Gdyby służby miały możliwość przeszukiwania logów polskich ISP (np. TPSA, Netii, T-Mobile, etc.) mogłyby zaobserwować, że tuż przed 4.20 pewien komputer u jednego z ISP nagle nawiązał połączenie z siecią TOR. Oczywiście entry node != exit node, więc na tej podstawie nie można niczego dowieść, ale jest to bardzo cenna informacja “poszlakowa” ;-) Analiza logów ofiar. W opisywanym dziś przez media przypadku, ktoś rozesłał wiadomość o bombie do kilkunastu instytucji. Atakującego możnaby więc namierzyć nie po samym e-mailu, a po korelacji logów pochodzących z “zaatakowanych” instytucji — w końcu jakoś musiał zebrać odpowiednie adresy e-mail tychże instytucji, a więc najprawdopodobniej musiał je wszystkie odwiedzić — czy na pewno zrobił to korzystając z proxy? Analiza treści wiadomości. Czasem żądając okupu lub głosząc manifesty atakujący robią to w sposób, który zdradza ich “background” lub pozwala na określenie innych cech z nimi związanych. Być może w treści e-maili znalazło się coś, co podpowiedziało Policji, do jakich drzwi zastukać? Analiza celów. Metoda bardzo powiązana z poprzednią — czyli odpowiedź na pytanie: co łączy wszystkie instytucje? Dlaczego akurat oprócz dużych szpitali wybrano także ten w Chrzanowie? Czy to mogłoby naprowadzić policję na sprawcę — przypomnijmy, że Policja poinformowała, iż zatrzymała osobę właśnie z Chranowa. Jak widać, nie tylko po samym e-mailu, czy też jego treści można w niektórych przypadkach ustalić tożsamość nadawcy fałszywego e-maila. Być może macie jeszcze jakieś pomysły na identyfikację żartownisia stojącego za “fejkmejlem”? Jak faktycznie zrobiła to Policja w tej sprawie? Celowo nie wyczerpaliśmy tematu… ;-) PS. Tak medialne fałszowanie e-maili w Polsce miało już miejsce — przypomnijmy jak strollowano PAP historią posłanki Kempy oraz jak studentowi udało się zatrudnić w TVP na prestiżowym stanowisku, bo podszył się pod pracownika Kancelarii Prezydenta RP, który go “polecił”… ,Piotr Konieczny