Jeden złośliwy SMS wysłany na numer karty SIM włożonej do modemu USB i atakujący może nie tylko przejąć kontrolę nad komputerem, do którego podłączony jest modem, ale również modyfikować ustawienia właściciela modemu po stronie operatora GSM, nie wspominając o podsłuchiwaniu połączeń czy całkowitym zablokowaniu karty SIM. Na szczęście nie wszystkie karty SIM i modemy są podatne na te ataki — badacze szacują, że problem dotyczy co 5 karty SIM i 90% modemów USB. Modemy USB są wykorzystywane nie tylko przez internautów Modemy USB, które cieszą się dużą popularnością, ponieważ umożliwiają dostęp do internetu przez sieć telefonii GSM. Ich producenci pośpiesznie implementują kolejne stadardy; 3G, HDSPA, LTE (4G)… ale — jak udowadniają badacze z Positive Technologies — nie zawsze czynią to w sposób wolny od błędów. Ale zacznijmy od początku. Badacze Sergey Gordeychik, Alexander Zaitsev, Kirill Nesterov, Alexey Osipov, Timur Yunusov, Dmitry Sklyarov, Gleb Gritsai, Dmitry Kurbatov, Sergey Puzankov i Pavel Novikov zainteresowali się modemami, ponieważ karty SIM (i generalnie łączność internetowa poprzez sieć GSM) są wykorzystywane jako element infrastruktury krytycznej. “Spinają” m.in. bankomaty i urządzenia SCADA znajdujące się w trudnodostępnych miejscach, albo — jak niedawno informowaliśmy — zapewniają łączność pomiędzy inteligentnymi skrzyżowaniami w niektórych miastach. Błędy w modemach są zresztą znane od dawna i wykorzystywane (m.in. do zdejmowania simlocków z niektórych urządzeń). W końcu modemy to nic innego jak “minikomputer” działający pod kontrolą systemu operacyjnego (zazwyczaj Linuksa lub Androida), wyposażony w odpowiednie aplikacje służące do zestawiania połączeń, odbierania SMS-ów i statystyki danych oraz kartę SIM, która sama w sobie także jest “minikomputerem” i ma swoje aplikacje (tzw. TAR-y). Co i jak testowano? Na warsztat wzięto 6 różnych modemów USB (na których zainstalowano łączenie 30 różnych wersji firmware’u — ale tylko 3 wersje okazały się odporne na ataki). Badacze zaczęli od “macania” modemu przez protokół HTTP. Część z modemów ma panel zarządzania (webaplikację) — a więc może być podatna na ataki wstrzyknięć (tj. XSS, SQLi) lub ominięcia uwierzytelnienia. Zresztą sama niewinna rozmowa z modemem też może okazać się bardzo pouczająca: Co złego można zrobić temu modemu? Kiedy rozmawiamy o atakach na modemy nie można nie przywołać klasycznego numeru działającego na wszystkich “routerach”, czyli podmiany adresów IP dla serwerów DNS… (por. Stracił 16 000 o miał dziurawy router) Charakterystycznym dla modemów GSM ataków będzie jednak podmiana numeru SMS center (to przez niego przechodzą wszystkie wiadomości SMS, a więc atakujący może je przechwytywać i podsłuchiwać) Inną ciekawostką, która poważnie może zaszkodzić modemowi jest zdalny upgrade jego firmware’u na dziurawy — wtedy atakujący uzyskuje pełną kontrolę nad urządzeniem. Ale także nad komputerem, jeśli dongle z modem zostanie przeprogramowany do funkcji klawiatury na USB (por. Każdy komputer z USB jest dziurawy), która następnie wyda polecenie restartu z zewnętrznego dysku …a dokładnie z podpiętego już do komputera modemu. Podczas bootowania oczywiście wgrywany jest bootkit: Jeśli żadne z powyższych nie wyjdzie — w złości można również zablokować urządzenie, celowo błędnie wprowadzając kody PIN i PUK. Ale to nie wszystko, bo są jeszcze karty SIM Na atakach na sam modem USB nie można poprzestać. Wymienia on bowiem dane z kolejnym “minikomputerem” jakim jest karta SIM, a ta też ma swoje (znane) problemy (por. Karty SIM podatne na ataki — pół miliarda telefonów można przejąć niewidzialnym SMS-em). Karty SIM uruchamiają TAR-y (czyli aplikacje SIM; ang. Toolkit Application Reference). Aby się z nimi komunikować należy przesyłać instrukcje zaszyfrowane kluczem karty SIM (DES) — ten jednak jest chroniony (zapisany w bezpiecznej pamięci), ale można go zbruteforce’ować. Badacze wykorzystali do tego 8 modułów ZTEX 1.15y, każdy wyposażony w 4 układy XC6SLX150, które dzięki ostatniemu boomowi na Bitcoina znacznie potaniały. (Jak informuje Grzegorz na naszym Facebooku, każdy taki układ zawiera 147443 komórki logiczne. Komórka zawiera tablicę (lookup table), przerzutnik typu D oraz multiplekser. Za 2000 EUR można nabyć moc 245 Mcrypt/s, która pozwoli złamać klucz w 3 dni i da zielone światło do rozmów z aplikacjami, a także pozwoli na instalowanie kolejnych, złośliwych. Badacze informują, że na niektórych kartach SIM znajduje się też dość specyficzny TAR, który zawieratzw. TIMSI (Temporary International Mobile Subscriber Identity) oraz klucz (Kc) — po ich odczytaniu, za pomocą odpowiednich binarnych SMS-ów można: roszyfrować ruch abonenta podszyć się pod niego (przejmować SMS-y i rozmowy kierowane do atakowanej karty SIM) lokalizować położenie geograficzne abonenta zablokować usługę poprzez błędne wprowadzenia kodów PIN (3x) i PUK (10x) Co ciekawe, powyższe ataki, jak informują badacze, obchodzą nie tylko szyfrowanie A5/1 używane w starszych generacjach sieci telefonii komórkowej, ale również nowsze standardy zaimplementowane w sieciach 3G i 4G. Zaciekawionych techniczną stroną ataku odsyłamy do nagrania wykładu badaczy z konferencji 31C3. Wykład ten, wedle wpisu badaczy na ich blogu zawiera szczegóły podatności. Noworoczne zadanie: wywnioskować z wykładu, które modele modemów są podatne na opisywane przez badaczy ataki? Korzystam z modemu USB — co robić, jak żyć? Oczywiście najprościej nie wtykać w swoje porty USB podejrzanych urządzeń… ale przecież każdy użytkownik modemu USB musi mu ufać. Aby zminimalizować ryzyko ataku, warto więc modemów USB używać tylko z dedykowanymi kartami SIM (służącymi jedynie do łączności z siecią, a nie do rozmów przez telefon — unikajcie przekładania swoich podstawowych kart do modemów USB). Od strony samego komputera warto wyłączyć mu możliwość bootowania z “sieci” albo “zewnętrznego nośnika” oraz zadbać o to, aby połączenia do serwisów internetowych wykonywać po HTTPS (lub przez VPN) — wtedy widziany przez atakującego ruch dalej będzie zaszyfrowany na wyższej warstwie modelu OSI. Warto też zaznaczyć, że aby podgrupa ataków dotyczących karty SIM doszła do skutku, sieć GSM musi dopuszczać przekazywanie SMS-ów binarnych, a wasza karta SIM musi być tą, która nie chroni TAR-ów, a same TAR-y znajdujące się na karcie SIM muszą pozwalać na wykonywanie komend systemowych. Jak widać, najwięcej zależy od sieci GSM i jej konfiguracji, na co wpływu nie macie. Badacze podnoszą, że co piąta karta SIM na świecie jest podatna na taki (tj. spełnia ww. wymogi). ,vi.curry