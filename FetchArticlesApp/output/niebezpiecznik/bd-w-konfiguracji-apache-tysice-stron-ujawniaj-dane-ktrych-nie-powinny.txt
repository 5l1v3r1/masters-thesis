Jedna z firm zajmujących się bezpieczeństwem “odgrzała kotleta” i opublikowała wyniki badania 10 milionów stron pod katem udostępniania informacji przez mod_status na serwerach Apache. Pomimo tego, że problem ten znany jest od lat, okazuje się że dalej wiele webserverów ujawnia poufne dane. “Dziura” stara jak świat Na początek zacznijmy od tego, co powtarzamy na naszych szkoleniach dla programistów — bezpieczeństwo webaplikacji to nie tylko bezpieczeństwo jej kodu (brak podatności typu SQLi, XSS, itp.) ale również bezpieczeństwo webservera, który tę aplikację hostuje. Bardzo często atakujący w ogóle nie ogląda tych cudownych formularzy, pięknie posplatanych JavaScriptów i efekciarskich CSS-ów — webaplikację “hackuje” na niższym poziomie (modelu ISO/OSI) — poprzez błędy w webserverze. Jednym z takich błędów konfiguracyjnych może być niekiedy udostępnienie światu popularnego server-status — czyli strony dającej administratorowi webservera informacje o: statusach żądań HTTP adresach IP klientów liczbie aktywnych procesów Jak się domyślacie, możliwy jest nie tylko “wyciek” IP internautów korzystających z danego webservera, ale również treści żądań — niektóre z nich mogą zdradzić adresy zasobów znajdujących się w tzw. “głębokim ukryciu” (np. ścieżki do paneli administracyjnych) lub ujawnić zmienne, które przesyłają poufne dane (tokeny, klucze, etc.). Czegokolwiek by jednak podstrona server-status nie ujawniła, to źródłem błędu nie jest ona sama, ale niechlujnie napisana webaplikacja (jak można nie zabezpieczyć dostępu do panelu administracjnego?!). Warto wspomnieć, że ten “problem konfiguracyjny” należy tak naprawdę do kategorii “low hanging fruits” bo z reguły odnajduje się go w pierwszych kilku minutach testu penetracyjnego (większość “automatów” sprawdza, czy serwer udostępnia server-status). Skoro problem występuje od lat i jest tak łatwy do znalezienia, to skąd nagłe światowe zainteresowanie server-statusem? Ponieważ firma Sucuri postanowiła przebadać 10 milionów stron internetowych pod kątem udostępniania server statusu (i odnaleźli 2 072 strony z włączonym server statusem). Chwalą się, że znaleźli kilka dużych znanych firm, które mają włączony server-status — szkoda tylko, że nie wspominają, iż informacje udostępniane na stronie server-status nie zawsze zawierają adresy IP, czy też treści żądań… Oraz, że często widok server-status jest limitowany do lokalnych adresów IP, a dostęp do niego następuje na skutek błędnej konfiguracji serwera proxy stojącego przed webserverem (żądania są widoczne jako “lokalne). No ale dobry PR wymaga siania niepewności i odrobiny grozy ;-) Na marginesie, wśród TOP 100 000 stron wg Alexa 1 774 mają włączony server-status (ale tylko 7 zawiera w logach loginy i hasła) Jak znaleźć serwery udostępniające server-status? Sposobów jest kilka. Można próbować przez Google: site:pl inurl:”server-status” intext:”Apache Server Status” Można też wykorzystać URLfind.org. Czy mój serwer jest podatny? Ponieważ powyższe metody nie zawsze są w stanie wyświetlić wszystkie webservery z server-statusem, sprawdźcie ręcznie, czy taka ścieżka jest na waszym serwerze (po prostu dopisując do domeny /server-status/). Pamiętajcie żeby sprawdzić nie tylko protokół HTTP ale i HTTPS. Jeśli ukaże wam się strona z informacjami na temat webservera, to albo wyłączcie mod_status lub ograniczcie do niego dostęp, albo po prostu przekonfigurujcie go tak, aby nie udostępniał części informacji. ,Piotr Konieczny