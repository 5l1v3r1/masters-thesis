Samy Kamar udostępnił instrukcje pozwalające zmienić ogólnodostępnego na rynku drona (Parrot AR.Drone) w maszynę, która wyszukuje i przechwytuje kontrolę nad innymi dronami, atakując ich kanał komunikacyjny (zwykła sieci Wi-Fi). Z tego pomysłu chyba nie ucieszy się Amazon, który niedawno ogłosił, że zamierza niebawem wprowadzić drony do dostarczania przesyłek… Z czego składa się SkyJack SkyJack to łatwodostępny na rynku dron dla hobbystów, o nazwie Parrot AR.Drone 2.0 (koszt ok. 1000 PLN), kontrolowany poprzez aplikację na Androida lub iOS przy pomocy sieci Wi-Fi. Samy dorzucił do niego Raspberry Pi i dwie karty Wi-Fi: Alfa AWUS036H z zewnętrzną anteną oraz Edimax EW-7811Un. Wszystko jest zasilane z 1000mAh baterii przez USB i kontrolowane poprzez odpowiedni skrypt napisany w Perlu o nazwie SkyJack. Karta Alfa, z racji możliwości pracy w monitor mode jest używana do nasłuchu i wstrzykiwania pakietów w komunikację innych sieci Wi-Fi (bez konieczności asocjacji). Dzięki niej, SkyJack może wykrywać inne drony — a raczej ich komunikację, poprzez analizę prefiksów adresów MAC (w końcu pierwsza połowa adresu MAC, czyli OUI 00:12:1C, ujawnia producenta Parrotów). Jak SkyJack przejmuje inne drony? SkyJack, po wykryciu drona-ofiary korzysta ze znanego narzędzia służącego do ataków na sieci Wi-Fi o nazwie Aircrack-ng. Przy jego pomocy (a dokładnie przy pomocy aireplay-ng -0) SkyJack przeprowadza atak deauth, który zrywa asocjację innych klientów (tzn. dronów – “ofiar”) z siecią Wi-Fi służącą do ich kontroli. Kiedy dron straci komunikację z kontrolującą go siecią, mogą nastąpić — w zależności od modelu i logiki drona — różne akcje. Próba wylądowania, próba powrotu do punktu startu (o ile dron został wyposażony w moduł GPS) lub “zawiśnięcie” w miejscu i oczekiwanie na wznowienie połączenia. SkyJack jednak nie tylko odłącza ofiarę od macierzystej sieci, ale idzie krok dalej. Podszywa się pod oryginalnego operatora i wysyła własne komendy do przejętego drona przy pomocy pakietu node-ar-drone, czyli open-source’owej biblioteki implementującej standardy komunikacyjne drona AR Parrot. Dlaczego atak jest możliwy i jak się przed nim zabezpieczyć? Bolesna prawda jest taka, SkyJack działa, bo drony, które jest w stanie porwać, czyli Parroty, korzystają z nieszyfrowanej sieci Wi-Fi do komunikacji. Inne modele dronów nie będą już tak łatwym celem (o ile dalej niektóre z nich korzystają nieszyfrowanych połączeń radiowych, to protokół, którym się komunikują nie jest już udokumentowany. Oczywiście security by obscurity nie jest dobrą ochroną, ale mimo wszystko jest to przeszkoda). Brak szyfrowania transmisji w lotnictwie to zresztą nie nowość — z pasażerskich samolotów można wykradać numery kart kredytowych, które są transmitowane do kontrolerów lotu przy pomocy nieszyfrowanego protokołu ACARS. Dodatkowo, SkyJack w obecnej wersji nie podejmie wrogich działań, jeśli MAC ofiary nie należy do Parrota. Dlatego jeśli posiadacie tego drona, na wszelki wypadek warto zmienić mu MAC adres :-) PS. Warto podkreślić, że drony można przejmować nie tylko z powietrza. Wystarczy sam Linuks z zainstalowanym oprogramowaniem SkyJack. PPS. Samy nie jest też pierwszą osobą, która wpadła na taki pomysł. Oto wideo sprzed 8 miesięcy, ukazujące ataki ARP i klonowanie MAC jako metodę na przejęcie obcego drona: Dokładnie rok temu podczas imprezy o nazwie DroneGames zaprezentowano złośliwego drona, który infekował inne drony… złośliwym oprogramowaniem (kod ataku: virus-copter). Dron łączy się na porcie 23 z innymi dronami i wgrywa na nie pliki JavaScriptowe, które służą do wyszukiwania innych dronów i klonowania złośliwego kodu. Znów jest to możliwe bo drony AR korzystają z sieci Wi-Fi ad-hoc bez szyfrowania i udostępniają shell bez uwierzytelnienia na porcie 23 oraz pozwalają się kontrolować przez pakiety UDP na porcie 5556. ,Piotr Konieczny