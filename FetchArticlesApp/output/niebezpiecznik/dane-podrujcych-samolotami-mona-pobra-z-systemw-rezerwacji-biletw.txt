Jeśli podróżujecie samolotami, to wiecie, że aby sprawdzić szczegóły swojej rezerwacji, trzeba podać specjalny kod i nazwisko. Te dane wcale nie są trudne do zdobycia przez osoby postronne, a uzyskanie dostępu do rezerwacji danego pasażera jest łatwe, może zostać zautomatyzowane, nie wymaga hasła i można na tym nieźle zarobić lub — latać za darmo (tzn. na czyjś koszt). Problem z GDS-ami Systemy GDS (Global Distribution System) umożliwiają zautomatyzowane transakcje pomiędzy dostawcami usług dla podróżnych (tj. liniami lotniczymi, hotelami i wypożyczalniami aut) a przedsiębiorstwami turystycznymi. Zazwyczaj te przedsiębiorstwa korzystają z GDS by zapewnić odpowiednie usługi dla klienta końcowego. Przykładowym GDS jest Amadeus — system rezerwacji będący własnością firmy Amadeus IT z Madrytu. Korzystają z niego m.in. Polskie Linie Lotnicze LOT. Inne duże systemy tego typu to SABRE i Travelport. Zdaniem Security Research Labs wspomniane trzy systemy cechuje przestarzałe podejście do bezpieczeństwa pomimo, że zostały one połączone z usługami webowymi. Jednym z niedociągnięć jest słabe uwierzytelnianie. Co może pójść nie tak? Wspomniany “uwierzytelniacz” jest drukowany na kartach pokładowych i oznaczeniach bagażu. Można te dane utrwalić robiąc zdjęcia. Następnie można wykorzystać kod, by uzyskać dostęp do danych osobowych, danych kontaktowych i adresowych podróżnego przez stronę GDS (taką jak np. CheckMyTrip czy Travelport) lub stronę danej linii lotniczej. Serwisy dające dostęp do GDS, w tym serwisy linii lotniczych, umożliwiają wpisywanie tysięcy kodów z jednego adresu IP. Oznacza to możliwość pozyskiwania danych pasażerów o popularnych nazwiskach metodą brute-force, która jest tu uproszczona w stosunku do tradycyjnego łamania haseł (numery rezerwacji przez niektóre z GDS-ów są nadawane kolejno, mają też ograniczony zestaw znaków). Zdaniem badaczy, otwiera to drogę nie tylko do naruszania prywatności podróżnych — możliwa jest także: kradzież lotów (tzn. podróżowanie za darmo, po wcześniejszym anulowaniu komuś lotu w zamian za voucher), zdobywanie kolejnych mil bez odbywania lotów (poprzez podmianę numeru karty w rezerwacji) ataki phishingowe (z wykorzystaniem socjotechnik i danych osobowych pasażera wyciągniętych z GDS). Firma Amadeus w wypowiedzi dla Reuters już oświadczyła, że przygląda się ustaleniom SR Labs. Ich zdaniem strona CheckMyTrip jest zabezpieczona przed atakiem ze strony robota. Przedstawiciele SABRE stwierdzili, że “mają wiele warstw bezpieczeństwa” i nie będą o nich dyskutować gdyż to szkodziłoby to bezpieczeństwu. Travelport natomiast nie skomentował sprawy. SR Labs radzi, by GDS-y stosowały na swoich stronach możliwość sprawdzenia rezerwacji po podaniu hasła. Strona powinna też ograniczać liczbę sprawdzeń z danego adresu IP oraz używać mechanizmu CAPTCHA utrudniającego pracę ewentualnym scraperom danych pasażerów. Ale problemy techniczne to nie wszystko — GDS-y mają też problemy na warstwie “logicznej”. Okazuje się, że w GDS-ach brak jest granularnej kontroli uprawnień: pracownicy GDS-ów mają dostęp do wszystkich rezerwacji, pracownicy poszczególnych biur podróży do wszystkich rezerwacji skojarzonych z danym biurem, a pracownicy linii lotniczych do wszystkich rezerwacji dotyczącej danej linii. Dodatkowo, numery rezerwacji i nazwiska pasażerów każdy może pozyskać “offline”. Przyjrzyjcie się nalepkom na bagaże lub zdjęciom na instagramie otagowanym jako “lot”, “wakacje”, “lotnisko”, “samolot”, boardingpass, itp. Na wielu z nich znajdziecie uwiecznione zdjęcia kart pokładowych albo nalepek na bagaże, które zwierają i nazwisko pasażera i numer rezerwacji z GDS. Na tej podstawie można pozyskać dodatkowe informacje o “ofierze” i wykorzystać to do ataków spear-phishingowych — jeden z przykładów takiego ataku zaprezentowaliśmy rok temu w naszym “Januszowym” cyklu. Jeśli kogoś z Was interesuje ten temat, badacze wygłosili ciekawą prelekcję na konferencji CCC. Do pobrania są też slajdy. Ciekawe informacje w temacie znajdziecie też w tym artykule Inne lotnicze problemy W Niebezpieczniku kilka miesięcy temu pisaliśmy o hackowaniu kart pokładowych. Polski ekspert Przemek Jaroszewski znalazł sposób na oszukanie bramek broniących dostępu do saloników VIP linii lotniczych i powiadomił o tym linie, ale te niespecjalnie się przejęły. Co istotne, Przemek Jaroszewski nie był pierwszym badaczem poruszającym ten problem. Linie lotnicze w ogromnym stopniu uzależniły się od pewnych systemów elektronicznych. Skoro takie systemy działają od lat i “nic się nie dzieje” to można dojść do wniosku, iż wszystko jest bezpieczne. Czy naprawdę jest? ,Marcin MajJeśli podróżujecie samolotami, to wiecie, że aby sprawdzić szczegóły swojej rezerwacji, trzeba podać specjalny kod i nazwisko. Te dane wcale nie są trudne do zdobycia przez osoby postronne, a uzyskanie dostępu do rezerwacji danego pasażera jest łatwe, może zostać zautomatyzowane, nie wymaga hasła i można na tym nieźle zarobić lub — latać za darmo (tzn. na czyjś koszt). Problem z GDS-ami Systemy GDS (Global Distribution System) umożliwiają zautomatyzowane transakcje pomiędzy dostawcami usług dla podróżnych (tj. liniami lotniczymi, hotelami i wypożyczalniami aut) a przedsiębiorstwami turystycznymi. Zazwyczaj te przedsiębiorstwa korzystają z GDS by zapewnić odpowiednie usługi dla klienta końcowego. Przykładowym GDS jest Amadeus — system rezerwacji będący własnością firmy Amadeus IT z Madrytu. Korzystają z niego m.in. Polskie Linie Lotnicze LOT. Inne duże systemy tego typu to SABRE i Travelport. Zdaniem Security Research Labs wspomniane trzy systemy cechuje przestarzałe podejście do bezpieczeństwa pomimo, że zostały one połączone z usługami webowymi. Jednym z niedociągnięć jest słabe uwierzytelnianie. Co może pójść nie tak? Wspomniany “uwierzytelniacz” jest drukowany na kartach pokładowych i oznaczeniach bagażu. Można te dane utrwalić robiąc zdjęcia. Następnie można wykorzystać kod, by uzyskać dostęp do danych osobowych, danych kontaktowych i adresowych podróżnego przez stronę GDS (taką jak np. CheckMyTrip czy Travelport) lub stronę danej linii lotniczej. Serwisy dające dostęp do GDS, w tym serwisy linii lotniczych, umożliwiają wpisywanie tysięcy kodów z jednego adresu IP. Oznacza to możliwość pozyskiwania danych pasażerów o popularnych nazwiskach metodą brute-force, która jest tu uproszczona w stosunku do tradycyjnego łamania haseł (numery rezerwacji przez niektóre z GDS-ów są nadawane kolejno, mają też ograniczony zestaw znaków). Zdaniem badaczy, otwiera to drogę nie tylko do naruszania prywatności podróżnych — możliwa jest także: kradzież lotów (tzn. podróżowanie za darmo, po wcześniejszym anulowaniu komuś lotu w zamian za voucher), zdobywanie kolejnych mil bez odbywania lotów (poprzez podmianę numeru karty w rezerwacji) ataki phishingowe (z wykorzystaniem socjotechnik i danych osobowych pasażera wyciągniętych z GDS). Firma Amadeus w wypowiedzi dla Reuters już oświadczyła, że przygląda się ustaleniom SR Labs. Ich zdaniem strona CheckMyTrip jest zabezpieczona przed atakiem ze strony robota. Przedstawiciele SABRE stwierdzili, że “mają wiele warstw bezpieczeństwa” i nie będą o nich dyskutować gdyż to szkodziłoby to bezpieczeństwu. Travelport natomiast nie skomentował sprawy. SR Labs radzi, by GDS-y stosowały na swoich stronach możliwość sprawdzenia rezerwacji po podaniu hasła. Strona powinna też ograniczać liczbę sprawdzeń z danego adresu IP oraz używać mechanizmu CAPTCHA utrudniającego pracę ewentualnym scraperom danych pasażerów. Ale problemy techniczne to nie wszystko — GDS-y mają też problemy na warstwie “logicznej”. Okazuje się, że w GDS-ach brak jest granularnej kontroli uprawnień: pracownicy GDS-ów mają dostęp do wszystkich rezerwacji, pracownicy poszczególnych biur podróży do wszystkich rezerwacji skojarzonych z danym biurem, a pracownicy linii lotniczych do wszystkich rezerwacji dotyczącej danej linii. Dodatkowo, numery rezerwacji i nazwiska pasażerów każdy może pozyskać “offline”. Przyjrzyjcie się nalepkom na bagaże lub zdjęciom na instagramie otagowanym jako “lot”, “wakacje”, “lotnisko”, “samolot”, boardingpass, itp. Na wielu z nich znajdziecie uwiecznione zdjęcia kart pokładowych albo nalepek na bagaże, które zwierają i nazwisko pasażera i numer rezerwacji z GDS. Na tej podstawie można pozyskać dodatkowe informacje o “ofierze” i wykorzystać to do ataków spear-phishingowych — jeden z przykładów takiego ataku zaprezentowaliśmy rok temu w naszym “Januszowym” cyklu. Jeśli kogoś z Was interesuje ten temat, badacze wygłosili ciekawą prelekcję na konferencji CCC. Do pobrania są też slajdy. Ciekawe informacje w temacie znajdziecie też w tym artykule Inne lotnicze problemy W Niebezpieczniku kilka miesięcy temu pisaliśmy o hackowaniu kart pokładowych. Polski ekspert Przemek Jaroszewski znalazł sposób na oszukanie bramek broniących dostępu do saloników VIP linii lotniczych i powiadomił o tym linie, ale te niespecjalnie się przejęły. Co istotne, Przemek Jaroszewski nie był pierwszym badaczem poruszającym ten problem. Linie lotnicze w ogromnym stopniu uzależniły się od pewnych systemów elektronicznych. Skoro takie systemy działają od lat i “nic się nie dzieje” to można dojść do wniosku, iż wszystko jest bezpieczne. Czy naprawdę jest? ,Marcin Maj