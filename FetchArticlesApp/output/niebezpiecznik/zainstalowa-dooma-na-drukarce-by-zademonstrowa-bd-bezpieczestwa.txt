Na konferencji 44CON jeden z hackerów, Jordon, pokazał jak wykorzystać błędy w webinterfejsie drukarki Canona (Pixma MG6450) do instalacji kultowej strzelanki — Dooma. Choć wyświetlacz na drukarce jest mały, gra jest w pełni funkcjonalna. Drukarki: dużo ciekawych i łatwodostępnych informacji Sieciowe drukarki to bardzo wdzięczny temat pod kątem bezpieczeństwa. W trakcie testów penetracyjnych sieci wewnętrznych (a czasem i tzw. “styku z internetem”) są dość łatwym celem dla pentesterów — zazwyczaj podobnie jak w przypadku domowych routerów, nikt nie aktualizuje ich firmware’u, który zresztą rzadko kiedy pisany przez programistów świadomych ataków sieciowych i aplikacyjnych. Jeśli dodatkowo uświadomimy sobie, że na dyskach twardych drukarek (tak, tak, drukarki i kserokopiarki mają dyski twarde) składowanych może być wiele firmowych tajemnic, od objętych klauzulami poufności kontraktów po …skany pośladków pracowników, to warto zadać sobie trochę trudu, aby dostęp do drukarki odpowiednio zabezpieczyć (i wziąć pod uwagę także jej okolicę, bo znane są zdalne ataki podsłuchiwania wydruków mikrofonem — w praktyce zresztą zaprezentowało to NSA, por. Jak NSA podsłuchuje faksy dyplomatów). Błędy bezpieczeństwa w drukarkach Canon Chociaż poniższy opis dotyczy błędów w konkretnym modelu drukarki Canona, to część z nich znajduje się także w drukarkach innych producentów. Zachęcamy czytelników do testów i opisywania wrażeń w komentarzach Pierwszy z problemów jest powszechny — dostęp do drukarki nie wymaga uwierzytelnienia. Atakujący może drukować testowe strony do wyczerpania tuszu lub papieru. Drugi z problemów jest ciekawszy — Jordan odkrył, że drukarkę można zmusić, do tego, aby zaakceptowała dowolne oprogramowanie jako swój firmware. Przestawiając ustawienia serwera proxy na dukarce drukarki i jej DNS-ów, można sprawić, że zamiast na serwery producenta, po firmware drukarka “zastuka” na serwer atakującego. Stąd jest już całkiem prosta droga do podmiany fimware’u na własny, choć trzeba jeszcze złamać bardzo słaby algorytm szyfrowania (szczególy na blogu Jordana)… Na marginesie, model drukarki zaatakowany przez Jordana ma 32 bitowy procesor ARM i 10MB pamięci. Jordanowi przepisanie Dooma na tę architekturę zajęło wiele miesięcy… Video prezentujące efekt końcowy dostępne jest tutaj. Doom to dopiero początek zagłady… Wgranie Dooma, jak się zapewne domyślacie, to nie jedyne zagrożenie. Zamiast gry, atakujący mógłby przygotować firmware, który funkcjonalnością nie różni się od oryginalnego, ale dodatkowo “w tle” wysyła drukowane dokumenty na zewnętrzny serwer złodzieja i generalnie pełni funkcję klasycznego trojana (na marginesie, backdoory na drukarkach to nic nowego — jeden był obecny w drukarkach Samsunga). Błąd został zgłoszony do Canona w marcu i jest już gotowa poprawka, która dodaje do drukarki ekran logowania. Co ciekawe, skany internetu wykazały, że obecnie wciąż ponad 2 000 podatnych na atak drukarek jest dostępnych online… A może podpalimy drukarkę? Na koniec przypomnijmy jeden z ciekawszych ataków dotyczących podmiany firmware’u na drukarkach, ale HP a nie Canona. Badacze opracowali technikę jego zdalnej podmiany na taki, który celowo rozgrzewał elementy drukarki powodując podpalenie papieru. Trzeba przyznać, że widowiskowe byłoby połączenie obu ataków (tego na Canona z Doomem i tego na HP z płonącym papierem) w jednym i tym samym firmowym print-roomie. Fragowanie na drukarce, podczas gdy inne drukarki obok płoną. Doomsday! PS. W Dooma da się też pograć na bankomacie… ,vi.curry