Odkryto podatność CSRF w rotuterach Technicolor C7200, które — jak pisze nasz czytelnik “Tomecek” — są “masowo montowane przez UPC w Polsce i na świecie”. Podatność pozwala atakującemu na rekonfigurację ustawień routera (np. zmianę reguł firewalla, udostępnienie panelu zarządzania od strony internetu, albo reset do ustawień fabrycznych), a także uzyskanie do niego nieautoryzowanego dostępu. O tym, co może zrobić atakujący dysponujący nieautoryzowanym dostępem do routera Wi-Fi pisaliśmy niedawno w tekście pt. “Stracił 16 000 PLN bo miał dziurawy router“. W przypadku Technicolorów i Thompsonów nie jest jednak tak łatwo, jak w przypadku opisywanych przez nas niedawno TP-Linków i Pentagramów — atakujący musi nakłonić do współpracy ofiarę (ale jak pokazujemy poniżej, niekiedy jest to bardzo proste — wystarczy, że ofiara wejdzie na odpowiednią stronę internetową). Najpierw jednak zobaczmy demonstrację ataku i jego skutków: W przypadku tej klasy podatności, warunkiem koniecznym wykonania udanego ataku, oprócz posiadania przez ofiarę routera Technicolor TC7200 jest jeszcze zwabienie jej na odpowiednio spreparowaną przez atakującego stronę WWW. Dodatkowo, ofiara musi posiadać aktywną sesję administracyjną na routerze (być na nim zalogowana). Prawdopodobieństwo wykonania ataku CSRF na router wydaje się być małe, ale warto zauważyć, że atakujący może z powodzeniem nakłonić ofiarę do ustanowienia sesji z routerem poprzez wysłanie spoof maila rzekomo w imieniu UPC Polska, prosząc np. o zalogowanie się na modem/router w celu sprawdzenia czy jakąś opcja jest na nim ustawiona. Oczywiście ten scenariusz jest możliwy do wykorzystania raczej w ataku ukierunkowanym, a nie masowym — należałoby bowiem znać e-mail ofiary. Niestety odkrywca błędu nie informuje o tym, czy wypuszczono już jakąś poprawkę usuwającą odnalezione przez niego błędy — na screencaście demonstrującym obrazującym atak widać, że dziurawa jest wersja firmware’u STD6.01.12, na stronie producenta nie udało nam się jednak odnaleźć żadnych informacji dot. aktualnego firmware’u. Użytkownicy tego modemu informują, że aktualizacje są tworzone przez producenta dla poszczególnych operatorów i aplikowane przez nich “wewnętrznie”. Nasi czytelnicy, którzy jednocześnie są klientami UPC Polska informują, że obecnie wykorzystywane są co najmniej 2 wersje oprogramowania w routerach Technicolora. Niektórzy z nich mają firmware w wersji STD6.01.27 (a więc nowszej niż testowana przez znalazcę błędu). Wersja ta wygląda na niepodatną na atak CSRF z racji wbudowanego tokenu anty-CSRF-owegom, co ujawniają przesłane przez naszych czytelników pliki HTML panelu zarządzania — ale jeden z komentujących twierdzi, że o ile wbudowano mechanizm ochronny, to został on źle zaimplementowany i atak dalej jest możliwy). Niestety są też tacy klienci UPC Polska, którzy wciąż posiadają wersję STD6.01.12, czyli tę, która na pewno jest dziurawa…. Mam Technicolor TC 7200 od UPC, czy jestem podatny na ten atak? Sprawdź, którą wersję firmware’u ma twój modem. Jeśli twoja wersja to STD6.01.12 — jesteś podatny na atak. Ale nie wpadaj w panikę! Możesz zaktualizować oprogramowanie routera — instrukcja poniżej. Mam stary, dziurawy firmware, jak go zaktualizować? Jak informuje nas anonimowy pracownik UPC Polska, na modemach Technicolor TC7200, To powinno pomóc, chociaż jak informują niektórzy czytelnicy będący klientami UPC Polska, czasami nawet po wielokrotnym restarcie upgrade nie następuje. Przyczyn nie znamy. Na koniec warto podać ogólną metodę ochrony przed tą klasą podatności, ponieważ na CSRF podatne mogą być także inne routery. A jest nią przeprowadzanie rekonfiguracji routera tylko za pomocą osobnej przeglądarki (lub trybu incognito/prywatnego). Wtedy mamy pewność, że sesja administracyjna do routera zostanie “zniszczona” wraz z zamknięciem tej przeglądarki. A przypomnijmy, bez takiej sesji, nawet jeśli ofiara wejdzie na podstawioną przez atakującego stronę, to nic się nie stanie. PS. W Technicolor 7200 znajdują się też podatności XSS. Aktualiacja 16:04, 12.02.2014 Jeden z czytelników infomruje, że ta sama podatność znajduje się także w routerze Thomson TWG870U (soft ma wersję STBA.01.75 (TWG870U-BA.01.75-130605-F-1C1.bin) ,vi.curry