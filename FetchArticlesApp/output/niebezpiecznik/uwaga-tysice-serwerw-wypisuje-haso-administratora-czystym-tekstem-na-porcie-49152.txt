Jeśli twój serwer ma płytę główną produkcji Supermicro, to jak najszybciej sprawdź, czy na porcie 49152 nie zobaczysz swojego hasła. Jeśli tak, pora na szybki upgrade. Hasło administratora widoczne na porcie 49152 Za ten błąd odpowiada BMC (baseboard management controller), moduł na płycie głównej pozwalający administratorom poprzez protokół IPMI monitorować stan fizyczny serwerów (m.in. temperaturę, wydajność dysku i pamięci, prędkość wiatraczków) i zarządzać nimi (np. restartować, adresować interfejs sieciowy, zmieniać ustawienia BIOS-u). BMC przechowuje login i hasło administratora czystym tekstem — i co gorsza, aby je wydobyć wystarczy zwykłe połączenie na port 49152: nc 49152 GET /PSBlock Serwer musi jednak posiadać włączoną obsługę UPnP i IPMI na publicznie dostępnym interfejsie. Jeśli wierzyć wynikom wyszukiwarki Shodan, to wciąż ok. 32 000 adresów IP jest podatnych na ten atak (z 9 867 259, które w ogóle obsługują IPMI na interfejsie od strony internetu). Zachary Wikholm przeprowadził analizę ich haseł i poinformował, że aż 10% z nich korzysta z …domyślnych danych logowania. To nie jest hasło roota, ale… Hasło do BMC nie jest hasłem roota, czy też administratora systemu opracyjnego pod kontrolą którego pracuje serwer obsługujący IPMI (no chyba, że administrator postanowił w obu miejscach ustawić to samo hasło…) — wciąż jednak dostęp do serwera po IPMI pozwala na wiele więcej niż tylko zwykły odczyt parametrów pracy serwera. Moduły BMC w maszynach Della (DRAC), Cisco UCS (CIMC), czy HP (iLO) umożliwiają np. skorzystanie z interfejsu webowego który z kolei odpala aplet Javy dający konsolowy dostęp do systemu operacyjnego. Maszynę można też przez BMC zabootować z własnego ISO (a stąd już prosta droga do “zrootowania” maszyny). Dodatkowo, atakujący może po prostu przeflashować samą kartę IPMI i schować w niej rootkita, którzy przetrwa reinstalację systemu operacyjnego na serwerze, na co zwraca uwagę HD Moore w obszernym poradniku “hackowania” IPMI przeznaczonym dla pentesterów. (Na marginesie, dostępne są też świetne narzędzia do interakcji z firmwarem kart IPMI). Problem z IPMI znany od kilku miesięcy Co ciekawe, patch jest już dostępny, ponieważ po raz pierwszy ten problem zauważono i obszernie zanalizowano 10 miesięcy temu. Patch wymaga jednak przeflashowania płyty głównej, co może być dość ciężkim zadaniem dla serwerów działających na produkcji i wymagających ciągłej pracy — i zapewne dlatego wciąż dziesiątki tysięcy serwerów radośnie dzielą się ze światem swoim hasłem administratora IPMI. Zamiast udostępniać IPMI poprzez internet, można rozważyć użycie dedykowanego portu sieciowego na którym działa dedykowany vlan, odpowiednio firewallowany lub dostępny poprzez VPN. ,vi.curry