Billy Rios, badacz bezpieczeństwa, usłyszał od swojego kolegi, pracownika stacji benzynowej, że po awarii automatycznej myjni samochodowej serwisant naprawił ją zdalnie, przez internet. Jak się zapewne domyślacie, Rios nie potrzebował więcej zachęt i ruszył do wyszukiwania adresów IP myjni w sieci. Przy okazji w oprogramowaniu myjni odkrył kilka błędów, które pozwalają na uszkodzenie samochodu podczas mycia. Mordercza myjnia Jeśli należycie do tej grupy osób, która odczuwa strach przed wjazdem do automatycznej myjni, to teraz możecie świecić triumfy. Okazuje się, że niektóre z automatycznych myjni pracują pod kontrolą Windowsa CE (na architekturze ARM) i można je kontrolować przez webinterfejs. Co więcej, jak się okazuje, dość powszechną praktyką jest podpinanie myjni do internetu… (m.in. po to, aby ułatwić serwisowanie). Webinterfejs myjni został na szczęście zabezpieczony hasłem. Billiemu nie udało się co prawda znaleźć podatności, która pomogłaby obejść wymóg uwierzytelnienia i uzyskać nieautoryzowany dostęp do sterowania myjnią …ale “odgadł” domyślne hasło. Ponoć nie było ono skomplikowane i choć Rios go nie ujawnia, to artykuł na Threatpost wspomina, że jest “pięcioznakowe”. (12345, admin?) Po uzyskaniu dostępu do webinterfejsu, okazało się, że pozwala na wywołanie kilku ciekawych opcji — niestety część z nich może uszkodzić samochód, ale na szczęście nie chodzi tu o “zasuszenie go na śmierć” :-) wyłączenie czujników zbliżeniowych na drzwiach wjazdowych i wyjazdowych do myjni (może w niektórych przypadkach powodować “przytrzaśnięcie” samochodu lub pasażera modyfikacja nastawień szczotek (zwłaszcza na błędną, co pokazuje przypadek na stacji kolegi Riosa, może spowodować uszkodzenie samochodu podczas mycia) zmiana planu mycia (darmowy upgrade!) Komendy wysyłane są do urządzeń myjni za pomocą przemysłowego protokołu Modbus (polecenia można wydawać przez webinterfejs albo …telnet). Jak się okazało, w oprogramowaniu pełno jest podatności typu SQL injection, command injection i buffer overflow — choć trzeba uczciwie przyznać, że mają one raczej małe znaczenie, gdyż dostęp do oprogramowania myjni zgodnie z założeniami mają mieć tylko i wyłącznie zaufane osoby; a te z kolei i bez tricków w stylu SQL injection mogą wydać myjni dowolne polecenie. Odnalezione przez Riosa podatności dotyczą myjni “PDQ LaserWash” (czy ktoś namierzył takie myjnie w Polsce?) ale zapewne inni producenci mogą postępować w podobny sposób. Obstawiamy, że wyszukiwarką Shodan można łatwo odnaleźć także inne myjnie w internecie. Nie wpadajcie w panikę Nie należy jednak wpadać w panikę podczas kolejnej wizyty w myjni. Każda z nich wyposażona jest w przycisk awaryjnego zatrzymania. Ale oczywiście, żeby go nacisnąć, należy — zgodnie z instrukcją — oczekiwać końca mycia poza myjnią, a nie siedząc w samochodzie… Dodatkowo, część ze znanych nam myjni automatycznych obecnych w Polsce posiada sprzętowe czujniki zbliżeniowe, które nawet w przypadku błędnej kalibracji, podczas zetknięcia z powierzchnią samochodu od razu zatrzymają pracę myjni. Problemem domyślne hasło Podsumowując rewelacje Riosa — nie ma się co dziwić, że oprogramowanie myjni pozwala na jej “wysterowanie”. Od tego jest. Jedyny błąd jaki popełnili twórcy, to brak wymuszenia zmiany domyślnego hasła i ewentualnej ochrony przed atakami jego automatycznego odgadywania. Ciężko wywnioskować, kto wpadł na pomysł podpinania myjni do internetu (czy robi to producenty, czy może takiej konfiguracji dopuściła się — dla wygody — stacja benzynowa). Ponieważ jednak Riosowi udało się odkryć kilka myjni w internecie, przypadek nie należy traktować jako odosobnionego. Ciężko jest nam zrozumieć, dlaczego myjnie (albo zbiorniki z paliwem) muszą być dostępne na publicznym adresie IP. Oczywiście dostęp do webserwera jest wymagany m.in. przez pracowników stacji benzynowej (zarządza on nie tylko technicznymi aspektami myjni, ale również nadzoruje sprzedaż), ale można go zapewnić w sposób bezpieczny — ograniczając go tylko do sieci lokalnej. Inne metody “ataków” na myjnie Poza atakowaniem myjni z internetu, można je także hackować bezpośrednio. Pewna sieć obecnych w Polsce zagranicznych stacji benzynowych udostępniająca możliwość skorzystania z myjni automatycznych poprzez wpisanie odpowiedniego kodu. Myjnie ma jednak tak skonfigurowane, że akceptują one kod tzw. “testowego mycia”. Testowe mycie nic nie kosztuje, a myje tak samo dobrze — dajemy na to naszą osobistą gwarancję :) Kolejnym z pomysłów (choć tego akurat nie testowaliśmy osobiście) jest analiza zapisu informacji na pasku magnetycznym (lub chipie RFID) w innych z obecnych w Polsce sieci stacji benzynowych oraz myjni bezdotykowych niekoniecznie zlokalizowanych przy stacjach benzynowych. Być może karty te da się “sklonować”? (hint: SLE4442, HitTag2) PS. Jeśli nie wykonujecie testów bezpieczeństwa myjni, to nie zachęcamy do ww. prób. Raz, że myjnie są monitorowane, a dwa, że nieautoryzowane testy penetracyjne to przestępstwo. ,igH