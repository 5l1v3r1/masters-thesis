Znany czytelnikom Niebezpiecznika z testowania sieci GSM pod kątem podatności na ataki teleinformatyczne Karsten Nohl tym razem wziął na tapetę karty SIM. Wynik? Pół miliarda telefonów na świecie może być “zhackowanych” zdalnie, jednym, “niewidzialnym” SMS-em… Karta SIM Aby lepiej zrozumieć na czym polega atak Nohla, warto przybliżyć nieco zasadę działania i budowę karty SIM, która de facto jest minikomputerem; osobnym środowiskiem z własnym systemem operacyjnym, zasilanym z baterii telefonu. Całe środowisko określa się mianem Java Card — na na kartę (a dokładnie “smartcard“) pisze się oprogramowanie (tzw. aplety) właśnie na platformie Java Card. Aplety są przenośne pomiędzy różnymi kartami (jest na nich to samo środowisko — JCVM), chociaż cechy fizyczne karty (dostępna pamięć, wykorzystywane algorytmy szyfrowania) mogą uniemożliwić działanie apletu na niektórych kartach. Co ważne, aplety uruchamiane na karcie są sandboksowane. Kiedy operatorzy chcą zaktualizować któryś z apletów na naszej karcie SIM, robią to wysyłając do nas specjalnego, binarnego i co ważniejsze — niewidzialnego — SMS-a. SMS jest wysyłany zgodnie z protokołem OTA (over-the-air) i jest kryptograficznie podpisywany przez operatora. Na czym polega atak na kartę SIM? Nohl zauważył, że wysyłając zgodnie z OTA komendy (SMS-y) do karty SIM, niektóre z nich będą odpowiadały błędem, ponieważ otrzymana komenda nie była podpisana poprawnym kluczem operatora. Co ciekawe, karta generując komunikat z błędem podpisywała go z kolei swoim unikatowym kluczem — to pozwoliło Nohlowi złamać klucz karty (w ok. minutę) przy wykorzystaniu tzw. tablic tęczowych. Problem, który odkrył Nohl wynika z zastosowania przez niektóre z kart SIM przestarzałego i podatnego na ataki szyfrowania 56-bitowym DES-em (tak, tym z lat 70-tych, złamanym w 1998 roku). Co można zrobić z kartą SIM? Mając klucz karty SIM można: kontrolować aplikacje operatora zainstalowane na karcie (np. wgrywać złośliwe aplety) wykonywać akcje w imieniu “zhackowanej” karty (np. wysyłać SMS-y na płatne numery, obciążając rachunek niczego nieświadomego właściciela telefonu, lub przekierowywać jego rozmowy na inny numer, czyli po prostu je podsłuchiwać) śledzić lokalizację właściciela karty Ale to nie koniec. Nohl znalazł jeszcze jedną dziurę, dzięki której mógł ominąć sandboksing (restrykcję polegającą na separacji poszczególnych apletów zainstalowanych na karcie) — dzięki czemu “zrootował” kartę SIM. To otwiera możliwość do: odczytywania nieswoich plików przez złośliwy aplet (np. dostęp do danych apletów płatniczych Visy czy PayPala, które mogą być wykorzystywane przez niektórych operatorów do tzw. mobilnych płatności) wydobyć tzw. master-key karty, który pozwala na jej sklonowanie (pobranie wszystkich informacji z karty, które umożliwią wykonanie jej wiernego duplikatu — IMSI, Ki) Ochrona przed atakami …nie jest łatwa z poziomu zwykłego użytkownika. Należy liczyć na to, że ci z operatorów, którzy korzystają z kart ze słabymi algorytmami kryptograficznymi zaktualizują je do nowszych standardów. Operatorzy mogą też filtrować przesyłane przez ich sieć SMS-y protokołu OTA. Producenci kart SIM (np. Gemalto) są świadomi zagrożeń. Przynajmniej niektórzy — według Nohla przynajmniej 2 firmy pracują już nad poprawką. O szczegółach ataku Nohl chce opowiedzieć na nadchodzącej pod koniec lipca konferencji BlackHat. PS. Na koniec warto nadmienić, że na pobnej zasadzie co karty SIM działają “chipy” na kartach kredytowych oraz np. tych, które otrzymujemy wyrabiając kwalifikowany podpis elektroniczny. Problem z sandboksingiem też może ich dotyczyć… Aktualizacja 5 sierpnia 2013 Operatorzy poprawili błąd korzystając z tego samego ataku :-) ,vi.curry