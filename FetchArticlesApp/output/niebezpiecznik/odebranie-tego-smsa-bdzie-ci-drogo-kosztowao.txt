Bogdan Alecu odnalazł błąd logiczny w sposobie działania sieci GSM. Przy pomocy tego błędu możemy wysłać wybranej osobie SMS-a, który sprawi, że jej telefon sam z siebie zacznie wysyłać inne SMS-y. Automatycznie generowane SMS-y można “przekierować” na numery premium, co znacząco wpłynie na rachunek ofiary za telefon… SMS-owy atak na aplikacje z SIM Toolkit Dziura znajduje się w sposobie w jaki telefony przetwarzają specjalne SMS-y kierowane do aplikacji znajdujących się w tzw. SIM Toolkit. Karty SIM polskich operatorów także zawierają preinstalowane aplikacje tego typu: Aplikacje z SIM Toolkitu potrafią wykonywać szereg różnych akcji, w tym sprawdzać wysokość środków na koncie abonenckim, brać udział w loteriach, sprawdzać horoskopy, etc. Aby przekazać informację do aplikacji z SIM Toolkitu, należy wysłać odpowiednio spreparowanego SMS-a. Większość telefonów nie informuje użytkownika o fakcie otrzymania SMS-a tego typu. Instrukcje zawarte w SMS-ie nie są jednak ślepo wykonywane przez aplikacje z SIM Toolkitu — wszystko zależy od tego, czy w nagłówku SMS-a zawarto poprawny podpis elektroniczny. Kryptografia wykorzystywana do tego celu jest silna, i wbrew pozorom, Alecu nie znalazł sposobu na jej obejście lub złamanie — poszedł inną drogą… Na czym polega atak? Atak wykorzystuje następującą prawidłowość: jeśli do aplikacji z SIM Toolkitu wyśle się SMS-a, który zawiera błędny podpis, aplikacja generuje automatyczną odpowiedź do nadawcy z opisem błędu (tzw. SMS-a serwisowego). Wysyłka SMS-a z automatyczną odpowiedzią przez nasz telefon także nie jest widoczna, a wg testów Alecu, tylko telefony Nokii mają opcje, która pozwala użytkownikowi na podjęcie decyzji, czy aplikacje z SIM Toolkitu mogą wysyłać odpowiedzi automatycznie (“Confirm SIM Service ActionsConfirm SIM Service Actions” — uwaga, domyślnie jest ona z reguły wyłączana przez operatorów!). Na telefonach HTC, Samsunga i LG z Androidem nie udało się znaleźć opcji do zablokowania odpowiedzi tego typu. Podobnie na Blackberry. Z kolei Windows Mobile 6.x oraz iPhone informuje użytkownika, że wiadomość serwisowa jest wysyłana, ale nie pozwala na przerwanie wysyłki. Na czym polega atak? Oczywiście na przesłaniu SMS-a z podrobionym numerem nadawcy. SMS jest kierowany do aplikacji z SIM Toolkit i oczywiście nie przechodzi weryfikacji podpisu elektronicznego. Aplikacja odsyła więc nadawcy wiadomość serwisową — na jaki numer? Na ten, który “podrobił” nadawca, a który w rzeczywistości może należeć do usługi SMS Premium, która obciąży rachunek ofiary odpowiednią opłatą. Atakujący nie ma możliwości sterowania treścią serwisowego SMS-a od aplikacji z SIM Toolkitu — ale część z numerów premium nie wymaga konkretnej treści (np. słowa TAK) w zgłoszeniu subskrybcji. Ciekawym wariantem ataku jest podrobienie przez atakującego numeru należącego do centrum SMS operatora ofiary. Wtedy wiadomość serwisowa jest interpretowana przez sieć jako błąd w dostarczeniu wiadomości i kolejkowana do ponownej wysyłki. Powstaje więc pętla (operatorzy starają się dostarczyć wiadomości przez ok. 24h) i mamy atak typu DoS na telefon. Jak ustrzec się ataków tego typu? Jak informuje Register, Alecu przedstawił swoje odkrycie na konferencji DefCamp, bazując na operatorach z Rumunii, Bułgari, Austrii , Niemiec i Francji — ale ponieważ atak nie wykorzystuje podatności u konkretnego operatora, ale bład logiczny w działaniu pewnych standardów sieci GSM, najprawdopodobniej podatni są wszyscy operatorzy, którzy sprzedają karty SIM z aplikacjami SIM Toolkit. Na szczęście atakowi można łatwo zapobiec — albo poprzez filtrowanie ruchu SMS na poziomie operatorskim, albo — i to trudniejsze rozwiązanie — poprzez modyfikacje w firmware’ach telefonów tak, aby automatyczna wysyłka serwisowych SMS-ów przez aplikacje z SIM Toolkitu nie była możliwa. Można też korzystać z kart SIM które nie mają włączonej opcji “SIM point-to-point”. Na razie pozostaje przełączyć się na starą, dobrą Nokię ;) ,vi.curry