Mamy kolejny tragikomiczny błąd na miarę opisywanego przez nas wczoraj 0day’a na roota w MySQL. Otóż okazuje się, że bez specjalnego wysiłku można dostać roota w kolejnym ważnym składniku sieci — tym razem chodzi o load balancery BigIP od F5 Networks. Backdoor w BigIP od F5 Okazało się, że wszystkie BigIP od F5 mają swoistego rodzaju backdoora. Istnieje jeden, publicznie dostępny, prywatny klucz SSH, który został autoryzowany do zdalnych połączeń na każde z urządzeń BigIP i to na konto roota. Oto publiczna część tego klucza: ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAIEAvIhC5skTzxyHif/7iy3yhxuK6/OB13hjPqrskogkYFrcW8OK4VJ T+5+Fx7wd4sQCnVn8rNqahw/x6sfcOMDI/Xvn4yKU4t8TnYf2MpUVr4ndz39L5Ds1n7Si1m2suUNxWbK v58I8+NMhlt2ITraSuTU0NGymWOc8+LNi+MHXdLk= SCCP Superuser F5 już opublikowało patcha, HD Moore szacuje, że 45% wszystkich instalacji BigIP od F5 umożliwia dostęp do SSH z publicznego internetu, a więc jest podatnych na atak. I teraz najlepsze: klucz prywatny potrzebny do “przeprowadzenia” ataku znajduje w filesystemie samego BigIP F5, a więc każdy klient ma do niego dostęp (musi tylko wiedzieć, gdzie szukać). Oczywiście każdy klient ma też dostęp do dowolnego innego urządzenia BigIP F5, które zezwala na połączenia na porcie SSH ;) PS. Aby sprawdzić, czy znane wam adresy BigIP od F5 są podatne na ten atak, możecie wykorzystać moduł auxiliary/scanner/ssh/ssh_identify_pubkeys z metasploicie służący do skanowania SSH pod kątem obsługi konkretnego klucza publicznego (tu: klucz publiczny wklejony powyżej). Najpiękniejsze jest jednak to, że w większości przypadków nie będziecie w stanie stwierdzić, czy ktoś skorzystał z tego “backdoora” i spenetrował wasze urządzenie. Root bowiem może zatrzeć po sobie ślady… ,vi.curry