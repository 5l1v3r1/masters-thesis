Od momentu ogłoszenia nakazu sądowego, który wymusza na Apple stworzenie backdoora umożliwiającego FBI łatwiejszy atak na kod blokady iPhona terrorysty minęło kilka dni. Sprawa jest szeroko komentowana w mediach i pośród ekspertów ds. bezpieczeństwa, a niektóre z komentarzy (lub kontrolowanych wycieków) ujawniają bardzo ciekawe kulisy dotyczące możliwych technik ataku na iPhona. FBI ma telefon, ale nie może się do niego dobrać Przypomnijmy pokrótce jak wygląda sytuacja. FBI jest w posiadaniu iPhona 5C terrorysty (model A1532 z chipem A6 pracujący pod kontrolą systemu operacyjnego iOS 9 — gdyby był to iOS w wersji poniżej wersji 8, problemu z dostępem do danych nie byłoby żadnego). Telefon jest zablokowany, ale nie hasłem alfanumerycznym a maksymalnie 6 cyfrowym PIN-em. Ten model iPhona nie posiada czytnika linii papilarnych, więc nie można go odblokować przykładając doń palec martwego terrorysty. FBI musi więc odgadnąć PIN, ale ma tylko 10 prób, ponieważ na urządzeniu włączone jest zabezpieczenie polegające na kasowaniu danych po 10 błędnie wprowadzonych PIN-ach. Pamięć iPhona jest zaszyfrowana sprzętowym kluczem skojarzonym z tym konkretnym urządzeniem i nieznanym przez Appple, więc wykonanie tzw. chip-off (wylutowanie chipa i podpięcie do innego urządzenia) nic nie da. Apple jak najbardziej może (i tego dokładnie dotyczy nakaz) załadować do pamięci ulotnej iPhona przełączonego w tryb DFU nowy firmware, który miałby wyłączyć funkcję kasowania nośnika po 10 próbach błędnie wpisanego kodu. Problem w tym, że takiego backdoora wgrać na iPhona może tylko Apple, ponieważ oprogramowanie musi być podpisane kluczami firmy (innymi słowy FBI nie mając tych kluczy, nie może samodzielnie wykonać takiego ataku). Taki backdoor zadziała na każdym iPhonie — fakt obecności lub brak tzw. sprzętowej “enklawy bezpieczeństwa” w którą wyposażone są najnowsze iPhony nie ma żadnego znaczenia: Apple już wielokrotnie współpracowało z służbami i odblokowywało iPhony na ich żądanie, o czym informowaliśmy już 2 lata temu. Dotyczyło to jednak poprzednich modelów iPhona — od niedawna Apple robiło bowiem wszystko, żeby kontrolę nad danymi użytkowników przekazać w ich ręce (założenie tej strategii jest proste: służby nie są w stanie zmusić Apple do przekazania kluczy kryptograficznych, skoro firma ich nie ma, bo tylko użytkownicy je posiadają, na swoich iPhonach zablokowanych tak, ze blokady bez współpracy właściciela telefonu nie da się obejść) To może z racji braku współpracy Apple, FBI do tematu może podejść od drugiej strony? Przecież iPhony tworzą kopie bezpieczeństwa w chmurze Apple… Metoda 1: Odzyskanie danych metodą na iCloud Do skonfigurowania i używania chmury Apple zachęcani są użytkownicy w trakcie pierwszego uruchomienia telefonu i potem podczas wielu innych okazji (trzeba ją włączyć, aby korzystać m.in. z rozwiązania FindMyiPhone). Można więc założyć, że większość użytkowników rzeczywiście korzysta z iClouda, co nie oznacza, że wszyscy automatycznie wykonują backup do chmury: Okazuje się, że FBI już w dzień po pozyskaniu telefonu zwróciło się do jego właściciela — i tu niespodzianka, nie był nim terrorysta, a rządowa organizacja, w której pracował — o to, aby pracodawca terrorysty zresetował hasło do konta iCloud skojarzonego z telefonem. Celem tego działania miał być natychmiastowy dostęp do plików terrorysty przechowywanych w chmurze. Pośpiech służb wydaje się raczej bezzasadny. Apple posiada (i udostępniło FBI) kopię danych, jakie iPhone terrorysty wgrał do iClouda. Okazało się też, że na kilka tygodni przed zamachem, terrorysta wyłączył backup do chmury na telefonie, więc FBI nie posiadało aktualnych informacji z kopii udostępnionej przez Apple (zamach miał miejsce 2 grudnia, a w 19 października terrorysta wyłączył backupy). Nie jest to żadną niespodzianką dla regularnych czytelników Niebezpiecznika — wielokrotnie pisaliśmy, że nie tylko Apple, ale również inni dostawcy chmury, w tym Google i Dropbox, mają dostęp do danych użytkowników przechowywanych na ich serwerach, a szyfrowanie jest często iluzoryczne. Reset hasła wpadką FBI? Niekoniecznie… Wielu “ekspertów” sugeruje teraz, że FBI wymuszeniem zmiany hasła podcięło gałąź na której siedzi. Zmienionego hasła do iClouda nie zna przecież zablokowany iPhone terrorysty, a to oznacza, że nie jest on już w stanie połączyć się z chmurą Apple, która w pewnych sytuacjach miałaby móc wydać mu “polecenie” lub …odebrać kolejne dane w ramach nowej kopii bezpieczeństwa. “Eksperci” informują że wystarczyłoby, aby iPhone podłączył się do znanej mu sieci Wi-Fi — wtedy rozpocznie się wysyłanie backupu. Teraz jednak, nowego hasła nie ma jak ustawić na zablokowanym telefonie, a starego hasła nie ma jak przywrócić na iCloudzie, bo przecież służby go nie znają. Zastanawia nas jednak jak Apple miałoby wymusić backup danych z telefonu, skoro terrorysta na kilka miesięcy przed atakiem wyłączył na telefonie backup do chmury? Warto też zauważyć, że reset hasła przez FBI zapewne jest też odwracalny przez Apple — firma mogłaby bowiem sięgnąć do własnych kopii bezpieczeństwa i przywrócić pierwotny hash hasła użytkownika do jego konta iCloud, odwracając tym samym skutki zmiany hasła przez FBI i powodując, że iPhone znów mógłby się podpiąć do konta iCloud. Abstrahując od odwrócenia resetu hasła, warto zauważyć, że nawet wymuszenie backupu (o ile w ogóle możliwe) nie jest równoznaczne z pozyskaniem wszystkich danych znajdujących się na urządzeniu, więc FBI słusznie twierdzi, że backup to nie wszystko. W backupie nie będzie danych przechowywanych przez inne niż systemowe aplikacje, np. konwersacji z komunikatora Signal. No dobra, ale to i tak jest służbowa komórka, gdzie prywatny telefon terrorysty? Jeśli kogoś ciekawi czy terrorysta poza służbową, pozyskaną przez FBI komórką, posiadał także prywatny telefon, to odpowiadamy — tak, ale go zniszczył przed zamachem. Podobnie jak zniszczył dysk twardy swojego komputera. Można więc zakładać, że terrorysta był świadomy tego, gdzie przechowuje “wrażliwe” informacje i skoro oszczędził firmowy telefon, to najprawdopodobniej nie postrzegał informacji znajdujących się na nim go jako zagrożenia. Czy zatem FBI ma o co walczyć? Czy może walka jest bardziej sztuką dla sztuki (cel polityczny) niż realną potrzebą? FBI twierdzi, że do iPhona służbowego chce się dostać przede wszystkim w celu sprawdzenia z kim komunikował się terrorysta, aby zweryfikować czy nie pomagał mu ktoś ze współpracowników. Komunikacji tej nie można zobaczyć na billingach, ponieważ iPhony korzystają z protokołu iMessage, w ramach którego wiadomości są szyfrowane, a klucze do ich rozszyfrowania posiadają tylko rozmówcy. Co prawda służby mogłyby zarekwirować wszystkie iPhony współpracownikom, ale niewykluczone, że część z rozmów została już skasowana po ich stronie (albo — co bardziej prawdopodobne — terrorysta kontaktował się z kimś spoza współpracowników, kto też posiadał iPhona i miał włączone iMessage). Kolejnym argumentem za tym, że ta sprawa to “pokazówka” przemawia odrzucona przez FBI prośba Apple o utajnienie nakazu sądu. Dlaczego Apple chciało ukryć orzeczenie? Bo nie tylko sugeruje ono, że firma jest w stanie wyłączyć niektóre funkcje bezpieczeństwa swojego telefonu, ale dość precyzyjnie opisuje jak można to zrobić, co powoduje jak najbardziej słuszne zauważenie przez klientów kłamstwa Apple, że do danych klienta nikt, nawet Apple, nie może się dostać.. FBI zapewne nie zgodziło się na utajnienie orzeczenia sądu, bo służbom bardziej niż na dostępie do tego konkretnego telefonu zależy na ustanowieniu precedensu, z którego będzie można skorzystać w kolejnych sprawach. Raz stworzony backdoor będzie można dostosować do innych iPhonów, a w kolejce do odblokowania iPhonów ustawią się kolejne instytucje: Podsumowując: Zarekwirowany przez FBI iPhone nie jest prywatnym telefonem terrorysty, a komórką służbową. Telefon prywatny (zapewne ważniejszy) został zniszczony, a służbowy oszczędzony, co sugeruje że raczej nie ma na nim niczego wrażliwego FBI wymusiło na pracodawcy terrorysty reset hasła do iClouda powiązanego z iPhonem i uniemożliwiło tym samym wykonywanie kopii bezpieczeństwa z telefonu do chmury. iPhony robią je, kiedy łączą się ze znaną siecią Wi-Fi (np. tą w pracy terrorysty). Nic jednak nie wskazuje, że telefon można by zmusić do wykonania takiej kopii, skoro została wyłączona po stronie telefonu, a już na pewno sam reset hasła nie jest wyrokiem śmierci dla tej techniki — hasło do konta iCloud najprawdopodobniej można przywrócić do oryginalnego na podstawie kopii bezpieczeństwa bazy danych Apple. FBI nie może sprawdzić z kim ze współpracowników (lub innych posiadaczy iPhonów) komunikował się terrorysta, bo komunikacja to nie nieszyfrowane SMS-y a wiadomości protokołu iMessage, szyfrowane klient-klient (a więc Apple, a tym bardziej sieć GSM nie zna ich treści) Apple broniąc się przed stworzeniem backdoora zasugerowało FBI 4 metody pozyskania danych. Oto one (wraz z opisem, dlaczego nie mają szans powodzenia w tym przypadku): Metoda 2: Odzyskanie danych laserami i kwasem Skoro nie w ataku bezpośrednim i nie przez kopie bezpieczeństwa, to może kwasem i laserami? Elektronicy przyglądający się sprawie FBI vs Apple często sugerują, że klucz służący do odczytania zaszyfrowanej pamięci można wydobyć bezpośrednio z chipu poprzez odpowiednie techniki tzw. decappingu, czyli wytrawiania i obserwacji “gołego” chipu pod mikroskopem elektronowym w celu odczytu konkretnych wartości bit po bicie (por. TPM hacked!). Po zdobyciu wszystkich informacji potrzebnych do wyliczenia klucza szyfrującego dane, można by stworzyć program, który umożliwiłby dołączanie ich do algorytmu generacji klucza razem z różnymi “kodami blokady”. Ponieważ program działałby już poza iPhonem, nie ma ryzyka skasowania danych po 10 błędnych podstawieniach kodu blokady. Jest tylko jeden problem dotyczący decappingu. Z racji inwazyjności tej metody, dane mogą zostać bezpowrotnie utracone poprzez fizyczne zniekształcenie chipu. I właśnie z tego powodu raczej nikt nie zdecyduje się na to rozwiazanie. Zaproponowane przez FBI wprowadzenie backdoora przez Apple na poziomie firmware’u wydaje się więc zdecydowanie bezpieczniejszym rozwiązaniem, choć i w tym przypadku błąd programistyczny — a przypomnijmy, że taki firmware tworzony będzie po raz pierwszy — może spowodować bezpowrotną utratę danych. W sumie to dobra okazja dla “zmuszonego do działania Apple” na przeprowadzenie małego sabotażu… — w końcu FBI nie może wykonać kopii danych i cała operacja jest pracą na żywym organizmie. Jeden błąd i pacjent umiera… :-) Metoda 3: klucze parujące pozyskane z komputera Jeśli użytkownik iPhona sparował telefon z jakimś komputerem, klucze pozostawione w iTunes na tym komputerze pozwalają na odblokowanie telefonu. FBI twierdzi jednak, że iPhone nie był z niczym powiązany. I tym samym ostatnia znana na dzień dzisiejszy możliwość dostania się do iPhona bez hasła została wyczerpana. Zestawienie wszystkich możliwości dla wszystkich urządzeń Apple Ponieważ w wersjach i modelach telefonów oraz technikach, które działają na jednej parze a ale nie na drugiej można się łatwo pogubić, poniżej prezentujemy przydatne zestawienie: A tu legenda: Jak widać, poza oprogramowaniem wykorzystującym błędy w starszych wersjach iOS, przechwyceniem danych z innych miejsc, innych metod brak. Zastosowanie powyższych w szczegółach opisano tutaj oraz w poniższych artykułach: Trail of Bits – “Apple can comply with the FBI court order” DarthNull.org – “Put away the tin-foil: The Apple unlock case is complicated enough” Jonathan Zdziarski – Apple’s technical capabilities under FBI AWA order Charles Riley – All This #FBiOS Hubbub Boils Down to Just One (Technical) Thing Devon Ackerman – iOS Imaging Spreadsheet Tematykę bezpieczeństwa iOS (i Androida), nie tylko pod kątem omijania kodu blokady poruszamy także w praktyce na szkoleniach z Bezpieczeństwa Aplikacji Mobilnych i Informatyce Śledczej (techniki służb). Oba odbywają się niebawem i są już tylko ostatnie wolne miejsca. Amerykanie są po stronie FBI, a nie Apple (co innego inne korporacje) Choć w pierwszych dniach po ujawnieniu orzeczenia sądu, opór Apple popierało zarówno EFF, Google, Facebook i Twitter a nawet Huawei, to opinia publiczna, co ciekawe, stoi po stronie FBI: Także Bill Gates twierdzi, że Apple powinno odblokować iPhona dla FBI, porównując pozyskiwanie danych z telefonów użytkowników od ich producentów do pozyskiwania danych na temat ich transakcji bankowych z banków. Cierpliwość powoli traci także sam dyrektor FBI. Właśnie wydał drugie oświadczenie, w którym jeszcze raz podkreśla, że “chodzi o wyjaśnienie zamachu, w którym zginęło 14 Amerykanów, a nie precedens”: FBI stara się przedstawić tę sprawę jako ustalenie balansu pomiędzy prywatnością a bezpieczeństwem, a firmy technologiczne, jak celnie zauważa Bruce Schneier, widzą tę sprawę jako ustalenie balansu pomiędzy bezpieczeństwem a inwigilacją. Warto też podkreślić, że nie ma backdoorów, z których może korzystać tylko jedna służba (lub jeden kraj). Jeśli taki backdoor powstanie, prędzej czy później będzie dostępny dla wszystkich. Nie tylko przyjaciół FBI, ale również “wrogów”. Niewykluczone zresztą, że wrogowie już go mają. Stworzenie samego firmware’u jest do wykonania nie tylko przez inżynierów Apple’a. Problem w tym, że trzeba go podpisać kluczami Apple. Ale atakujący (zwłaszcza ci z zapleczem rządowym) już wielokrotnie nam pokazali, że potrafią wykradać klucze kryptograficzne dużych firm (por. Stuxnet oraz atak na RSA). Backdoor nie rozszyfruje a przyśpieszy rozszyfrowanie iPhona Na koniec warto zaznaczyć, że nawet jeśli Apple zostanie zmuszone i wyprodukuje backdoora, to jego jedyną zaletą będzie usunięcie 3 zabezpieczeń przed atakami zgadywania hasła blokady ekranu (wyeliminowanie opóźnień i autodestrukcji urządzenia po 10 błędnych próbach wprowadzenia kodu oraz umożliwienie wprowadzania kodów blokady inaczej niż przez ekran dotykowy) a nie jego natychmiastowe rozszyfrowanie. Innymi słowy, służby dalej będą musiały się trochę pomęczyć. Stąd prosty wniosek, że im dłuższe hasło, tym lepiej… Jeśli Apple udostępni backdoora, opóźnienie zniknie, a więc będzie można szybciej zgadywać hasła blokady ekranu, bez strachu że po 10 próbie klucz deszyfrujący zostanie zniszczony. Dlatego niezależnie od wyniku sporu FBI vs Apple, warto maksymalnie utrudnić przejęcie kontroli nad swoim iPhonem. Poniżej instrukcje: Mam iPhona — co robić, jak żyć? Do poniższych rad zastosuj się niezależnie od tego, czy boisz się służb, złośliwego kolegi z pracy, czy masz sekret przed żoną, albo po prostu cenisz swoją prywatność i chcesz się poprawnie przygotować do kontroli na lotnisku, uniemożliwiając pogranicznikom obejrzenie twoich nagich zdjęć. Korzystaj z hasła blokady ekranu a nie TouchID. Twój palec zawsze można siłowo podsunąć pod twojego iPhona, bez twojej zgody, co spowoduje odblokowanie telefonu. Pamiętaj o tym przechodząc przez lotnisko. Ustaw długi i alfanumeryczny kod blokady ekranu. Domyślne 6 cyfr to za mało. Wybierz hasło alfanumeryczne. Im dłuższe tym dłużej zajmie komuś jego “łamanie”. Złamanie 6 cyfrowego kodu blokady ekranu na iPhonie zajmuje 22 godziny (pomiędzy próbami wymuszane jest opóźnienie 80 milisekund). Wystarczy jednak mieć 11 cyfrowy kod blokady ekranu, aby sprawdzenie wszystkich możliwych kombinacji zajęło 127 lat. Ustaw opcję “Require Passcode” na “Immediately”. W przypadku zagrożenia po prostu zablokuj ekran iPhona. Bez tej opcji, telefon poprosi o kod blokady, ale z opóźnieniem, co oznacza, że w przypadku nalotu służb, pozyskanie nawet zablokowanego w trakcie szarpaniny telefonu spowoduje jego odblokowanie. Włącz opcję “Erase Data”, czyli kasowania danych z telefonu po 10 błędnie wprowadzonym haśle blokady. Wyłącz opcję “Notification view”, dzięki czemu nikt nie uzyska dostępu do historycznych powiadomień przy zablokowanym telefonie (a są tam fragmenty maili z GMaila, komunikacji z Facebooka itp.). Jeśli twój plan dnia jest tajny i wpisałeś go w kalendarz, wyłącz też opcję “Today”. Wyłącz podgląd treści wiadomości SMS w ramach “powiadomień”. Dzięki temu na zablokowanym ekranie nie będzie widoczna treść SMS-ów, które mogą zawierać poufne dane (np. hasło jednorazowe przesłane przesłane SMS-em). Ta opcja ma sens jedynie kiedy na twojej karcie SIM ustawiłeś jakiś PIN (i nie jest skierowana przeciwko służbom, a zwykłym złodziejom). Wyłącz obsługę iClouda. W przeciwnym razie, twoje dane są kopiowane do chmury Apple i na wniosek sądu mogą zostać rozszyfrowane przez Apple i udostępnione. Jeśli nie checsz całkowicie rezygnować z iClouda, wyłącz przynajmniej kopie bezpieczeństwa i usługę FindMyiPhone, która pozwala Apple na śledzenie twojej aktualnej pozycji (ale zapewne także historyczne lokalizacje są zapisywane). Jeśli chęć odzyskania telefonu po jego zgubieniu ma dla Ciebie wyższy priorytet niż ochrona przed służbami (czyli nie jesteś terrorystą ani nie śpisz w czapeczce z folii aluminiowej na głowie), to rozważ włączenie FindMyiPhone. Włącz iMessage. Dzięki temu wiadomości wysyłane do innych iPhonów będą szyfrowane i niewidoczne dla operatora GSM i Apple. Z nieposiadającymi iPhona, rozmawiaj przez aplikację Signal. Nie ufaj urządzeniom, do których podpinasz swojego iPhona Po podpięciu do portu USB laptopa, iPhone pyta czy chcesz “zaufać” temu komputerowi. Nie ufaj obcym (a także swoim, ale nieszyfrowanym) komputerom. Zaufanie oznacza przesłanie na komputer klucza na komputer, przy pomocy którego można (bez konieczności znajomości hasła) odblokować twojego iPhona. Jeśli nie wiesz, jakim komputerom (przypadkowo) zaufałeś w przeszłości, możesz skasować powiązania tutaj: Settings > General > Reset > Reset Location & Privacy Nie wpisuj swojego kodu, kiedy znajdujesz się w zasięgu kamer CCTV. Tak swoje hasło wprowadza Edward Snowden (serio). Pamiętaj o tej radzie zwłaszcza na lotniskach i w kawiarniach. Jeśli przed inwigilacją chcesz zabezpieczyć nie tylko iPhona ale i inne urządzenia, rzuć okiem na naszą listę 19 porad antyinwigilacyjnych i podziel się nią ze znajomymi. Także od ich zachowania zależy Twoje bezpieczeństwo i prywatność. ,Piotr KoniecznyOd momentu ogłoszenia nakazu sądowego, który wymusza na Apple stworzenie backdoora umożliwiającego FBI łatwiejszy atak na kod blokady iPhona terrorysty minęło kilka dni. Sprawa jest szeroko komentowana w mediach i pośród ekspertów ds. bezpieczeństwa, a niektóre z komentarzy (lub kontrolowanych wycieków) ujawniają bardzo ciekawe kulisy dotyczące możliwych technik ataku na iPhona. FBI ma telefon, ale nie może się do niego dobrać Przypomnijmy pokrótce jak wygląda sytuacja. FBI jest w posiadaniu iPhona 5C terrorysty (model A1532 z chipem A6 pracujący pod kontrolą systemu operacyjnego iOS 9 — gdyby był to iOS w wersji poniżej wersji 8, problemu z dostępem do danych nie byłoby żadnego). Telefon jest zablokowany, ale nie hasłem alfanumerycznym a maksymalnie 6 cyfrowym PIN-em. Ten model iPhona nie posiada czytnika linii papilarnych, więc nie można go odblokować przykładając doń palec martwego terrorysty. FBI musi więc odgadnąć PIN, ale ma tylko 10 prób, ponieważ na urządzeniu włączone jest zabezpieczenie polegające na kasowaniu danych po 10 błędnie wprowadzonych PIN-ach. Pamięć iPhona jest zaszyfrowana sprzętowym kluczem skojarzonym z tym konkretnym urządzeniem i nieznanym przez Appple, więc wykonanie tzw. chip-off (wylutowanie chipa i podpięcie do innego urządzenia) nic nie da. Apple jak najbardziej może (i tego dokładnie dotyczy nakaz) załadować do pamięci ulotnej iPhona przełączonego w tryb DFU nowy firmware, który miałby wyłączyć funkcję kasowania nośnika po 10 próbach błędnie wpisanego kodu. Problem w tym, że takiego backdoora wgrać na iPhona może tylko Apple, ponieważ oprogramowanie musi być podpisane kluczami firmy (innymi słowy FBI nie mając tych kluczy, nie może samodzielnie wykonać takiego ataku). Taki backdoor zadziała na każdym iPhonie — fakt obecności lub brak tzw. sprzętowej “enklawy bezpieczeństwa” w którą wyposażone są najnowsze iPhony nie ma żadnego znaczenia: Apple już wielokrotnie współpracowało z służbami i odblokowywało iPhony na ich żądanie, o czym informowaliśmy już 2 lata temu. Dotyczyło to jednak poprzednich modelów iPhona — od niedawna Apple robiło bowiem wszystko, żeby kontrolę nad danymi użytkowników przekazać w ich ręce (założenie tej strategii jest proste: służby nie są w stanie zmusić Apple do przekazania kluczy kryptograficznych, skoro firma ich nie ma, bo tylko użytkownicy je posiadają, na swoich iPhonach zablokowanych tak, ze blokady bez współpracy właściciela telefonu nie da się obejść) To może z racji braku współpracy Apple, FBI do tematu może podejść od drugiej strony? Przecież iPhony tworzą kopie bezpieczeństwa w chmurze Apple… Metoda 1: Odzyskanie danych metodą na iCloud Do skonfigurowania i używania chmury Apple zachęcani są użytkownicy w trakcie pierwszego uruchomienia telefonu i potem podczas wielu innych okazji (trzeba ją włączyć, aby korzystać m.in. z rozwiązania FindMyiPhone). Można więc założyć, że większość użytkowników rzeczywiście korzysta z iClouda, co nie oznacza, że wszyscy automatycznie wykonują backup do chmury: Okazuje się, że FBI już w dzień po pozyskaniu telefonu zwróciło się do jego właściciela — i tu niespodzianka, nie był nim terrorysta, a rządowa organizacja, w której pracował — o to, aby pracodawca terrorysty zresetował hasło do konta iCloud skojarzonego z telefonem. Celem tego działania miał być natychmiastowy dostęp do plików terrorysty przechowywanych w chmurze. Pośpiech służb wydaje się raczej bezzasadny. Apple posiada (i udostępniło FBI) kopię danych, jakie iPhone terrorysty wgrał do iClouda. Okazało się też, że na kilka tygodni przed zamachem, terrorysta wyłączył backup do chmury na telefonie, więc FBI nie posiadało aktualnych informacji z kopii udostępnionej przez Apple (zamach miał miejsce 2 grudnia, a w 19 października terrorysta wyłączył backupy). Nie jest to żadną niespodzianką dla regularnych czytelników Niebezpiecznika — wielokrotnie pisaliśmy, że nie tylko Apple, ale również inni dostawcy chmury, w tym Google i Dropbox, mają dostęp do danych użytkowników przechowywanych na ich serwerach, a szyfrowanie jest często iluzoryczne. Reset hasła wpadką FBI? Niekoniecznie… Wielu “ekspertów” sugeruje teraz, że FBI wymuszeniem zmiany hasła podcięło gałąź na której siedzi. Zmienionego hasła do iClouda nie zna przecież zablokowany iPhone terrorysty, a to oznacza, że nie jest on już w stanie połączyć się z chmurą Apple, która w pewnych sytuacjach miałaby móc wydać mu “polecenie” lub …odebrać kolejne dane w ramach nowej kopii bezpieczeństwa. “Eksperci” informują że wystarczyłoby, aby iPhone podłączył się do znanej mu sieci Wi-Fi — wtedy rozpocznie się wysyłanie backupu. Teraz jednak, nowego hasła nie ma jak ustawić na zablokowanym telefonie, a starego hasła nie ma jak przywrócić na iCloudzie, bo przecież służby go nie znają. Zastanawia nas jednak jak Apple miałoby wymusić backup danych z telefonu, skoro terrorysta na kilka miesięcy przed atakiem wyłączył na telefonie backup do chmury? Warto też zauważyć, że reset hasła przez FBI zapewne jest też odwracalny przez Apple — firma mogłaby bowiem sięgnąć do własnych kopii bezpieczeństwa i przywrócić pierwotny hash hasła użytkownika do jego konta iCloud, odwracając tym samym skutki zmiany hasła przez FBI i powodując, że iPhone znów mógłby się podpiąć do konta iCloud. Abstrahując od odwrócenia resetu hasła, warto zauważyć, że nawet wymuszenie backupu (o ile w ogóle możliwe) nie jest równoznaczne z pozyskaniem wszystkich danych znajdujących się na urządzeniu, więc FBI słusznie twierdzi, że backup to nie wszystko. W backupie nie będzie danych przechowywanych przez inne niż systemowe aplikacje, np. konwersacji z komunikatora Signal. No dobra, ale to i tak jest służbowa komórka, gdzie prywatny telefon terrorysty? Jeśli kogoś ciekawi czy terrorysta poza służbową, pozyskaną przez FBI komórką, posiadał także prywatny telefon, to odpowiadamy — tak, ale go zniszczył przed zamachem. Podobnie jak zniszczył dysk twardy swojego komputera. Można więc zakładać, że terrorysta był świadomy tego, gdzie przechowuje “wrażliwe” informacje i skoro oszczędził firmowy telefon, to najprawdopodobniej nie postrzegał informacji znajdujących się na nim go jako zagrożenia. Czy zatem FBI ma o co walczyć? Czy może walka jest bardziej sztuką dla sztuki (cel polityczny) niż realną potrzebą? FBI twierdzi, że do iPhona służbowego chce się dostać przede wszystkim w celu sprawdzenia z kim komunikował się terrorysta, aby zweryfikować czy nie pomagał mu ktoś ze współpracowników. Komunikacji tej nie można zobaczyć na billingach, ponieważ iPhony korzystają z protokołu iMessage, w ramach którego wiadomości są szyfrowane, a klucze do ich rozszyfrowania posiadają tylko rozmówcy. Co prawda służby mogłyby zarekwirować wszystkie iPhony współpracownikom, ale niewykluczone, że część z rozmów została już skasowana po ich stronie (albo — co bardziej prawdopodobne — terrorysta kontaktował się z kimś spoza współpracowników, kto też posiadał iPhona i miał włączone iMessage). Kolejnym argumentem za tym, że ta sprawa to “pokazówka” przemawia odrzucona przez FBI prośba Apple o utajnienie nakazu sądu. Dlaczego Apple chciało ukryć orzeczenie? Bo nie tylko sugeruje ono, że firma jest w stanie wyłączyć niektóre funkcje bezpieczeństwa swojego telefonu, ale dość precyzyjnie opisuje jak można to zrobić, co powoduje jak najbardziej słuszne zauważenie przez klientów kłamstwa Apple, że do danych klienta nikt, nawet Apple, nie może się dostać.. FBI zapewne nie zgodziło się na utajnienie orzeczenia sądu, bo służbom bardziej niż na dostępie do tego konkretnego telefonu zależy na ustanowieniu precedensu, z którego będzie można skorzystać w kolejnych sprawach. Raz stworzony backdoor będzie można dostosować do innych iPhonów, a w kolejce do odblokowania iPhonów ustawią się kolejne instytucje: Podsumowując: Zarekwirowany przez FBI iPhone nie jest prywatnym telefonem terrorysty, a komórką służbową. Telefon prywatny (zapewne ważniejszy) został zniszczony, a służbowy oszczędzony, co sugeruje że raczej nie ma na nim niczego wrażliwego FBI wymusiło na pracodawcy terrorysty reset hasła do iClouda powiązanego z iPhonem i uniemożliwiło tym samym wykonywanie kopii bezpieczeństwa z telefonu do chmury. iPhony robią je, kiedy łączą się ze znaną siecią Wi-Fi (np. tą w pracy terrorysty). Nic jednak nie wskazuje, że telefon można by zmusić do wykonania takiej kopii, skoro została wyłączona po stronie telefonu, a już na pewno sam reset hasła nie jest wyrokiem śmierci dla tej techniki — hasło do konta iCloud najprawdopodobniej można przywrócić do oryginalnego na podstawie kopii bezpieczeństwa bazy danych Apple. FBI nie może sprawdzić z kim ze współpracowników (lub innych posiadaczy iPhonów) komunikował się terrorysta, bo komunikacja to nie nieszyfrowane SMS-y a wiadomości protokołu iMessage, szyfrowane klient-klient (a więc Apple, a tym bardziej sieć GSM nie zna ich treści) Apple broniąc się przed stworzeniem backdoora zasugerowało FBI 4 metody pozyskania danych. Oto one (wraz z opisem, dlaczego nie mają szans powodzenia w tym przypadku): Metoda 2: Odzyskanie danych laserami i kwasem Skoro nie w ataku bezpośrednim i nie przez kopie bezpieczeństwa, to może kwasem i laserami? Elektronicy przyglądający się sprawie FBI vs Apple często sugerują, że klucz służący do odczytania zaszyfrowanej pamięci można wydobyć bezpośrednio z chipu poprzez odpowiednie techniki tzw. decappingu, czyli wytrawiania i obserwacji “gołego” chipu pod mikroskopem elektronowym w celu odczytu konkretnych wartości bit po bicie (por. TPM hacked!). Po zdobyciu wszystkich informacji potrzebnych do wyliczenia klucza szyfrującego dane, można by stworzyć program, który umożliwiłby dołączanie ich do algorytmu generacji klucza razem z różnymi “kodami blokady”. Ponieważ program działałby już poza iPhonem, nie ma ryzyka skasowania danych po 10 błędnych podstawieniach kodu blokady. Jest tylko jeden problem dotyczący decappingu. Z racji inwazyjności tej metody, dane mogą zostać bezpowrotnie utracone poprzez fizyczne zniekształcenie chipu. I właśnie z tego powodu raczej nikt nie zdecyduje się na to rozwiazanie. Zaproponowane przez FBI wprowadzenie backdoora przez Apple na poziomie firmware’u wydaje się więc zdecydowanie bezpieczniejszym rozwiązaniem, choć i w tym przypadku błąd programistyczny — a przypomnijmy, że taki firmware tworzony będzie po raz pierwszy — może spowodować bezpowrotną utratę danych. W sumie to dobra okazja dla “zmuszonego do działania Apple” na przeprowadzenie małego sabotażu… — w końcu FBI nie może wykonać kopii danych i cała operacja jest pracą na żywym organizmie. Jeden błąd i pacjent umiera… :-) Metoda 3: klucze parujące pozyskane z komputera Jeśli użytkownik iPhona sparował telefon z jakimś komputerem, klucze pozostawione w iTunes na tym komputerze pozwalają na odblokowanie telefonu. FBI twierdzi jednak, że iPhone nie był z niczym powiązany. I tym samym ostatnia znana na dzień dzisiejszy możliwość dostania się do iPhona bez hasła została wyczerpana. Zestawienie wszystkich możliwości dla wszystkich urządzeń Apple Ponieważ w wersjach i modelach telefonów oraz technikach, które działają na jednej parze a ale nie na drugiej można się łatwo pogubić, poniżej prezentujemy przydatne zestawienie: A tu legenda: Jak widać, poza oprogramowaniem wykorzystującym błędy w starszych wersjach iOS, przechwyceniem danych z innych miejsc, innych metod brak. Zastosowanie powyższych w szczegółach opisano tutaj oraz w poniższych artykułach: Trail of Bits – “Apple can comply with the FBI court order” DarthNull.org – “Put away the tin-foil: The Apple unlock case is complicated enough” Jonathan Zdziarski – Apple’s technical capabilities under FBI AWA order Charles Riley – All This #FBiOS Hubbub Boils Down to Just One (Technical) Thing Devon Ackerman – iOS Imaging Spreadsheet Tematykę bezpieczeństwa iOS (i Androida), nie tylko pod kątem omijania kodu blokady poruszamy także w praktyce na szkoleniach z Bezpieczeństwa Aplikacji Mobilnych i Informatyce Śledczej (techniki służb). Oba odbywają się niebawem i są już tylko ostatnie wolne miejsca. Amerykanie są po stronie FBI, a nie Apple (co innego inne korporacje) Choć w pierwszych dniach po ujawnieniu orzeczenia sądu, opór Apple popierało zarówno EFF, Google, Facebook i Twitter a nawet Huawei, to opinia publiczna, co ciekawe, stoi po stronie FBI: Także Bill Gates twierdzi, że Apple powinno odblokować iPhona dla FBI, porównując pozyskiwanie danych z telefonów użytkowników od ich producentów do pozyskiwania danych na temat ich transakcji bankowych z banków. Cierpliwość powoli traci także sam dyrektor FBI. Właśnie wydał drugie oświadczenie, w którym jeszcze raz podkreśla, że “chodzi o wyjaśnienie zamachu, w którym zginęło 14 Amerykanów, a nie precedens”: FBI stara się przedstawić tę sprawę jako ustalenie balansu pomiędzy prywatnością a bezpieczeństwem, a firmy technologiczne, jak celnie zauważa Bruce Schneier, widzą tę sprawę jako ustalenie balansu pomiędzy bezpieczeństwem a inwigilacją. Warto też podkreślić, że nie ma backdoorów, z których może korzystać tylko jedna służba (lub jeden kraj). Jeśli taki backdoor powstanie, prędzej czy później będzie dostępny dla wszystkich. Nie tylko przyjaciół FBI, ale również “wrogów”. Niewykluczone zresztą, że wrogowie już go mają. Stworzenie samego firmware’u jest do wykonania nie tylko przez inżynierów Apple’a. Problem w tym, że trzeba go podpisać kluczami Apple. Ale atakujący (zwłaszcza ci z zapleczem rządowym) już wielokrotnie nam pokazali, że potrafią wykradać klucze kryptograficzne dużych firm (por. Stuxnet oraz atak na RSA). Backdoor nie rozszyfruje a przyśpieszy rozszyfrowanie iPhona Na koniec warto zaznaczyć, że nawet jeśli Apple zostanie zmuszone i wyprodukuje backdoora, to jego jedyną zaletą będzie usunięcie 3 zabezpieczeń przed atakami zgadywania hasła blokady ekranu (wyeliminowanie opóźnień i autodestrukcji urządzenia po 10 błędnych próbach wprowadzenia kodu oraz umożliwienie wprowadzania kodów blokady inaczej niż przez ekran dotykowy) a nie jego natychmiastowe rozszyfrowanie. Innymi słowy, służby dalej będą musiały się trochę pomęczyć. Stąd prosty wniosek, że im dłuższe hasło, tym lepiej… Jeśli Apple udostępni backdoora, opóźnienie zniknie, a więc będzie można szybciej zgadywać hasła blokady ekranu, bez strachu że po 10 próbie klucz deszyfrujący zostanie zniszczony. Dlatego niezależnie od wyniku sporu FBI vs Apple, warto maksymalnie utrudnić przejęcie kontroli nad swoim iPhonem. Poniżej instrukcje: Mam iPhona — co robić, jak żyć? Do poniższych rad zastosuj się niezależnie od tego, czy boisz się służb, złośliwego kolegi z pracy, czy masz sekret przed żoną, albo po prostu cenisz swoją prywatność i chcesz się poprawnie przygotować do kontroli na lotnisku, uniemożliwiając pogranicznikom obejrzenie twoich nagich zdjęć. Korzystaj z hasła blokady ekranu a nie TouchID. Twój palec zawsze można siłowo podsunąć pod twojego iPhona, bez twojej zgody, co spowoduje odblokowanie telefonu. Pamiętaj o tym przechodząc przez lotnisko. Ustaw długi i alfanumeryczny kod blokady ekranu. Domyślne 6 cyfr to za mało. Wybierz hasło alfanumeryczne. Im dłuższe tym dłużej zajmie komuś jego “łamanie”. Złamanie 6 cyfrowego kodu blokady ekranu na iPhonie zajmuje 22 godziny (pomiędzy próbami wymuszane jest opóźnienie 80 milisekund). Wystarczy jednak mieć 11 cyfrowy kod blokady ekranu, aby sprawdzenie wszystkich możliwych kombinacji zajęło 127 lat. Ustaw opcję “Require Passcode” na “Immediately”. W przypadku zagrożenia po prostu zablokuj ekran iPhona. Bez tej opcji, telefon poprosi o kod blokady, ale z opóźnieniem, co oznacza, że w przypadku nalotu służb, pozyskanie nawet zablokowanego w trakcie szarpaniny telefonu spowoduje jego odblokowanie. Włącz opcję “Erase Data”, czyli kasowania danych z telefonu po 10 błędnie wprowadzonym haśle blokady. Wyłącz opcję “Notification view”, dzięki czemu nikt nie uzyska dostępu do historycznych powiadomień przy zablokowanym telefonie (a są tam fragmenty maili z GMaila, komunikacji z Facebooka itp.). Jeśli twój plan dnia jest tajny i wpisałeś go w kalendarz, wyłącz też opcję “Today”. Wyłącz podgląd treści wiadomości SMS w ramach “powiadomień”. Dzięki temu na zablokowanym ekranie nie będzie widoczna treść SMS-ów, które mogą zawierać poufne dane (np. hasło jednorazowe przesłane przesłane SMS-em). Ta opcja ma sens jedynie kiedy na twojej karcie SIM ustawiłeś jakiś PIN (i nie jest skierowana przeciwko służbom, a zwykłym złodziejom). Wyłącz obsługę iClouda. W przeciwnym razie, twoje dane są kopiowane do chmury Apple i na wniosek sądu mogą zostać rozszyfrowane przez Apple i udostępnione. Jeśli nie checsz całkowicie rezygnować z iClouda, wyłącz przynajmniej kopie bezpieczeństwa i usługę FindMyiPhone, która pozwala Apple na śledzenie twojej aktualnej pozycji (ale zapewne także historyczne lokalizacje są zapisywane). Jeśli chęć odzyskania telefonu po jego zgubieniu ma dla Ciebie wyższy priorytet niż ochrona przed służbami (czyli nie jesteś terrorystą ani nie śpisz w czapeczce z folii aluminiowej na głowie), to rozważ włączenie FindMyiPhone. Włącz iMessage. Dzięki temu wiadomości wysyłane do innych iPhonów będą szyfrowane i niewidoczne dla operatora GSM i Apple. Z nieposiadającymi iPhona, rozmawiaj przez aplikację Signal. Nie ufaj urządzeniom, do których podpinasz swojego iPhona Po podpięciu do portu USB laptopa, iPhone pyta czy chcesz “zaufać” temu komputerowi. Nie ufaj obcym (a także swoim, ale nieszyfrowanym) komputerom. Zaufanie oznacza przesłanie na komputer klucza na komputer, przy pomocy którego można (bez konieczności znajomości hasła) odblokować twojego iPhona. Jeśli nie wiesz, jakim komputerom (przypadkowo) zaufałeś w przeszłości, możesz skasować powiązania tutaj: Settings > General > Reset > Reset Location & Privacy Nie wpisuj swojego kodu, kiedy znajdujesz się w zasięgu kamer CCTV. Tak swoje hasło wprowadza Edward Snowden (serio). Pamiętaj o tej radzie zwłaszcza na lotniskach i w kawiarniach. Jeśli przed inwigilacją chcesz zabezpieczyć nie tylko iPhona ale i inne urządzenia, rzuć okiem na naszą listę 19 porad antyinwigilacyjnych i podziel się nią ze znajomymi. Także od ich zachowania zależy Twoje bezpieczeństwo i prywatność. ,Piotr Konieczny