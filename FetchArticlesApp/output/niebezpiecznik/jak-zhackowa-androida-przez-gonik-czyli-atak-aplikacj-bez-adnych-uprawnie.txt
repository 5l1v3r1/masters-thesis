iPhone ma swoją Siri, a Android korzysta z Google Voice Search (GVS), aplikacji systemowej obecnej także w customowych wersjach Androida. Okazuje się, że GVS można bardzo prosto wykorzystać do obejścia modelu uprawnień na Androidzie, a to pozwala każdej aplikacji m.in. na podsłuchiwanie właściciela smartphona, podszywanie się pod niego lub wykradanie jego danych — oto, na czym polega atak. Nie mam uprawnień, a robię złe rzeczy Ściągasz niewinną aplikację. Podczas instalacji, aplikacja ta nie prosi o żadne podejrzane uprawnienia. W zasadzie w ogóle nie prosi o jakiekolwiek uprawnienia — nie potrzebuje ich. Tuż po instalacji, aplikacja przystępuje do złośliwych działań; wykradania danych, wykonywania połączeń bez twojej wiedzy, itp. Jak? Wywołuje Google Voice Search (za pomocą API, tzw. “intentu”) …i odgrywa plik dźwiękowy, który zawiera instrukcje dla GVS — instrukcje, których wykonanie samodzielnie przez aplikację wymagałoby posiadania odpowiednich uprawnień. Co więc można zrobić (dzięki GVS) nie mając do tego uprawnień? Wykonywanie połączeń telefonicznych (można wykorzystać do “podsłuchu”). Fałszowanie treści SMS-ów i E-maili (nie jest to spoofing — e-maile i SMS-y rzeczywiście wyjdą z prawdziwego konta/numeru ofiary). Oto przykłady komend: Fałszowanie e-maila: Email to [nazwa_kontaktu], subject “meeting cancel”, message “tomorrow’s meeting has been canceled”. Zapisanie na płatną usługę SMS: Send SMS to number 1234 “START XYZ”. Odczytać prywatne dane, np.: kalendarz: “What is my next meeting?” ⇒“Your next calendar entry is tomorrow 10 AM. The tile is “Meet with boss”.” adres IP: “What is my IP address?” ⇒ “Your public IP address is 111.222.111.222.” lokalizację GPS: “Where is my location?” ⇒ “Here is a map of Brooklyn District.” To nie jest dokładna lokalizacja, ale można ją zawęzić zadając dodatkowe pytania: Jak daleko mam do Białego Domu? Jak daleko mam do Chicago? A następnie na przecięciu okręgów o promieniach równych odległościom wyznaczyć miejsce pobytu ofiary. Móc zdalnie sterować Androidem nie mając żadnych uprawnień Co ciekawe, na skutek odkrytego przy okazji eksperymentu błędu w aplikacji Google Search (zainstalowanej na 500 milionach smartphonów z Androidem), okazało się, że na dowolne numery można dzwonić także wtedy, kiedy telefon jest zablokowany. Demo ataku Badacze, którzy opracowali ten atak stworzyli przykładową aplikację o nazwie VoicEmployer i przeprowadzili za jej pomocą powyższe ataki na telefonie z Androidem, który dodatkowo był wyposażony w oprogramowanie AVG, McAfee Avira, ESET Mobile, Norton Mobile Security. Jak się zapewne domyślacie — antywirusy nie zareagowały. Tutaj możecie zobaczyć video obrazujące atak: Ciekawostka: jeśli atakujący nie chce, aby jego złośliwa aplikacja miała duży rozmiar (pliki audio w końcu trochę “ważą“), badacze polecają wbudowanie w aplikację API do usługi Google Text-to-Speech (TTS). Chociaż usługa ta działa przez internet, to aplikacja która z niej korzysta nie musi wymagać androidowego uprawnienia “dostęp do internetu”. Mam Androida — co robić, jak żyć? Na atak w zasadzie niepodatni są jedynie ci, którzy na swoim smartphonie mają zainstalowany Cyanogen-Mod, pod warunkiem, że sami ręcznie nie doinstalowali Google Voice Searcha (domyślnie nie jest on instalowany z przyczyn licencyjnych). Jeśli ofiara blokuje swój telefon kodem (lub gestem) i nie posiada aplikacji Google Search, w której znajduje się błąd pozwalający na wywoływanie głosowych komend nawet przy zablokowanym ekranie, atak będzie znacznie ograniczony — złośliwe komendy mogą zostać odpalone tylko w trakcie korzystania z telefonu, ale wtedy najprawdopodobniej użytkownik usłyszy i zauważy dziwne zachowanie telefonu. Gorzej jest w przypadku osób, które nie stosują blokady ekranu — badacze sugerują odpalanie ataków ok. godz. 4 nad ranem, kiedy właściciel zapewne śpi i nie usłyszy cichej komendy głosowej (a dodatkowo informują, że można łatwo wykryć nieużywanie telefonu przez ofiarę; aplikacja poza odczytaniem godziny, może bowiem odwołać się do czujnika światła i akcelerometru, sprawdzić czy włączony jest ekran, odczytać zawartość pamięci RAM — i na tej podstawie podjąć decyzję, czy atak zostanie odpalony bo telefon nie jest obecnie używany aktywnie). Podsumowując: upewnij się, że masz aktywny kod blokady i jeśli nie korzystasz, odinstaluj aplikację Google Search. Powyższe dotyczy tylko i wyłącznie tych języków, które są wspierane pod kątem komend głosowych — polski nie jest (póki co). To chyba pierwszy raz, kiedy należy się cieszyć z traktowania nas jak zacofany kraj. Więcej uprawnień, więcej możliwości Atak dodatkowo komplikuje się, jeśli złośliwej aplikacji uda się “wyłudzić” niewinne uprawnienia. Wtedy, za ich pomocą może odpalać tą samą głosową techniką bardziej skomplikowane ataki — np. uprawnienie READ_CONTACTS, READ_CALL_LOG, READ_SMS pozwoli na odczytanie na głos (a zatem nagranie i wytransferowanie) kontaktów, historii połączeń lub SMS-ów. O podobnych atakach “nie wprost” na Androida pisaliśmy jakiś czas temu, por. keylogger z akcelerometru oraz Android — szpieg: ukradkiem sfotografuje twój dom i zrobi z niego model w 3D oraz podeśle złodziejowi Wnioski z doświadczenia badaczy są proste — brak uprawnień dla aplikacji nie jest żadną gwarancją bezpieczeństwa. PS. Podobne ataki dotyczące nadwyrężania modelu uprawnień na Androidzie ćwiczymy na naszym szkoleniu z Bezpieczeństwa Aplikacji Mobilnych — najbliższy termin to 28-29 sierpnia w Warszawie, zostało jeszcze 8 wolnych miejsc. ,igH