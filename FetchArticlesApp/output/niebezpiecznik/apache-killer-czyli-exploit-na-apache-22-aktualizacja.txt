Błąd w przetwarzaniu nagłówka Range obecny w serwerach Apache 2.2.* pozwala na zdalne unieruchomienie pracy webserwera (atak DoS). Atakujący nie musi posiadać wielkiego botnetu, wystarczy jeden komputer i poniższy skrypt. Exploit na Apache 2.2.* – Apache Killer Skrypt z exploitem został opublikowany na liście Full Disclosure przez Kingcope’a. Atak polega na wysyłaniu do serwera zapytań z nagłówkiem Range przyjmującym więcej niż jeden zakres bajtów. Nagłówek Range pozwala pobrać konkretne wycinki pliku i służy m.in. do wznowienia przerwanych transferów danych. Jeśli jednak jednocześnie zdefiniuje się kilka nieposortowanych zakresów, żądanie przetwarzane jest w nieoptymalny sposób przez a_byternage_filter() — dla każdego zakresu tworzony jest odrębny bucket, co powoduje wyczerpanie dostępnej pamięci. Jak na razie brak oficjalnego patcha, ale istnieje obejście problemu (poza oczywiście wykrywaniem i ubijaniem żądań tego typu na IPS/IDS/WAF). Pomóc może odpowiednia konfiguracja mod_rewrite, zabraniające więcej niż jednego zakresu dla nagłówka Range. RewriteEngine On RewriteCond %{REQUEST_METHOD} ^(HEAD|GET) [NC] RewriteCond %{HTTP:Range} ([0-9]*-[0-9]*)(\s*,\s*[0-9]*-[0-9]*)+ RewriteRule .* - [F] Co ciekawe, zastrzeżenia do implementacji nagłówka Range już w 2007 roku miał …Michał Zalewski. Przy czym Michał zwracał wtedy uwagę na możliwość generowania olbrzymiej ilości danych (bandwidth amplification), a Kingcope wymierzył swój atak w pamięć serwera (memory corruption). Aktualizacja 22:54 Apache opublikowało oficjalne oświadczenie zawierające opisy kilku obejść problemu. ,vi.curry