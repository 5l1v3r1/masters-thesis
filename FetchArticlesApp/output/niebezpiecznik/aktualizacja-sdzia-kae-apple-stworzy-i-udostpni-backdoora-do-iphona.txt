Dziś Apple zrobiło rzecz bezprecedensową. Firma właśnie opublikowała obszerny list do swoich klientów, w którym ujawnia, że pomagała FBI w śledztwie …do momentu, w którym poproszono ją o stworzenie backdoora do iPhona. Odmowa nie została zaakceptowana i sąd właśnie ponowił prośbę FBI, tym razem w formie oficjalnego nakazu. Sędzia: Macie rozszyfrować iPhona Ta historia zaczyna się w grudniu 2015 roku, kiedy to w San Bernardino Syed Rizwan Farook wraz z żoną zastrzelili 14 osób. Syed, poza krabinem miał też zaszyfrowanego iPhona 5C, którego — jak podejrzewa FBI — wykorzystywał do komunikacji z innymi terrorystami. Wczoraj sędzia orzekający w tej sprawie nakazał Apple pomóc rządowi w odblokowaniu i rozszyfrowaniu iPhona 5C. Ten wyrok jest ciekawy z 2 powodów. Po pierwsze, mamy dowód na to, że FBI jest bezradne jeśli chodzi o złamanie zabezpieczeń iPhona 5C (czyli nawet jego najtańsza wersja nie ma wad projektowych, pozwalających na obejście poprawnie skonfigurowanej blokady ekranu). Po drugie, wyrok ten rozpoczął publiczną debatę dotyczącą próśb o wbudowanie backdoora w elektronikę. Oczywiście, takie prośby już zdarzały się w przeszłości (por. prośbę o wbudowanie backdoora w Bitlockera), a teoretyczne rozważanie dotyczące tego co by było, gdyby był nakaz prawny wbudowywania backdoorów trwają od lat. Teraz taki nakaz jest. I Apple jest w jego obliczu prawnie bezradne — stąd dość desperacki krok — list do klientów objaśniający kulisy sprawy. List Apple: to nie będzie jednorazowy backdoor W opublikowanym tuż po ogłoszeniu wyroku liście do klientów, Apple informuje, że: Produkowane przez nich smartphony zawierają bardzo prywatne dane użytkowników i z tego powodu firma doszła do wniosku, że dane te należy chronić przed włamywaczami i “innymi osobami, które bez zgody właściciela chciałyby je pozyskać“. Dlatego Apple zmodyfikowało jakiś czas temu swój system operacyjny iOS tak, że wprowadzone doń zabezpieczenia są nie do obejścia. Nawet przez Apple. Od wersji iOS 9 szyfrowanie jest domyślnie włączone, a firma nie posiada kluczy deszyfrujących i jak sama twierdzi “to nie nasz interes, co ludzie trzymają na swoich iPhonach“. Firma jest zszokowana strzelaniną w San Bernardino i potępia terrorystów. W trakcie śledztwa asystowała FBI i oddelegowała inżynierów, którzy wyjaśniali funkcjonariuszom jak działa iOS i w jaki sposób możliwe jest pozyskanie danych z iPhona 5C …o ile ktoś nie dochował należytych starań w jego konfiguracji. Apple pozytywnie wyraża się o wiedzy ekspertów z FBI i zaznacza, że wierzy w ich dobre intencje. Firma podkreśla, że w zakresie pomocy władzom zrobiła wszystko co było technicznie możliwe. Ale to nie wystarczyło sędziemu… Apple zostało poproszone o stworzenie backdoora w postaci nowej wersji systemu operacyjnego iOS, który wyłączałby kilka ważnych z punktu widzenia bezpieczeństwa funkcji (umożliwienie wprowadzania haseł blokady ekranu elektronicznie, a nie poprzez ekran dotykowy i zdjęcie zabezpieczenia w postaci audodestrukcji danych w przypadku 10 błędnych prób wprowadzenia hasła). Apple miałoby zainstalować ten “nowy” (podkreślmy, jeszcze niestworzony) system tylko na tym jednym iPhonie 5C należącym do Syeda. Firma podkreśla jednak, że stworzenie takiej wersji systemu nawet tylko dla tej sprawy, de facto otworzyłoby FBI drogę do użycia tej techniki (zarówno pod kątem prawnym jak i technologicznym) odblokowania iPhonów w innych sprawach, być może mniej istotnych. Taki atak zostałby szybko zaimplementowany w oprogramowaniu forensicowym (por. Czym rząd hackuje telefony obywateli) i udostępniony także “przyjacielskim” służbom w Europie. WYJAŚNIENIE TECHNICZNE Tu warto przybliżyć model bezpieczeństwa iOS 9, i wyjaśnić, że służby nie mogą sobie tak po prostu sklonować dysku twardego i próbować offline ataku brute-force na klucz, gdyż zajęłoby to zbyt wiele czasu. Klucz jest obliczany na podstawie podanego przez użytkownika kodu blokady, ale z kolei wprowadzanie go “online”, czyli poprzez urządzenie, obarczone jest “karą czasową” (kolejne próby są możliwe, ale po coraz dłuższym czasie oczekiwania) oraz — w przypadku więcej niż 10 prób — autodestrukcją klucza. A oto odpowiedni fragment ze specyfikacji: The device’s unique ID (UID) and a device group ID (GID) are AES 256-bit keys fused (UID) or compiled (GID) into the application processor and Secure Enclave during manufacturing. No software or firmware can read them directly; they can see only the results of encryption or decryption operations performed by dedicated AES engines implemented in silicon using the UID or GID as a key. Additionally, the Secure Enclave’s UID and GID can only be used by the AES engine dedicated to the Secure Enclave. The UIDs are unique to each device and are not recorded by Apple or any of its suppliers (…) The passcode is entangled with the device’s UID, so brute-force attempts must be performed on the device under attack. A large iteration count is used to make each attempt slower. The iteration count is calibrated so that one attempt takes approximately 80 milliseconds. This means it would take more than 5½ years to try all combinations of a six-character alphanumeric passcode with lowercase letters and numbers. (…) The Secure Enclave is a coprocessor fabricated in the Apple A7 or later A-series processor. It utilizes its own secure boot and personalized software update separate from the application processor. Służby mogą jeszcze dostać się na iPhona poprzez klucze z komputera terrorysty, o ile synchronizował on swojego iPhona z iTunes. Albo …poprosić Apple o reflash firmware’u procesora — same nie mogą tego zrobić nie dysponując kluczami Apple do podpisu oprogramowania. I wygląda na to, że właśnie to ostatnie rozwiązanie chcą zastosować. Apple jest także w szoku, że do nacisków na firmę, sędzia używa 18-wiecznego prawa, tzw. “All Writs Act“, które pozwala sądowi wydać nakaz firmie aby coś zrobiła. I kończy dość wymownymi akapitami, odowłującymi się do demokracji i konieczności ochrony takich wartości jak wolność: Zarówno nakaz sądu jak i list Apple są bezprecedensowe. Pytanie, czy firmie uda się ochronić prywatność swoich klientów i wywalczyć — także dla innych producentów — swobodę w wykorzystywaniu szyfrowania i wdrażaniu solidnych zabezpieczeń elektroniki przed nieuprawnionym dostępem? W końcu jej przeciwnikiem jest rząd USA… Jedno jest pewne — iPhone to dzisiaj najlepiej chroniony smartphone, oferujący nawet przeciętnemu Kowalskiemu najwyższy poziom bezpieczeństwa w najprostszy możliwy do skonfigurowania sposób. Dziś zostało to potwierdzone nie tylko przez marketingowe frazesy, ale również przez bezradność organów ścigania. Ale to sytuacja na dziś. A co będzie za tydzień? Apple ma 5 dni do “zastosowania się od nakazu”. Aktualizacja 14:50 Decyzję Apple popiera EFF. Z kolei internauci wskazują, że FBI udało się w przeszłości zmusić innego producenta do wbudowania backdoora aby ominąć ekran blokady ekranu. Do artykułu dodaliśmy też ramkę “WYJAŚNIENIE TECHNICZNE“, bo sądząc po komentarzach, przeważają błędne opinie co do tego jak można (i czy w ogóle) brute-force’ować klucze iPhona do FDE w trybie offline. Mam iPhona — co robić, jak żyć? Warto zauważyć, że nawet jeśli Apple zgodzi się na wypełnienie nakazu sądu (bo jest to technicznie możliwe!), to wgranie stworzonej przez nich “aktualizacji” systemu nie pozwoli na natychmiastowe rozszyfrowanie iPhona, a jedynie usunie jedno z utrudnień i tym samym przyśpieszy wciąż konieczny do wykonania atak brute-force, którego czas prowadzania jest wprost proporcjonalny do długości hasła użytkownika. A wiec im dłuższe hasło, tym lepiej. Lepiej też korzystać z najnowszego sprzętu Apple. Nowsze modele iPhone’a wyposażone są bowiem w dedykowane bezpieczeństwu układy, które lepiej chronią klucze kryptograficzne, a więc utrudniają nieautoryzowany dostęp do Waszych danych. Nowsze modele mają też TouchID, ale z niego akurat lepiej nie korzystać, jeśli boicie się o swoje dane. Bo o ile hasło trzeba wyciągnąć z Waszego umysłu (co zależy od Waszej dobrej woli lub odporności na ból), to Wasz palec można już bardzo łatwo pozyskać do współpracy ;) Pisaliśmy o tym obszernie w naszym artykule pt. Analiza bezpieczeństwa czytnika linii papilarnych w najnowszym iPhonie. ,Mr. Niebezpieczny