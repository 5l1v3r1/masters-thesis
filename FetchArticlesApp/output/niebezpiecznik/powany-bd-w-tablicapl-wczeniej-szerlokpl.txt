Zła passa Grupy Allegro chyba trwa. Najpierw kilkugodzinna awaria w serwerowni, potem wyciek danych z serwisu BuyVIP (obecnie Markafoni), a teraz błąd programistyczny pozwalający przejąć kontrolę nad kontami użytkowników serwisu Tablica.pl. Tablica.pl i przejęcie konta użytkownika Tablica.pl to serwis z ogłoszeniami, wcześniej znany jako Szerlok.pl. Najpierw należał do właścicieli Wykop.pl, teraz jest własnością Grupy Allegro. O błędzie w Tablica.pl poinformował nas czytelnik Xandersky. Zauważył on, że jeśli użytkownik serwisu odpisze na przesłaną mu wiadomość, to w treści odpowiedzi, która przychodzi jako e-mail pojawia się link, który po kliknięciu automatycznie loguje nas na konto naszego rozmówcy. Wysłanie pierwszej wiadomości. Link, który przychodzi, poprawnie loguje nas na nasze własne konto: Jeśli właściciel ogłoszenia odpowie na naszą wiadomość, system nieprawidłowo generuje link, który po kliknięciu automatycznie daje nam dostęp do konta właściciela ogłoszenia: Z kontem właściciela ogłoszenia można było zrobić wszystko — od zmiany e-maila, poprzez zmianę hasła (system nie wymaga podania poprzedniego), aż do usunięcia konta (wystarczy wcisnąć przycisk usuń konto), czy podejrzenia lub podmiany danych kontaktowych. Błąd poważny, ale czy straszny? Dla potencjalnego atakującego przejęcie czyjegoś konta na Tablica.pl nie będzie wielkim łupem — nic poza adresami e-mail, numerami GG czy Skype tam nie znajdziemy. Złośliwy atakujący mogłby jednak pokusić się o modyfikację treści lub skasowanie aukcji albo inne dowcipy (czy dałoby radę przechwycić zakupiony przedmiot?). Tomasz Drożdżyński z serwisu Tablica.pl szybko odpowiedział na przesłane do serwisu pytania: Sam błąd, który umożliwiał przejęcie konta użytkownika na Tablica.pl należy zaliczyć do zwykłych pomyłek programistycznych. Jednakże, w obliczu tego błędu warto przypomnieć to, o czym mówimy na naszych szkoleniach z bezpieczeństwa webaplikacji — przesyłanie tokenów sesyjnych w URL-ach może i ułatwia logowanie do serwisu, ale pod kątem bezpieczeństwa nie jest dobrym pomysłem (hint: ujawnienie tokenu np. poprzez nagłówek Referer, ułatwienie ataków typu Session Fixation). Warto również kolejny raz wspomnieć o dodatku Firesheep do Firefoksa, jeśli ktoś uważa, że brak szyfrowania połączeń w przypadku tokenów sesyjnych to dobry pomysł… Na koniec warto zauważyć, że nie “niebezpieczny” sposób przesyłania tokenu był dla Tablica.pl głównym problemem, a to, że na skutek pomyłki programisty linki z tokenami sesyjnymi trafiały do złych osób. ,Mr. Niebezpieczny