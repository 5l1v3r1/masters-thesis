Chińska grupa wojskowych hackerów o nazwie APT1, opisywana przez nas w lutym, dała się wyrolować jednemu z amerykańskich badaczy, który wystawił do internetu oprogramowanie symulujące pracę elektrowni wodnej, która w rzeczywistości nie istniała. Honeypot Aby lepiej opisać jak nabrano Chińczyków, musimy najpierw wyjaśnić co to jest honeypot. Jedną ze skuteczniejszych metod zbierania informacji na temat sposobów pracy i algorytmu doboru celów przez współczesnych atakujących są tzw. honeypoty, czyli serwery, które udostępniają jakąś usługę, ale tak naprawdę nie oczekują, że ktokolwiek się do niej podłączy (fakt udostępniania usługi nie jest nigdzie rozgłaszany) — przykładem jest honeyd. Jeśli więc na honeypocie odnotuje się połączenie przychodzące, może to być wynik pomyłki (np. komuś omsknął się palec przy przepisywaniu adresu IP — mało prawdopodobne) albo wynik odnalezienia tej usługi w wyniku masowego skanowania internetu. Samo odkrycie usługi daje nam wyłącznie informacje na temat tego, jak często różne grupy mogą skanować internet w poszukiwaniu danego typu usług, np. centralek VoIP. Dlatego honeypoty celowo umożliwiają potencjalnym atakującym na łatwy nieautoryzowany dostęp do udostępnianych przez siebie usług (np. ustawiając łatwe hasło do FTP, lub po prostu akceptując trzecie wpisane przez atakującego hasło — jakiekolwiek by ono nie było). Po dostępie przez atakującego do honeypotowej usługi następuje analiza jego działań (co robi, czego szuka, jakimi narzędziami) oraz przechwycenie narzędzi atakującego, które zazwyczaj ściąga na przejętą maszynę, a które ułatwiają mu rekonesans i exploitację — czasem w ręce właściciela honeypota wpadają takie rarytasy, jak nieznane do tej pory exploity. Chińczycy dają się nabrać Kyle Wilhoit wystawił do internetu 12 honeypotów zlokalizowanych w 8 różnych krajach. Wszystkie swoją charakterystyką łudząco przypominały przemysłowe systemy SCADA odpowiedzialne za sterowanie m.in. elektrowniami, przepompowniami wody lub oczyszczalniami ścieków. Honeypoty miały takie same ekrany powitalne jak w oryginalnym oprogramowaniu i identyczną charakterystykę pracy. Pomiędzy majem a czerwcem Kyle odnotował przy pomocy swoich honeypotów aż 74 ataki, z których 10 pozwalało przejąć całkowitą kontrolę nad oprogramowaniem elektrowni wodnej. Jednakże tylko 4 ataki sprawiały wrażenie, jakoby ich autorzy rzeczywiście doskonale znali to dość specyficzne oprogramowanie do sterowania systemami przemysłowymi (atakujący potrafili modyfikować komunikację specyficznych protokołów). Kyle za każdym razem próbował atakować atakujących — na stronach WWW swoich honeypotów wbudował specjalne skrypty BeEF, które pozwalały mu wykonywać JavaScript w przeglądarce atakującego. Dzięki temu mógł np. namierzyć ich lokalizację przy pomocy danych na temat okolicznych dla atakującego sieci Wi-Fi (uzyskanych przy pomocy podstawionego apletu Java). Dzięki temu wiemy, że większość atakujących o przeciętnych zdolnościach pochodziło z Rosji i USA, natomiast 5 z 10 zaawansowanych ataków była przeprowadzana z Chin (reszta zaawansowanych atakujących była zlokalizowana w Niemczech, Wielkiej Brytanii, Francji, Palestynie i Japonii). Czy inżynierowie znają skalę problemu? Eksperyment Kyle’a pokazuje, że internet jest regularnie przeszukiwany pod kątem systemów SCADA (specjalna lista “dorków” jest łatwodostępna nawet dla osób, które nigdy nie miały dostępu do tychże systemów, aby wykonać ich fingerprinting). Jak widać powyżej, niektórzy z atakujących mają odpowiednie zdolności, aby przejąć kontrolę nad tego typu oprogramowaniem. Kyle zastanawia się, czy inżynierowie pracujący w elektrowniach i innych fabrykach korzystających ze SCADA zdają sobie w ogóle z tego sprawę? Przypomnijmy, że NSA prowadzi tajny program Perfect Citizen, którego misją jest wyszukiwanie błędów w systemach SCADA. W sieci znaleźć można także wiele narzędzi do wyszukiwania systemów tego typu, a jak pokazuje historia Justina Clarke’a, nie wszyscy producenci są świadomi błędów i często ignorują zgłoszenia o dziurach. Z kolei sami inżynierowie, którzy opiekują się systemami SCADA nie mają odpowiedniej wiedzy by poprawnie identyfikować zagrożenia. Czasem ich nie zauważają w ogóle, czasem reagują panicznie na zupełnie normalne zdarzenia… ,vi.curry