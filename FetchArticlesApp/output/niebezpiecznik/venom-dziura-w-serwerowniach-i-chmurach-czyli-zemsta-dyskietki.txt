“Nowy Heartbleed” — tak zachodnia prasa już nazywa dziurę w hypervisorach, której szczegóły ujawniono przed kilkoma godzinami. Dziura, której nadano nazwę VENOM, dotyczy środowisk zwirtualizowanych Xen, KVM i QEMU i pozwala atakującemu na “wyskoczenie” ze swojej maszyny wirtualnej oraz przejęcie kontroli nad innymi, sąsiednimi maszynami, które najprawdopodobniej będą należały do innych klientów. Atak najbardziej zaboli serwerownie i “chmury”… VENOM i ucieczka z maszyny gościa Chmury (czy też wedle starej nomenklatury — serwerownie) korzystają z wirtualizacji, aby fizyczne zasoby danego serwera “podzielić” pomiędzy wielu klientów. Każdy z klientów ma swoją instancję (tj. maszynę wirtualną, VPS-a) w ramach której instalowany jest system operacyjny, którym klient zarządza. Bezpieczeństwo środowiska wirtualnego opiera się jednak na tym, że dany klient nie ma dostępu do zarządcy, czyli hypervisora maszyny wirtualnej, ponieważ to właśnie za jego pomocą zarządza się całym środowiskiem wirtualnym (stawia i “gasi” maszyny, przydziela zasoby, itp.). Niestety, atak VENOM (virtualized environment neglected operations manipulation), odkryty przez pracowników CrowdStrike, pozwala dowolnemu klientowi “wyskoczyć” ze swojej maszyny wirtualnej i przejąć kontrolę nad pozostałymi środowiskami wirtualnymi działającymi w obrębie danego węzła. Co jest przyczyną ataku? Błąd typu buffer overflow znajdujący się od 2004 roku w wirtualnym kontrolerze dyskietek w QEMU, który jest wykorzystywany w wielu innych platformach wirtualizacyjnych — m.in. w Xen, KVM i oczywiście QEMU. Patche dla Xena i QEMU są już dostępne, a VirtualBox niebawem wypuści łatkę. Dziura nie dotyczy VMware i Hyper-V. Nie jest tak źle jak pisze zachodnia prasa… Odkrywcy nie odnotowali ataków z wykorzystaniem tej podatności. Nie jest więc źle (a zwłaszcza tak źle, jak było w przypadku Heartbleeda, który po kilku godzinach od ujawnienia był aktywnie wykorzystywany do ataków). Exploit na VENOM-a pewnie też się niebawem pokaże, gdyż na stronie poświęconej podatności dość jasno wskazano, gdzie znajduje się podatność: Warto jednak podkreślić, że aby przeprowadzić atak, użytkownik w systemie maszyny gościa musi mieć uprawnienia roota (lub administratora). O ile w przypadku chmur i serwerowni nie jest to problem (w zasadzie każdy sprzedawca VPS-ów oddaje klientowi konto administracyjne) to przynajmniej ci z Was, którzy oparli swoją sieć firmową o maszyny wirtualne mogą po części odetchnąć z ulgą — byle pracownik dostępem FTP nie wyskoczy z maszyny gościa. VENOM zasługuje jednak na uwagę przede wszystkim z racji dość szerokiej powierzchni ataku. Poprzednie “ucieczki” z tzw. maszyny gościa, takie jak np. Directory Traversal we współdzielonych katalogach czy błąd pamięci w akceleracji 3D VirtualBoxa wykorzystywały błędy albo typowe dla konkretnego środowiska wirtualizacyjnego, albo konfiguracje, które nie były spotykane w środowiskach produkcyjnych. ,vi.curry