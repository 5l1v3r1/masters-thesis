Formspring zdaje się być dużym i znanym serwisem z pytaniami i odpowiedziami — my, szczerze mówiąc, dopiero dziś usłyszeliśmy jego nazwę po raz pierwszy i normalnie nie poświęcilibyśmy mu artykułu na Niebezpieczniku (ot, kolejny nudny wyciek bazy), gdyby nie sposób w jaki doszło do włamania… Jak wyciekły hashe? Powód wycieku jest bardzo popularny: włamanie na maszynę developerską, co gorsza, podpiętą do bazy produkcyjnej (pamiętacie włamanie do Wykopu sprzed kilku lat?). Z bazy wyciągnięto 420 tysięcy haseł SHA-256 z losowym saltem i opublikowano je z zachętą do łamania na jednym z for poświęconych bezpieczeństwu. Formspring przyznał się do włamania, wymusił (a nie poprosił, to plus) reset haseł wśród swoich użytkowników i obiecał przejść na mocniejsze hashe BCryptu. Chociaż zrobił to tylko na blogu, bo w e-mailu do użytkowników zbyt wielu szczegółów nie ma: Tak czy inaczej, wszyscy chwalą postawę Formspring za szybką reakcję i użycie “mocnych hashy z saltem”. Ciekawe te “mocne” hashe Przyjrzyjmy się jednak tym “mocnym” hashom, które wyciekły… Dump hashy pojawił się na forum InsiderPro już 6 lipca — oryginalny wątek na forum przestał istnieć, ale jest cache Google. Podobnie jak w przypadku wycieku hashy z LinkedIn i tym razem wraz z hashami nie podano loginów, ani innych danych identyfikujących konta. Warto natomiast podkreślić, że użytkownik, który wrzucił bazę online jest uczestnikiem tego forum od 2009 roku. Co do samych hashy, to użyty do ich wygenerowania salt jest mocno dyskusyjny. Okazuje się, że jest to liczba z przedziału 00-99, a format hasha to: sha256([00-99]+$hasło) Po co “solisz” i hashujesz, programisto? Hasła się hashuje i “soli” aby opóźnić (a nie uniemożliwić!) ich rozszyfrowanie przez atakującego. Ideą salta jest po pierwsze wydłużenie początkowego ciągu znaków (czyli hasła podanego przez użytkownika) wpadającego na funkcję skrótu tak, aby na wynikowym hashu nie można było przeprowadzić ataku znanego jako Rainbow Tables. Atak Rainbow Tables polega na wyszukaniu hasha w wyliczonej wcześniej tablicy hashy. Takie “tęczowe tablice” są dostępne do ściągnięcia w internecie dla różnych zestawów znaków (alfabetów) i zazwyczaj bezpłatnie można je pobrać dla ciągów o długości maksymalnie ok. 14 znaków (ale uwaga, chętni powinni przyszykować kilka wolnych terabajtów na dysku). Drugi z powodów użycia salta to chęć uzyskania unikalnego hasha dla wszystkich użytkowników, którzy wybrali sobie takie samo hasło. W przypadku salta Formspringu, który może przyjąć tylko 100 wartości, atakujący ma dość proste zadanie: wyliczenia nie jednego “słownika” wszystkich możliwych hashy popularnych haseł, a 100 takich słowników (każdy będzie się zaczynał od innej liczby z przedziału 00-99). Przejście Formspringa na BCrypt zdecydowanie dobrze im zrobi, bo ich obecna implementacja “bezpiecznych hashy” zdecydowanie nie jest najlepsza. Aha, Formspring udzielił też swoim użytkownikom genialną wskazówkę: To po cholere ich o to pytają i dają możliwość wpisania tego typu danych w swoim serwisie? :-) ,Mr. Niebezpieczny