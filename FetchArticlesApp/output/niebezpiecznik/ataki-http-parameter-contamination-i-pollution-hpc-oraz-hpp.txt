Na naszych szkoleniach poruszamy kilka technik omijania filtrów WAF. Jedną z nich jest HPP, czyli Http Parameter Pollution. Niedawno zaś pojawił się ciekawy dokument opisujący kolejną, zbliżoną do HPP metodę obchodzenia filtrów — Http Parameter Contamination. Http Parameter Pollution (HPP) Dla przypomnienia HPP, czyli Http Parameter Pollution to metoda modyfikacji tzw. query string (znaki od ? do końca URI), polegająca m.in. na przesyłaniu kilku takich samych nazw parametrów, ale z różnymi wartościami. W zależności od webserwera i języka programowania, reakcje webaplikacji mogą być różne (przyjęcie pierwszej lub ostatniej wartości, albo stworzenie tablicy z wszystkimi wartościami). Dzięki HPP możemy tak zmodyfikować parametry w GET/POST/Cookie, aby możliwe było: – nadpisanie wartości zahardcodowanych zmiennych – wpłynięcie na działanie logiki webaplikacji – ominięcie walidacji parametru (ew. regułki WAF) Http Parameter Contamination (HPC) HPC, czyli Http Parameter Contamination to celowe zanieczyszczanie nazw parametrów znakami, które wg RFC3986 i RFC2396 mają w przypadku URL różne przeznaczenie: Bazując na powyższej tabeli, można zauważyć, że aby obejść regułkę Mod_Security blokującą http://localhost/?xp_cmdshell można przesłać do aplikacji następujące dane: http://localhost/?xp[cmdshell (bo [ jest zamieniane na _). Podobnie, aby wykonać blokowany atak path traversal http://IP/test.asp?file=../bla.txt można użyć http://IP/test.asp?file=.%./bla.txt (bo % jest pomijane). Warto tu przywołać ciekawe zachowanie PHP w dostępie do plików — metoda ataku bardzo zbliżona do HPC. Więcej o HPC możesz przeczytać tutaj. Jeśli jesteś zainteresowany bezpieczeństwem webaplikacji, zapraszamy na nasze szkolenie — właśnie otworzyliśmy rejestrację na kolejny termin (1-2 września), pozostało jeszcze 7 wolnych miejsc, a rejestrując się przed 10 sierpnia zapłacisz mniej. ,Mr. Niebezpieczny