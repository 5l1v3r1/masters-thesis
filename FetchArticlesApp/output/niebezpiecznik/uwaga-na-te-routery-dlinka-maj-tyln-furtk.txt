Kilka modeli routerów D-Linka posiada backdoora. Jeśli udostępniają one panel administracyjny po HTTP, to można się do niego zalogować bez znajomości hasła. D-link backdoor W sobotę Craig z devttys0 ściągnął firmware v1.13 dla urządzeń D-Link (DIR-100 revA). Binwalk ujawnił, że obraz zawiera serwer thttpd zmodyfikowany przez firmę Alphanetworks (powiązaną z D-Linkiem). Badacza zainteresowała funkcja alpha_auth_check. Po krótkim reverse-engineeringu, wyszło na jaw, że do D-Linka można się zalogować na prawach administratora nie podając żadnego hasła, a jedynie ustawiając User-Agent swojej przeglądarki na tajemniczy ciąg znaków: xmlset_roodkcableoj28840ybtide Ciąg stanie się bardziej zrozumiały, jeśli przeczytamy go od tyłu: editby04882joelbackdoor_teslmx. Kim jest Joel? Jak wykazują czytelnicy Reddita, chodzi o dyrektora ds. technologii firmy Alphanetworks. Co ciekawe, już kilka lat temu na ślad backdoora wpadli Rosjanie. Które routery są zbackdoorowane? Backdoor działa na modelach D-Linka: DIR-100 DI-524 DI-524UP DI-604S DI-604UP DI-604+ DIR-615 TM-G5240 Oraz w kilku routerach firmy Planex: BRL-04UR, BRL-04CW. Mam D-Linka, co robić? Jak pozazują proste odpytania Shodana, podatnych na atak routerów wystawionych do internetu są tysiące. Lepiej szybko sprawdźcie, czy nie wystawiacie swojego panelu zarządzania na świat …i zastanówcie się, kto ma do niego dostęp z sieci lokalnej. Jeśli są w niej niezaufani użytkownicy, może lepiej wyłączyć webinterface na rzecz dostępu po SSH (o ile to możliwe), przynajmniej do momentu wydania przez D-Linka łatki usuwającej backdoora. Alternatywnie, można na router wgrać inny firmware, nie od D-Linka, a od DD-WRT lub Open WRT. W zasadzie to i tak warto się przesiąść na te firmware’y, gdyż dadzą wam one zdecydowanie więcej możliwości. Jeśli to Was nie przekonuje, to może przekona Was to, że ten backdoor to nie pierwszy problem z routerami D-Linka — już w styczniu 2010 roku można było się logować na kilka modeli D-Linka bez hasła. PS. Taviso zadał sobie trud przejrzenia firmware’ów D-Linka pod kątem backdoora: % grep roodkcab `find . -name webs` Binary file ./_DIR100_v5.0.0EUb3_patch02.bix.extracted/squashfs-root/bin/webs matches Binary file ./_TM-G5240-alpha-v4-0-0b20.bix.extracted/squashfs-root/bin/webs matches Binary file ./_di604UP_firmware_103_BETA.bix.extracted/squashfs-root/bin/webs matches Binary file ./_tm-g5240-alpha-v4-0-0b17.bix.extracted/squashfs-root/bin/webs matches Binary file ./_TM-G5240-b26_320k.bix.extracted/squashfs-root/bin/webs matches Binary file ./_TM-G5240-4.0.0b28.bix.extracted/squashfs-root/bin/webs matches Binary file ./_TM-G5240-alpha-v4.0.0b23.bix.extracted/squashfs-root/bin/webs matches Binary file ./_TM-G5240-v4-0-0b29.bix.extracted/squashfs-root/bin/webs matches % ,igH