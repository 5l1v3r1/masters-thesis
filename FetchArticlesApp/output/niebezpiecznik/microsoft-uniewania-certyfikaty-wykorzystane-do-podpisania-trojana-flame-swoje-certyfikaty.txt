Microsoft oświadczył, że twórcy trojana Flame podpisali jego fragmenty przy pomocy …podrobionego certyfikatu Microsoftu. Microsoft właśnie rozpoczął procedurę blokowania tych certyfikatów przy pomocy mechanizmów Windows Update. Certyfikaty do podpisywania kodu Microsoft podejrzewa, że twórcy Flame’a wykorzystali usługę Terminal Server Licensing Service służącą do autoryzacji usługi Remote Desktop (przy pomocy generowanych przez TSLS certyfikatów można było podpisywać kod). Mike Reaevey z Microsoft Security Response Center nie tłumaczy jednak jak przestępcy podrobili certyfikat Microsoftu — wspomina jedynie o wykorzystaniu słabości “starego algorytmu kryptograficznego” (nie określono jaki to algorytm, podejrzewa się jednak, że może chodzić o MD5 i problem kolizji w funkcjach skrótu). Po co podpisywać trojana? Korzyści z faktu, że malware wygląda jakby stworzył go Microsoft mogą być różne: od oszukania użytkowników (“Ooo, wygląda jak dzieło Microsoft, na pewno mogę zainstalować ten nieznany mi wcześniej program”), poprzez utrudnienie wykrycia przez programy antywirusowe, aż po wizje dystrybucji złośliwego oprogramowania poprzez fałszywe (ale poprawnie podpisywane) aktualizacje via Windows Update. Reakcja Microsoft 1) Wydano odpowiedni Advisor (chociaż polecamy także lekturę wpisu z blogu Security Research & Defense) 2) Wydano poprawkę, dostępną już w Windows Update, która unieważnia trzy certyfikaty wykorzystane w procesie fałszywego podpisu (przenosi je do Untrusted Certificates Store) 3) Zablokowano możliwość wystawiania certyfikatów w usłudze Terminal Server Licensing Service, które umożliwiają podpisanie kodu. Należy się cieszyć, że cały ten mechanizm fałszywego podpisu nie został wykorzystany poprzez jakiś masowy malware, skierowany na np. transakcje bankowe. Na wypadek gdyby takowy już działał lub miał zaraz się pojawić (przestępcy lubią sobie odsprzedawać certyfikaty, nie wiadomo co jeszcze zostało nimi podpisane) polecamy zaktualizować Wasze Windowsy. ,Anonim