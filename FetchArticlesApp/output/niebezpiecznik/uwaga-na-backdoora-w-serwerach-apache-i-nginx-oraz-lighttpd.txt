Pod koniec kwietnia, firma Sucuri wraz z ESET-em opisały backdoora, którego odkryto w serwerach Apache. Ponieważ problem dotykał tylko serwerów Apache i to instalowanych przez cpanel, a backdoora łatwo dało się namierzyć robiąc prostego grepa, do ataku nie przyłożono zbyt wielkiej uwagi. Teraz jednak okazało się, że backdoor znajduje się również w innych webserverach, a jego obecność potwierdzono na instancjach odpowiedzialnych za serwowanie kilkudziesięciu najpopularniejszych strona na świecie. Na czym polega atak Linux/Cdorked Atakujący po dostaniu się na serwer (wciąż nie wiadomo w jaki sposób) podmieniają binarkę webservera (np. Apache) na taką, która wstrzykuje w serwowaną stronę internetową złośliwy kod (poprzez jeden ok. 30 000 URLi). Następuje wtedy przekierowanie ofiary na strony spamerskie (głównie pornograficzne) lub takie, które próbują infekować komputer ofiary złośliwym oprogramowaniem poprzez Blackhole Exploit Pack. Jak sprawdzić, czy jesteśmy zainfekowani? Po pierwszych doniesieniach bagatelizowano problem, ponieważ atak można było przeprowadzić jedynie na serwerach z cpanelem, gdzie proces Apache’a miał uprawnienia roota (sic!). Dodatkowo, backdoora można było łatwo zidentyfikować wykonująć na serwerze polecenie: grep -r open_tty /usr/local/apache/ lub korzystając z tego narzędzia. Na uwagę zasługuje sposób sterowania zbackdoorowanym serwerem. Fałszywa binarka webservera nie ma nigdzie zakodowanego adresu serwera C&C — to atakujący musi się połączyć z serwerem, aby wydawać mu instrukcje lub zmieniać konfigurację. Backdoor, po otrzymaniu odpowiedniego zapytania GET wykonuje zwrotne połączenie na adres IP wskazany przez atakującego. Nginx i Lighttpd też podmieniane Najnowsze doniesienia mówią o tym, że już nie tylko Apache, ale także nginx oraz lighttpd są backdoorowane. To pokazuje, jak zdeterminowani są atakujący. Skutkami ataku ma być także dotkniętych już 400 serwerów, z czego ok. 50 jest notowanych na Alexa TOP 100 000. ESET ujawnia, że co najmniej 100 000 internautów korzystających z ich produktów próbowano przekierować na złośliwe strony (ponieważ nie każdy internauta ma zainstalowanego ESET-a, to oznacza, że liczba potencjalnych ofiar jest zdecydowanie większa). Sposób wejścia na system wciąż nieznany Do tej pory nie jest jasne jak atakującym udaje się uzyskać roota na serwerach na których podmieniają binarki webserverów. Być może chodzi o bruteforce’owanie haseł dostępowych po SSH? Co ciekawe, złośliwe przekierowanie na zbackdoorowanym webserverze nie uaktywni się, jeśli klientem jest ktoś, kto ma ustawiony język przeglądarki jako: Japoński, Fiński, Rosyjski, Ukraiński, Kazachski lub Białoruski. Inni, o ile posiadają aktualną wersję przeglądarki i wtyczek też mogą się czuć spokojnie (w Blackhole Exploit Packu wykorzystywanym do infekcji na chwilę obecną nie ma 0day’ów). ,vi.curry