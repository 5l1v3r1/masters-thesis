Jeśli macie router ASUS-a, to lepiej nie wpuszczajcie do sieci niezaufanych osób… Ze względu na dziurę w oprogramowaniu większości routerów ASUS-a można przejąć nad nimi kontrolę. Na czym polega atak? Routery ASUS, bardzo popularne wśród polskich użytkowników, posiadają usługę infosvr nasłuchującą na LAN-owskim interfejsie broadcastów UDP na porcie 9999 i pracującą z uprawnieniami administratora. Usługa ta ma na celu wykryć inne routery w sieci i ułatwić konfigurację sprzętu. Posiada jednak poważny błąd… Wystarczy wysłać do niej odpowiednio zbudowany pakiet UDP, aby na skutek dziury, wykonać na routerze dowolne polecenie (z uprawnieniami roota). Stąd już krótka droga do złośliwej podmiany DNS-ów (por. Stracił 16 000 bo miał dziurawy router) lub podmian routingu, czyli de facto ataków typu man in the middle Błąd, oznaczony już jako CVE-2014-9583, odkrył jduck, który na githubie opublikował kod exploita. Atak był testowany na firmware 3.0.0.376.2524-g0013f52, ale wedle odkrywcy podatne są na niego wszystkie routery ASUS-a. Mam router ASUS, co robić, jak żyć? Dopóki producent nie wypuści łatki (aktualizacji firmware’u routera), możliwe jest obejście, które polega na ubiciu usługi infosvr. Najłatwiej będzie to wykonać przy pomocy exploita :-) $ ./asus-cmd "killall -9 infosvr" Można też wykorzystać alternatywne podejście zaproponowane przez Davida Longeneckera lub po prostu zablokować na firewallu dostęp do portu 9999 na interfejsie LAN. Na koniec podkreślmy, że dziurę mogą wykorzystać tylko osoby, które znajdują się w sieci lokalnej, a nie w internecie (jak miało to miejsce w przypadku dziur w routerach TP-Linka). Aktualizacja 13.01.2015 ASUS Polska poinformował nas, że patch jest już dostępny – można go pobrać stąd. ,vi.curry