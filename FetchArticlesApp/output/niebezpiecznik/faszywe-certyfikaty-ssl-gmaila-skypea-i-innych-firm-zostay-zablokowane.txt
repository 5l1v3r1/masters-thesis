Comodo UserTrust wystawiło fałszywe certyfikaty SSL. Nie wiadomo jak do tego doszło, ale wiadomo, że jeden z fałszywych certyfikatów wystawiono na domenę addons.mozilla.org, co pozwala atakującemu podszyć się pod popularny serwis z dodatkami do Firefoksa. Nie wiadomo jakich stron dotyczą pozostałe, fałszywe certyfikaty SSL (już wiadomo, patrz niżej). Zmiany w kodzie przeglądarek Historię najdokładniej opisuje Jacob Appelbaum, który 16-tego marca zauważył zastanawiające zmiany w …kodzie przeglądarki Chrome (a potem podobne w Firefoksie). Aktualizacje kodu polegały na “zahardkodowaniu” numerów seryjnych 15 certyfikatów SSL i ich blokady. Ponieważ same numery seryjne certyfikatu nic nie mówią na temat jego wystawcy, czy nazwy, na którą został on wystawiony, Appelbaum rozpoczął monitorowanie CRL (czyli list, publikowanych przez poszczególnych wystawców certyfikatów, zawierających informacje o unieważnianych certyfikatach). W ten sposób dowiedział się, że zagadkowe certyfikaty zostały unieważnione 15-tego marca i pochodziły od wystawcy USERTRUST, CN=UTN-USERFirst-Hardware, który jest resellerem certyfikatów COMODO High Assurance Secure Server CA. Warto tu wspomnieć o problemie CRL. Publikowane są one co pewien czas. Zakładając ich publikowanie co poniedziałek o 11:59, unieważnienie certfikatu we wtorek o 12:00, oznacza, że odpowiedni wpis w CRL znajdzie się dopiero w jej kolejnej edycji, czyli w przyszły poniedziałek (za 6 dni). Do tego czasu klienci (tu: przeglądarki) nie będą zdawały sobie sprawy, że certyfikat z którym mają do czynienia jest z jakiegoś powodu nieważny. Alternatywa do CRL to protokół OCSP, pozwalający na “natychmiastowe” odwołanie się do serwerów wystawcy w celu weryfikacji certyfikatu. Można go włączyć w przeglądarce Firefox wpisując about:config oraz security.OCSP.require. Warto jednak wiedzieć, że jeśli korzystamy z OCSP, to wystawca certyfikatu wie, jakie strony odwiedzamy, no i przede wszystkim musi on ten protokół udostępniać. Zarówno Google, Mozilla jak i Microsoft wydały już poprawki do swoich przeglądarek. Po zaktualizowaniu do nowszych wersji przeglądarki te ochronią internautów przed tymi konkretnymi fałszywkami, nie czekając na dystrybucję CRL. Atak na Comodo? Nie wiemy jak i kiedy fałszywki zostały wygenerowane, ale wiemy, że 15-tego marca zostały unieważnione. Appelbaum przypuszcza, że atakujący mógł uzyskać dostęp do kluczy Comodo. Nie wiemy pod kogo atakujący chcieli się podszyć, ale Mozilla zdradza, że wśród “ofiar” znalazł się serwis addons.mozilla.org oraz 7 innych — można tylko spekulować, które ze stron WWW są łakomym kąskiem dla atakujących (Google? Facebook? Banki?). Pochwały należą się też Comodo, że w ogóle poinformowało o swoich problemach. Z biznesowego punktu widzenia, nie była to pewnie łatwa decyzja, a wielu obserwatorów podejrzewa, że to co przydarzyło się Comodo, nie jest pierwszym i odosobnionym przypadkiem… Przypomnijmy, że 2 lata temu Comodo zaliczyło wpadkę, wydając bez weryfikacji certyfikat na domenę www.mozilla.com. Teraz zapewne rozpocznie się kolejna dyskusja na temat tego, jak bardzo powinniśmy ufać wystawcom certyfikatów? I czy dzisiejsze mechanizmy wertyfikacji certyfikatów (np. CRL) są adekwatne do potrzeb? Aktualizacja 20:44 Microsoft w swoim oświadczeniu wymienia więcej nazw domen, na które wygenerowane zostały fałszywe certyfikaty: login.live.com, mail.google.com, www.google.com, login.yahoo.com (3 certyfikaty), login.skype.com, addons.mozilla.org oraz “Global Trustee”. F-Secure podejrzewa, że ten ostatni certyfikat najprawdopodobniej jest wykorzystywany (jako zaufany) na jakimś urządzeniu sieciowym. Warto też zwrócić uwagę na dobór stron — służą one głównie do komunikacji, a więc atakującym raczej nie chodzi o pieniądze, a o informacje. Oświadczenie wydało też Comodo, które wyjaśnia, że włamania dokonano nie do CA (klucze nie zostały wykradzione), a na konto jednego z użytkowników RA (Registration Authority). Atakujący działał szybko i precyzyjnie — Comodo twierdzi, że atak był najprawdopodobniej sponsorowany przez władze Iranu. Aktualizacja 28.03.2011; 23:55 Pojawiła się osoba, która twierdzi, że to ona stoi za atakami. ,vi.curry