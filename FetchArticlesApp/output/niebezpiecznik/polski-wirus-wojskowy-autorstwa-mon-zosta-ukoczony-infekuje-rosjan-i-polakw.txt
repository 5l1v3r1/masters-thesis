Kilka dni temu odezwał się do nas Alladyn2. Tak, to ten sam Alladyn2, który 2 lata z rzędu włamywał się do sieci wewnętrznych najpierw kancelarii premiera, a potem takich instytucji jak kancelaria prezydenta, MSZ czy MON-u. Tym razem jednak Alladyn2 nie podesłał kalendarzy ani e-maili ministrów. Podesłał coś lepszego — próbkę złośliwego oprogramowania, które jak udało nam się ustalić jest wykorzystywane przez polskie wojsko do działań ofensywnych w cyberprzestrzeni… Oto nasz rodzimy Stuxnet! TL;DR: Otrzymaliśmy plik wirusa tworzonego dla MON. Część z Was może być nim zainfekowana. Prosimy Was o próbki do analizy. Instrukcje czego szukać na dysku na końcu artykułu. ID29 — polski wojskowy wirus Wszystko wskazuje na to, że mamy w rękach wynik niesławnego Projektu 29 (tzw. “id29”), którego początki opisywaliśmy jako pierwsi w 2013 roku. Sprawa wyszła na jaw, gdy okazało się że MON zagapił się i nie utajnił przetargu wyłaniającego firmę, która miała stworzyć polskiego rządowego trojana za 6 milionów złotych. Przypomnijmy, że ID29 miał mieć takie funkcje jak: – przejmownie kontroli nad urządzeniami sieciowymi i mobilnymi – celową dezaktywację niektórych urządzeń – prowadzenie nasłuchu – wykradanie danych w ramach ukrytej transmisji Co z tego udało się zrealizować? Alladyn2 twierdzi, że sporo… Dopisek redakcji: Tu warto wspomnieć coś, z czego być może nie wszyscy zdają sobie sprawę. Plik z roszerzeniem .pif w systemie Windows nie pokaże się jako .pif, a jako .pdf (rozszerzenia .pif nie są pokazywane nawet przy włączonej opcji pokazywania rozszerzeń). Jest to więc bardzo sprytny sposób na to, aby zmanipulować kogoś do otworzenia pliku, który — choć wydaje się być PDF-em — to nim nie jest. Analiza potwierdza, że to dzieło Polaków Pobieżna analiza pliku .pif przekazanego przez Alladyna2 pokazała, że po uruchomieniu szuka on na dysku pliku f14950b970bc87ca183072dcdc40f738.conf i zaraz po jego odczytaniu, kasuje go. Następnie wyświetlany jest plik PDF z czymś, co wygląda jak artykuł na temat Polskiej współpracy z NATO: Dlaczego wydaje nam się, że ten malware to w istocie monowski ID29? Otóż jednym ze stringów zaszytych w binarce w miejscu zawierającym nazwę komputera developera przewija się nazwa polskiej firmy, która koniec końców wygrała konkurs MON-u i rozpoczęła realizację projektu wirusa. Na chwilę obecna zdecydowaliśmy się na nieujawnianie jej nazwy (czekamy na oświadczenie firmy). Aktualnie pracujemy nad tym, aby zrozumieć jak dokładnie działa ID29. Brakuje nam jednak danych. Próbka pozyskana przez Alladyna2 wydaje się być bardzo wczesną wersją trojana a używane przez jego autorów numerowanie sugeruje, że wersji malware może być więcej. Niestety próby szukania plików ID29 (po nazwach i hashach) w Google oraz w repozytoriach z próbkami malware producentów antywirusowych zakończyły się niepowodzeniem… ID29 atakuje też Polaków Przed publikacja tego tekstu poprosiliśmy kilku znajomych współpracujących z rządowymi instytucjami o nieoficjalne informacje w sprawie wirusa. Jeden ze znajomych, nazwijmy go Jacek, po zapoznaniu się z wiadomością od Alladyna2 zauważył, że w jego systemie także znajduje się plik .conf o takiej samej nazwie jak ten pozyskany z rosyjskiego komputera, na który włamał się Alladyn2. U Jacka nie ma jednak żadnych PDF-ów czy .pif-ów. Jacek nie przypomina sobie jednak, aby pobierał jakiegokolwiek załącznik z artykułami na temat NATO. Data stworzenia pliku wskazuje na “okolice codziennej porannej kawy i prasówki“. Aktualna hipoteza więc jest taka, że plik został zapisany na dysku przy pomocy ataku drive-by download. Żeby było ciekawiej, Jacek zapiera się, że korzysta z aktualnego Firefoksa _bez_ jakichkolwiek pluginów — czyli odpadają luki we Flashu i Javie. Niestety w pliku konfiguracyjnym u Jacka, w przeciwieństwie do pliku znalezionego przez Alladyna2 na rosyjskim komputerze, nie ma żadnych adresów IP. Ciężko jest więc zrozumieć jak Projekt 29 zachowuje się kiedy jest instalowany na polskich komputerach. Dlatego… Prosimy Was o pomoc Jacek po przeanalizowaniu historii swojej przeglądarki z daty wskazanej jako data stworzenia pliki konfiguracyjnego ID29, stwierdził, że podczas porannej prasówki przeglądał jedynie poniższe strony: wp.pl facebook.com tvn24.pl dobreprogramy.pl plotek.pl wprost.pl thepiratebay.se demotywatory.pl wykop.pl sejm.gov.pl Jeśli w ciągu ostatnich 2 tygodni odwiedzaliście którąś z powyższych stron, przeszukajcie swoje dyski twarde pod kątem pliku konfiguracyjnego wirusa: f14950b970bc87ca183072dcdc40f738.conf A jeśli znajdziecie taki plik, prześlijcie go do nas na adres malware@niebezpiecznik.pl. Jeśli pamiętacie co robiliście w dniu i godzinie odpowiadającej czasowi stworzenia pliku, bardzo prosimy abyście dopisali to w e-mailu. WAŻNE: w przypadku odnalezienia pliku nie wpadajcie w panikę. Jeśli go widzicie, to wszystko wskazuje na to, że o ile kod z wirusem trafił (w jakiś sposób) na Wasz komputer, to nie został z jakiegoś powodu jeszcze wykonany (być może w ogóle kod nie wykonuje się na komputerach Polaków?). Po odpaleniu bowiem, plik konfiguracyjny jest natychmiast kasowany z dysku ofiary. Z powyższego wynika, że obawiać należy się, jeśli nie znajdziecie tego pliku. Może to bowiem oznaczać, że albo w ogóle nie jesteście zainfekowani Projektem 29, albo Projekt 29 was zainfekował, a po uruchomieniu “posprzątał” po sobie. Postaramy się niebawem uchwycić inne charakterystyczne cechy zainfekowanego systemu i przekazać Wam bardziej precyzyjne instrukcje sprawdzenia tego, czy jest się zainfekowanym ID29. Póki co dalej “rozbieramy” binarkę z rosyjskiego komputera. Stay tuned! PS. Dla jasności – nie planujemy popełniać żadnego samobójstwa. Aktualizacja 21:41 Mamy już próbki od czytelników z Windows 7 i XP oraz Mac OS X — dzięki! Dodatkową cechą wspólną wszystkich “ofiar” jest posiadanie zainstalowanego oprogramowania TOR. Dodatkowo, wygląda na to, że w obrębie każdego z systemów config jest taki sam — różni się jedynie w maskach plików (zapewne dlatego, że w zależności od systemu ścieżka do plików konfiguracyjnych programów, którymi zainteresowany jest ID29 jest inna). Będziemy wdzięczni a przesyłanie tylko próbek z systemów Windows 8, do tej chwili nie wpłynęła ani jedna. Niebawem więcej info, analiza trwa. Aktualizacja 22:00 Z rozmów z osobami, które podesłały plik konfiguracyjny wynika, że część z podanych przez Jacka stron można wykreślić. Co najmniej 2 osoby, które podesłały nam plik, nigdy nie były na plotek.pl i tvn24.pl Aktualizacja 8:45 Ukończyliśmy wstępną analizę trojana i zainfekowanych nim systemów. Kończymy pisać drugiego posta w którym opiszemy jakie zmiany do systemu ofiary wprowadza ID29 i pokażemy jak krok po kroku sprawdzić, czy jest się zainfekowanym. Publikacja ok. 10:00. Aktualizacja 11:04 Opublikowaliśmy wyniki analizy wirusa oraz szczegółowe instrukcje jak sprawdzić, czy twój komputer jest zainfekowany wirusem ID29 -> Jak sprawdzić czy jesteś zainfekowany Projektem 29, czyli polskim wirusem wojskowym. Aktualizacja 2.04.2015 Ten post był elementem żartu primaaprilisowego. ,Mr. Niebezpieczny