Obejście googlowego dwuskładnikowego uwierzytelnienia już raz miało miejsce — zrobiła to grupa UGNazi w trakcie swojego ataku na CloudFlare. Teraz DuoSecurity informuje o kolejnej słabości Googlowego dwuskładnikowego uwierzytelniania. Hasła specyficzne dla danej aplikacji Dwuskładnikowe uwierzytelnianie w Google działa tylko dla HTTP — po podaniu hasła do konta jesteśmy proszeni o wpisanie kodu z SMS-a lub aplikacji-tokena, zainstalowanej na naszym telefonie komórkowym. Niestety dwuskładnikowe uwierzytelnienie nie wspiera wszystkich protokołów i dlatego dla SMTP lub IMAP Google wprowadziło tzw. “Application Specific Passwords” — losowo generowane hasła dające dostęp do konta Google tylko konkretnej aplikacji. Nazwa “specyficzne dla aplikacji hasła” może sugerować, żę jeśli np. wycieknie nasze ASP dla klienta Google Talk na telefonie komórkowym, to atakujący nie będzie w stanie zalogować się przy pomocy tego hasła do GMaila przez przeglądarkę — nic bardziej mylnego. Telefon z Androidem + ASP = obejście 2FA Ekipa DuoSecurity dowiodła, że każde ze “specyficznych dla aplikacji haseł” dawało nieograniczony dostęp do konta i pozwalało obchodzić dwuskładnikowie uwierzytelnienie (przy użyciu ASP nie byliśmy pytani o kod z SMS-a lub aplikacji). Jak? Przy pomocy ASP należało zlinkować telefon z Androidem z kontem Google’a (to włączało funkcję “autologinu”, która de facto obchodziła 2 factor authentication). Następnie z poziomu telefonu miało się dostęp do poszczególnych ustwień konta Google, w tym — tzw. recovery options — czyli strony na której można zmienić hasło do konta ofiary — oczywiście bez dodatkowego uwierzytelnienia. ASP to nie OAuth Jak widać powyżej, niestety ASP to nie OAuth, gdzie każdy z tokenów może mieć dostęp tylko do wybranych danych/funkcji konta użytkownika. Błąd popełniony przez Google należy rozpatrywać w kategoriach błędów “designu”/”logiki biznesowej” — przy tak szerokim wdrożeniu (tyle urządzeń, metod dostępu) łatwo o pomyłkę nawet najlepszym. Obecnie dziura została załatana przez Google. PS. Warto też podkreślić, że aby ominąć dwuskładnikowe uwierzytelnienie, atakujący musiał najpierw zdobyć ASP ofiary, a to wcale nie jest łatwe zadanie (albo znajdziemy czyjś telefon i wyciągniemy ASP z konfiguracji, albo założymy własną “fałszywą” usługę spinającą się z kontem Google — np. aplikację na iOS). To powoduje, że atakującym prościej wykonać klasyczny atak typu phishing lub włamać się do innego serwisu i wykraść z niego hasło ofiary — wiemy przecież, że większość internautów naiwnie korzysta ona z jednego hasła do wielu usług… ,vi.curry